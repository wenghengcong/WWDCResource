1
00:00:07,516 --> 00:00:15,500
[ 音乐 ]


2
00:00:22,516 --> 00:00:27,906
[ 掌声 ]


3
00:00:28,406 --> 00:00:29,736
>> 大家下午好


4
00:00:29,736 --> 00:00:31,566
欢迎来到我们的会场


5
00:00:31,566 --> 00:00:33,366
一起看一下 用户通知的一些更新


6
00:00:33,986 --> 00:00:35,316
我叫 Kritarth Jain [ 音质不清晰 ]


7
00:00:35,316 --> 00:00:38,066
是 iOS 用户通知团队的一名工程师


8
00:00:38,066 --> 00:00:39,956
很高兴回到 WWDC


9
00:00:39,956 --> 00:00:42,316
并跟大家分享


10
00:00:42,316 --> 00:00:43,896
在 iOS 12 中


11
00:00:43,896 --> 00:00:45,566
你的 App 可以采用的


12
00:00:45,566 --> 00:00:47,036
一些用户通知方面


13
00:00:47,246 --> 00:00:48,116
非常赞的新功能


14
00:00:49,476 --> 00:00:51,446
今天我们一起来看一下


15
00:00:51,446 --> 00:00:53,086
幻灯片上的


16
00:00:53,086 --> 00:00:54,256
几个主题


17
00:00:54,526 --> 00:00:57,996
首先是分组通知


18
00:00:57,996 --> 00:00:59,696
这是之前我们在 iOS 用户通知中


19
00:00:59,876 --> 00:01:01,476
添加的新范例


20
00:01:01,476 --> 00:01:02,736
在用户的通知列表中


21
00:01:02,736 --> 00:01:03,646
可以看到分组通知


22
00:01:04,626 --> 00:01:05,896
然后来看一下


23
00:01:05,896 --> 00:01:07,546
通知内容扩展


24
00:01:07,886 --> 00:01:09,106
其中包括


25
00:01:09,106 --> 00:01:10,696
现有的通知扩展


26
00:01:10,696 --> 00:01:13,266
以及新增的接口


27
00:01:14,606 --> 00:01:15,906
下一个主题包括


28
00:01:15,906 --> 00:01:17,816
通知管理


29
00:01:17,816 --> 00:01:19,116
还有针对你的 App


30
00:01:19,116 --> 00:01:20,916
用户可以调整的一些


31
00:01:20,916 --> 00:01:22,636
通知设置


32
00:01:22,636 --> 00:01:24,226
以及你要如何处理


33
00:01:24,426 --> 00:01:25,366
这些新增选项


34
00:01:26,556 --> 00:01:27,976
再然后是


35
00:01:27,976 --> 00:01:29,936
临时授权 这个机制


36
00:01:29,936 --> 00:01:31,806
让你的 App 在一段时间内


37
00:01:31,806 --> 00:01:33,706
可以给用户试发送通知


38
00:01:33,706 --> 00:01:35,676
无需用户明确允许


39
00:01:35,676 --> 00:01:37,366
但是也不会有声音提醒


40
00:01:38,596 --> 00:01:40,266
我们最后一个主题是


41
00:01:40,266 --> 00:01:42,006
重要提醒


42
00:01:42,006 --> 00:01:43,816
此功能让你的 App 可以


43
00:01:43,816 --> 00:01:45,446
在用户允许的情况下


44
00:01:46,036 --> 00:01:47,996
忽略一些系统设定


45
00:01:47,996 --> 00:01:49,846
从而给用户发送


46
00:01:49,846 --> 00:01:51,026
重要的提醒


47
00:01:51,886 --> 00:01:53,146
今天我们


48
00:01:53,146 --> 00:01:54,736
要讲的主题不少


49
00:01:54,736 --> 00:01:56,316
就让我们先来说说


50
00:01:56,346 --> 00:01:57,136
分组通知


51
00:01:57,136 --> 00:02:01,356
在 iOS 11 及之前版本的系统中


52
00:02:01,356 --> 00:02:02,586
所有新的用户通知


53
00:02:02,586 --> 00:02:04,426
都是在通知列表中


54
00:02:04,426 --> 00:02:05,816
以时间顺序


55
00:02:05,816 --> 00:02:06,756
排列显示的


56
00:02:07,276 --> 00:02:08,735
这就造成多个 App 的通知


57
00:02:08,735 --> 00:02:10,376
穿插显示


58
00:02:10,705 --> 00:02:12,006
而用户很难


59
00:02:12,006 --> 00:02:13,886
一下找到某个通知


60
00:02:13,886 --> 00:02:16,746
或分流多个通知


61
00:02:17,796 --> 00:02:20,346
因此从 iOS 12 起


62
00:02:20,346 --> 00:02:22,216
我们决定加以改进


63
00:02:22,216 --> 00:02:23,676
新增分组通知功能


64
00:02:23,676 --> 00:02:25,696
现在大家可以看到


65
00:02:25,696 --> 00:02:27,586
多个 App 的


66
00:02:27,586 --> 00:02:30,526
各种通知都被分到了


67
00:02:30,526 --> 00:02:31,036
专属于它们的分组


68
00:02:32,056 --> 00:02:33,616
下面我们仔细谈谈


69
00:02:33,616 --> 00:02:34,866
分组通知


70
00:02:36,016 --> 00:02:38,426
所有通知


71
00:02:38,426 --> 00:02:39,856
会自动进行分组


72
00:02:39,856 --> 00:02:41,586
所以你不需要


73
00:02:41,716 --> 00:02:43,626
任何操作


74
00:02:43,706 --> 00:02:44,996
就可以使用该功能


75
00:02:45,406 --> 00:02:47,016
但是如果你想


76
00:02:47,136 --> 00:02:49,426
创建自定义分组


77
00:02:49,426 --> 00:02:51,176
那就需要使用线程标识


78
00:02:51,556 --> 00:02:53,566
线程标识


79
00:02:53,746 --> 00:02:55,556
是 UN notification content 对象中


80
00:02:55,556 --> 00:02:55,996
已有的属性


81
00:02:57,646 --> 00:02:59,096
你们当中可能有人


82
00:02:59,096 --> 00:03:01,276
给本地通知


83
00:03:01,276 --> 00:03:02,406
加过线程标识


84
00:03:02,536 --> 00:03:03,636
正如所示 你可以在


85
00:03:03,806 --> 00:03:05,606
UNMutableNotificationContent


86
00:03:05,606 --> 00:03:06,906
的对象中进行添加


87
00:03:08,056 --> 00:03:10,096
而在远程通知的 payload 处


88
00:03:10,096 --> 00:03:11,876
你也可以将


89
00:03:11,876 --> 00:03:13,706
线程标识添加进去


90
00:03:15,756 --> 00:03:17,816
现在你们


91
00:03:17,816 --> 00:03:19,696
可能已经比较了解线程标识了


92
00:03:20,996 --> 00:03:23,616
现在我们用它


93
00:03:23,616 --> 00:03:25,486
将通知发送给


94
00:03:25,486 --> 00:03:27,126
App 的


95
00:03:27,126 --> 00:03:28,976
通知内容扩展


96
00:03:29,176 --> 00:03:30,406
App 必须带有


97
00:03:30,406 --> 00:03:32,336
同样的线程标识


98
00:03:32,336 --> 00:03:33,986
才能根据新通知


99
00:03:34,026 --> 00:03:35,846
来更新内容扩展视图


100
00:03:37,256 --> 00:03:39,346
我们从 iOS 11 起


101
00:03:39,346 --> 00:03:41,536
如果用户之前开启了 [ 音质不清晰 ]


102
00:03:41,536 --> 00:03:43,386
我们便可以使用线程标识


103
00:03:43,386 --> 00:03:46,326
对通知进行分组


104
00:03:47,156 --> 00:03:48,126
可以说


105
00:03:48,126 --> 00:03:50,006
我们拓展了线程标识的运用


106
00:03:50,006 --> 00:03:51,096
将其覆盖所有类型的通知


107
00:03:52,756 --> 00:03:54,726
那通知分组是如何实现的呢


108
00:03:55,446 --> 00:03:57,166
你的设备


109
00:03:57,166 --> 00:03:59,676
接收到新通知时


110
00:03:59,676 --> 00:04:01,556
如果该通知不包含


111
00:04:01,676 --> 00:04:03,826
线程标识


112
00:04:04,246 --> 00:04:05,496
那这条通知


113
00:04:05,496 --> 00:04:06,926
会根据所属 App 进行分组


114
00:04:08,146 --> 00:04:09,746
正如这个例子


115
00:04:09,746 --> 00:04:11,476
所展示的


116
00:04:11,476 --> 00:04:13,496
接收到的新通知


117
00:04:13,496 --> 00:04:14,446
都被分到了同一组


118
00:04:14,446 --> 00:04:16,796
而该分组显示的


119
00:04:16,796 --> 00:04:17,986
是接收到的


120
00:04:17,986 --> 00:04:18,406
最新通知


121
00:04:18,476 --> 00:04:20,286
然后用户可以


122
00:04:20,286 --> 00:04:21,766
轻松展开分组


123
00:04:21,935 --> 00:04:23,266
来阅读现有的


124
00:04:23,266 --> 00:04:27,086
所有通知


125
00:04:27,276 --> 00:04:28,706
另一方面


126
00:04:28,706 --> 00:04:30,296
如果通知带有


127
00:04:30,296 --> 00:04:32,536
线程标识


128
00:04:32,536 --> 00:04:33,976
这条通知会与


129
00:04:33,976 --> 00:04:35,556
相同 App


130
00:04:35,556 --> 00:04:37,436
且带有同样线程 ID 的通知


131
00:04:37,436 --> 00:04:38,116
分到一组


132
00:04:39,246 --> 00:04:40,666
这意味着


133
00:04:40,666 --> 00:04:42,296
相同 App 可以有


134
00:04:42,296 --> 00:04:43,446
多个自定义的


135
00:04:43,446 --> 00:04:44,596
通知分组


136
00:04:44,596 --> 00:04:46,046
通过你设置的不同的线程标识


137
00:04:46,046 --> 00:04:46,806
进行区分


138
00:04:47,326 --> 00:04:50,346
Messages 这个 App


139
00:04:50,346 --> 00:04:52,166
是一个很好的例子


140
00:04:52,166 --> 00:04:53,176
大家可以看到


141
00:04:53,176 --> 00:04:54,996
这里有两个分组


142
00:04:55,136 --> 00:04:56,596
当接收到新通知时


143
00:04:56,596 --> 00:04:57,636
新通知会被分到


144
00:04:57,636 --> 00:04:58,556
相对应的分组中


145
00:04:59,016 --> 00:05:02,516
用户可以打开


146
00:05:02,516 --> 00:05:03,906
其中一个分组


147
00:05:03,906 --> 00:05:05,356
来查看该分组中


148
00:05:05,396 --> 00:05:05,786
所包含的通知


149
00:05:06,956 --> 00:05:07,926
所以通过使用线程标识


150
00:05:07,926 --> 00:05:09,676
messages 也可以


151
00:05:09,676 --> 00:05:12,276
做到这一点


152
00:05:12,516 --> 00:05:14,426
使用你的 App 的用户


153
00:05:14,426 --> 00:05:16,356
也可以在每个 App 的


154
00:05:16,356 --> 00:05:17,636
通知设置页面


155
00:05:17,956 --> 00:05:19,276
来修改


156
00:05:19,276 --> 00:05:20,526
通知分组的设置


157
00:05:21,426 --> 00:05:23,216
用户有三个选项可以选择


158
00:05:23,696 --> 00:05:25,536
如果用户选择自动


159
00:05:25,536 --> 00:05:26,756
那他所得到的结果


160
00:05:26,756 --> 00:05:27,496
我们刚刚讲过


161
00:05:28,836 --> 00:05:30,786
然而用户还可以


162
00:05:30,786 --> 00:05:32,286
选择只按照 App


163
00:05:32,286 --> 00:05:34,146
进行分组


164
00:05:34,146 --> 00:05:35,156
此时系统会忽略


165
00:05:35,156 --> 00:05:36,706
线程标识


166
00:05:36,706 --> 00:05:38,376
并将同一个 App 的通知


167
00:05:38,376 --> 00:05:39,246
全部归为一组


168
00:05:39,996 --> 00:05:41,846
如果用户想要


169
00:05:41,846 --> 00:05:43,926
iOS 11 的分组方式


170
00:05:43,926 --> 00:05:45,596
他们现在可以


171
00:05:45,596 --> 00:05:46,586
关闭分组通知


172
00:05:46,586 --> 00:05:47,806
非常简单


173
00:05:48,486 --> 00:05:49,926
所以要记住


174
00:05:49,926 --> 00:05:50,986
当你创建了自定义分组


175
00:05:50,986 --> 00:05:53,436
这个分组


176
00:05:53,436 --> 00:05:55,486
要能在用户


177
00:05:55,486 --> 00:05:56,516
接收你的 App 的通知时


178
00:05:56,516 --> 00:05:57,246
对用户有一定的价值


179
00:05:58,756 --> 00:06:00,606
下面我们来看看


180
00:06:00,606 --> 00:06:01,956
一个通知组


181
00:06:01,956 --> 00:06:02,186
有哪些部分组成


182
00:06:03,386 --> 00:06:05,076
这里显示的内容


183
00:06:05,076 --> 00:06:06,696
是该通知组中


184
00:06:06,696 --> 00:06:08,106
最新的一条通知


185
00:06:08,546 --> 00:06:11,996
用户只需点击这个分组


186
00:06:11,996 --> 00:06:13,936
就可以看见其中


187
00:06:13,936 --> 00:06:16,166
所有的通知


188
00:06:16,166 --> 00:06:17,196
通知的内容也同时展开


189
00:06:17,196 --> 00:06:19,086
然后用户可以


190
00:06:19,086 --> 00:06:20,356
单独处理


191
00:06:20,356 --> 00:06:21,216
每一个通知


192
00:06:22,236 --> 00:06:23,876
上方的两个按钮


193
00:06:23,876 --> 00:06:25,246
可以让用户更好地


194
00:06:25,246 --> 00:06:26,956
管理通知


195
00:06:26,956 --> 00:06:28,146
比如一键合并分组


196
00:06:28,146 --> 00:06:29,466
或清除该分组的所有通知


197
00:06:32,156 --> 00:06:34,206
通知分组


198
00:06:34,206 --> 00:06:35,806
让用户对通知的优先级管理


199
00:06:36,066 --> 00:06:36,646
变得更容易


200
00:06:37,036 --> 00:06:38,446
举个例子


201
00:06:38,746 --> 00:06:39,896
如果用户想要


202
00:06:39,896 --> 00:06:41,526
清除这些通知


203
00:06:41,526 --> 00:06:43,116
只需向左滑动


204
00:06:43,116 --> 00:06:43,526
然后点击清除所有即可


205
00:06:46,156 --> 00:06:47,916
除去显示


206
00:06:47,916 --> 00:06:49,936
通知组的内容


207
00:06:50,026 --> 00:06:50,986
我们还会显示一行概略文本


208
00:06:51,436 --> 00:06:52,906
这行概略文本


209
00:06:52,906 --> 00:06:54,886
默认显示


210
00:06:54,886 --> 00:06:56,486
该分组中包含的


211
00:06:56,486 --> 00:06:57,126
通知数量


212
00:06:58,436 --> 00:07:00,276
然而你也可以创建


213
00:07:00,276 --> 00:07:02,046
自定义的概略文本


214
00:07:02,046 --> 00:07:03,756
让用户能


215
00:07:03,756 --> 00:07:05,556
更好地理解


216
00:07:05,556 --> 00:07:07,906
该通知组中的内容


217
00:07:09,016 --> 00:07:11,066
我们会在下一场会议上


218
00:07:11,516 --> 00:07:14,276
给大家细讲这部分的接口


219
00:07:14,276 --> 00:07:15,586
并拓展更多用例


220
00:07:15,586 --> 00:07:17,406
告诉大家


221
00:07:17,496 --> 00:07:18,236
如何通过分组通知 


222
00:07:18,236 --> 00:07:20,136
创建自定义分组


223
00:07:22,036 --> 00:07:23,846
现在我给大家


224
00:07:23,846 --> 00:07:25,156
简单总结一下


225
00:07:25,156 --> 00:07:26,026
分组通知


226
00:07:26,696 --> 00:07:28,126
从 iOS 12 起


227
00:07:28,126 --> 00:07:29,966
所有 App 的通知


228
00:07:29,966 --> 00:07:31,376
将会被自动分组


229
00:07:31,886 --> 00:07:34,646
如果想创建


230
00:07:34,646 --> 00:07:36,486
自定义分组


231
00:07:36,486 --> 00:07:38,056
你需要使用


232
00:07:38,056 --> 00:07:40,896
线程标识


233
00:07:40,896 --> 00:07:42,736
但是用户


234
00:07:42,736 --> 00:07:43,806
可以改变


235
00:07:43,806 --> 00:07:45,166
这一分组设定


236
00:07:47,096 --> 00:07:48,486
最后就是


237
00:07:48,486 --> 00:07:50,716
你可以自定义


238
00:07:50,716 --> 00:07:51,996
概略文本的内容


239
00:07:51,996 --> 00:07:53,986
在通知组中


240
00:07:53,986 --> 00:07:55,006
展现给用户


241
00:07:55,256 --> 00:07:58,706
以上就是关于


242
00:07:58,706 --> 00:07:59,426
分组通知的内容


243
00:07:59,926 --> 00:08:01,416
我们的下一个主题


244
00:08:01,416 --> 00:08:03,016
有关于


245
00:08:03,016 --> 00:08:04,706
通知内容扩展


246
00:08:05,236 --> 00:08:07,466
你们当中有些人


247
00:08:07,466 --> 00:08:08,606
可能已经比较熟悉


248
00:08:08,606 --> 00:08:10,716
iOS 10 中的通知内容扩展了


249
00:08:11,976 --> 00:08:13,726
通知内容扩展


250
00:08:13,726 --> 00:08:15,776
可以丰富


251
00:08:15,776 --> 00:08:17,686
App 通知的


252
00:08:18,006 --> 00:08:20,076
展现形式


253
00:08:20,076 --> 00:08:21,996
这样用户看见的


254
00:08:21,996 --> 00:08:23,706
是更加量身定制


255
00:08:23,706 --> 00:08:25,936
交互性也更高的通知


256
00:08:25,936 --> 00:08:28,836
我们来简单回顾一下


257
00:08:28,836 --> 00:08:29,846
如何创建


258
00:08:29,846 --> 00:08:30,436
通知内容扩展


259
00:08:31,336 --> 00:08:32,686
Xcode 中提供了一个


260
00:08:32,686 --> 00:08:34,566
标准模板


261
00:08:34,635 --> 00:08:35,746
让你在你的 App 中


262
00:08:35,746 --> 00:08:39,456
为通知内容扩展


263
00:08:39,456 --> 00:08:40,986
添加一个 target


264
00:08:40,986 --> 00:08:42,306
一旦你设置好 我们就为通知的 view controller


265
00:08:42,306 --> 00:08:44,476
创建了一个默认的类


266
00:08:44,476 --> 00:08:46,296
这个类会执行


267
00:08:46,296 --> 00:08:46,716
UNNotificationContentExtension 协议


268
00:08:47,606 --> 00:08:49,026
在这里 did receive notification 方法


269
00:08:49,026 --> 00:08:51,186
非常重要


270
00:08:51,186 --> 00:08:52,516
因为这是创建


271
00:08:52,516 --> 00:08:53,576
内容扩展相关视图的


272
00:08:53,576 --> 00:08:55,116
第一步


273
00:08:55,116 --> 00:08:57,096
你可以用


274
00:08:57,096 --> 00:08:59,276
此处的通知对象


275
00:08:59,276 --> 00:09:01,006
来获取通知的相关信息


276
00:09:01,006 --> 00:09:02,586
然后创建你的


277
00:09:02,586 --> 00:09:03,126
自定义视图


278
00:09:05,436 --> 00:09:07,776
与内容扩展相关联的


279
00:09:07,776 --> 00:09:08,856
info.plist 文件


280
00:09:08,996 --> 00:09:10,076
让你有更多选择


281
00:09:11,226 --> 00:09:12,876
这里最重要的是


282
00:09:12,876 --> 00:09:14,026
类别标识


283
00:09:14,466 --> 00:09:16,056
此处的类别标识


284
00:09:16,056 --> 00:09:17,246
需要与你通知请求中的


285
00:09:17,246 --> 00:09:18,846
类别标识


286
00:09:18,846 --> 00:09:20,066
保持一致


287
00:09:20,476 --> 00:09:21,546
这样系统才知道


288
00:09:21,546 --> 00:09:23,076
哪个内容扩展


289
00:09:23,076 --> 00:09:24,566
对应哪条通知


290
00:09:26,236 --> 00:09:28,546
此外 你也可以


291
00:09:28,546 --> 00:09:30,516
快速配置


292
00:09:30,516 --> 00:09:31,756
内容扩展


293
00:09:31,756 --> 00:09:33,436
例如设置 initial content size ratio


294
00:09:33,436 --> 00:09:34,936
隐藏默认内容


295
00:09:34,936 --> 00:09:36,706
以及覆盖


296
00:09:36,836 --> 00:09:38,576
该内容扩展的标题


297
00:09:39,796 --> 00:09:41,896
用户与这些


298
00:09:41,896 --> 00:09:43,526
内容扩展产生交互的


299
00:09:43,526 --> 00:09:45,136
主要方式是


300
00:09:45,136 --> 00:09:47,086
通知的 action


301
00:09:47,086 --> 00:09:48,786
这些 action


302
00:09:48,786 --> 00:09:50,836
显示在内容扩展的内容下方


303
00:09:52,136 --> 00:09:53,786
我们也来回顾一下


304
00:09:53,786 --> 00:09:54,716
如何创建这些 action 吧


305
00:09:56,126 --> 00:09:57,976
这一步在代码中非常简单


306
00:09:58,506 --> 00:10:00,216
举个例子


307
00:10:00,216 --> 00:10:01,566
这里我们有两个 action 点赞和评论


308
00:10:01,566 --> 00:10:03,706
我们为点赞创建一个简单的


309
00:10:03,706 --> 00:10:05,336
UNNotificationAction


310
00:10:06,746 --> 00:10:08,966
为评论创建一个文字输入 action


311
00:10:11,596 --> 00:10:12,836
创建完之后


312
00:10:12,836 --> 00:10:14,236
我们创建一个


313
00:10:14,236 --> 00:10:16,186
新的类型


314
00:10:16,186 --> 00:10:17,616
让它的类型标识


315
00:10:17,616 --> 00:10:19,186
跟内容扩展的


316
00:10:19,186 --> 00:10:20,256
保持一致


317
00:10:20,256 --> 00:10:23,216
然后我们提交


318
00:10:23,216 --> 00:10:27,656
这两个新创建的 action


319
00:10:27,656 --> 00:10:29,476
建立好这个类型之后


320
00:10:29,476 --> 00:10:30,406
我们就可以调用


321
00:10:30,406 --> 00:10:32,576
与我们的 class 关联的


322
00:10:32,576 --> 00:10:34,436
UNNotificationCenter 对象的


323
00:10:34,436 --> 00:10:35,876
setNotificationCategories


324
00:10:36,176 --> 00:10:38,766
赋予它我们创建的新类型


325
00:10:40,856 --> 00:10:43,276
通过这个简单方法


326
00:10:43,276 --> 00:10:44,266
下次用户碰到


327
00:10:44,266 --> 00:10:46,226
你的内容扩展时


328
00:10:46,226 --> 00:10:47,486
用户可以通过这些 action


329
00:10:47,486 --> 00:10:49,066
与你的通知内容


330
00:10:49,066 --> 00:10:50,526
进行交互


331
00:10:51,636 --> 00:10:53,216
下面我们看一下


332
00:10:53,216 --> 00:10:54,856
如何处理从这些 action 中


333
00:10:54,856 --> 00:10:55,516
得到的响应


334
00:10:55,996 --> 00:10:57,306
有两种方式


335
00:10:58,636 --> 00:11:00,116
第一个


336
00:11:00,116 --> 00:11:02,206
你可以在 App 关联的


337
00:11:02,206 --> 00:11:03,366
AppDelegate（App 委托）中进行处理


338
00:11:03,366 --> 00:11:05,386
App 需要执行


339
00:11:05,386 --> 00:11:07,836
UNUserNotificationCenter 的授权协议


340
00:11:08,626 --> 00:11:09,716
在这里


341
00:11:09,716 --> 00:11:11,206
UserNotificationCenter


342
00:11:11,206 --> 00:11:12,906
接收到响应


343
00:11:12,906 --> 00:11:15,496
其中包括


344
00:11:15,496 --> 00:11:17,176
请求的信息


345
00:11:17,516 --> 00:11:18,716
和用户行为的


346
00:11:18,716 --> 00:11:20,046
通知请求


347
00:11:21,346 --> 00:11:22,916
然而内容扩展


348
00:11:23,176 --> 00:11:24,826
也可以让你


349
00:11:24,946 --> 00:11:26,946
拦截这个 action 的响应


350
00:11:26,946 --> 00:11:28,906
这样你就可以运用内容扩展


351
00:11:28,906 --> 00:11:30,026
来更新视图


352
00:11:30,026 --> 00:11:31,906
并创建一个更具交互性的


353
00:11:31,906 --> 00:11:32,806
动态用户体验


354
00:11:33,586 --> 00:11:35,986
在这个示例中


355
00:11:35,986 --> 00:11:37,506
我们输入了 did receive response 方法


356
00:11:38,366 --> 00:11:39,416
并对点赞这个动作


357
00:11:39,416 --> 00:11:41,056
进行检测


358
00:11:42,006 --> 00:11:44,196
然后我们用新的 label


359
00:11:44,306 --> 00:11:45,956
更新 UI


360
00:11:45,956 --> 00:11:46,886
也更新 App 状态


361
00:11:48,476 --> 00:11:50,146
最后调用 completion


362
00:11:50,146 --> 00:11:51,376
设为 do not dismiss


363
00:11:51,956 --> 00:11:53,266
如果你想要在此处


364
00:11:53,266 --> 00:11:54,476
忽略内容扩展视图


365
00:11:54,696 --> 00:11:56,486
那么你只需将


366
00:11:56,486 --> 00:11:57,646
传送给 completion 的


367
00:11:57,646 --> 00:12:00,796
参数设为 dismiss 或


368
00:12:00,796 --> 00:12:02,586
dismiss and forward


369
00:12:02,586 --> 00:12:03,896
后者会将响应发送给


370
00:12:03,896 --> 00:12:05,176
AppDelegate（App 委托）


371
00:12:05,176 --> 00:12:07,676
这个功能创建完毕后


372
00:12:07,676 --> 00:12:09,396
我们可以看到


373
00:12:09,396 --> 00:12:10,776
当用户点赞时


374
00:12:11,136 --> 00:12:13,206
内容扩展


375
00:12:13,206 --> 00:12:14,446
可以即时得到更新


376
00:12:14,966 --> 00:12:16,516
这种方式增强了


377
00:12:16,516 --> 00:12:17,946
用户交互


378
00:12:17,946 --> 00:12:18,846
他们也可以得到


379
00:12:18,846 --> 00:12:19,886
即时反馈


380
00:12:21,116 --> 00:12:22,566
但是如果观察


381
00:12:22,626 --> 00:12:23,966
内容扩展的当前状态


382
00:12:23,966 --> 00:12:26,576
我们会发现一些


383
00:12:26,576 --> 00:12:28,106
冗余的信息


384
00:12:28,996 --> 00:12:30,526
用户点赞后


385
00:12:30,526 --> 00:12:32,136
再保留


386
00:12:32,136 --> 00:12:33,506
点赞这个 action


387
00:12:33,506 --> 00:12:34,416
就没有意义了


388
00:12:36,236 --> 00:12:38,206
通常来说


389
00:12:38,206 --> 00:12:39,416
通知 action


390
00:12:39,416 --> 00:12:40,176
有一定局限


391
00:12:41,606 --> 00:12:43,506
通知不太具有动态


392
00:12:43,606 --> 00:12:45,316
也无法根据


393
00:12:45,316 --> 00:12:46,646
内容扩展的场景


394
00:12:46,646 --> 00:12:47,226
进行更新


395
00:12:48,696 --> 00:12:51,046
还有就是这些情况


396
00:12:51,046 --> 00:12:52,846
与通知的类型有关联


397
00:12:52,846 --> 00:12:54,336
而通知的类型在创建 App 时


398
00:12:54,586 --> 00:12:55,726
必须定义好


399
00:12:56,946 --> 00:12:58,526
我们想解决这个问题


400
00:12:58,526 --> 00:13:00,396
所以新增了一个


401
00:13:00,396 --> 00:13:02,326
通知 action 的接口


402
00:13:02,326 --> 00:13:04,206
有了这个接口


403
00:13:04,206 --> 00:13:05,496
我们就将通知 action


404
00:13:05,496 --> 00:13:06,666
纳入


405
00:13:06,666 --> 00:13:08,736
NSExtensionContext


406
00:13:08,736 --> 00:13:09,596
从而绑定内容扩展


407
00:13:10,686 --> 00:13:12,356
这个接口


408
00:13:12,576 --> 00:13:14,146
让你可以访问


409
00:13:14,146 --> 00:13:15,626
现阶段面向用户的


410
00:13:15,626 --> 00:13:17,626
通知 action


411
00:13:17,626 --> 00:13:19,526
也可以通过


412
00:13:19,526 --> 00:13:20,766
为内容扩展建立


413
00:13:20,766 --> 00:13:25,556
全新的通知 action 数组进行替换


414
00:13:25,556 --> 00:13:27,016
我们再来看示例


415
00:13:27,076 --> 00:13:28,826
如果用户点赞后


416
00:13:28,826 --> 00:13:30,476
我们想将点赞的 action


417
00:13:30,476 --> 00:13:32,546
替换成撤销点赞的 action


418
00:13:32,546 --> 00:13:33,896
怎么让用户可以对刚才的操作


419
00:13:33,896 --> 00:13:36,776
进行反向操作呢


420
00:13:36,956 --> 00:13:39,226
我们看一下


421
00:13:39,226 --> 00:13:40,356
如何用新的接口


422
00:13:40,356 --> 00:13:41,286
进行设置


423
00:13:41,376 --> 00:13:42,816
我们回到 did receive response 方法


424
00:13:42,816 --> 00:13:44,206
再一次识别


425
00:13:44,626 --> 00:13:46,296
点赞行为


426
00:13:46,296 --> 00:13:47,716
并更新我们的 App 状态


427
00:13:48,916 --> 00:13:51,216
这一次我们还创建了


428
00:13:51,216 --> 00:13:53,446
一个新的撤销点赞的 action


429
00:13:53,446 --> 00:13:55,476
给它添加一个独有的标识和标题


430
00:13:56,056 --> 00:13:59,816
我们可以再看一下


431
00:13:59,816 --> 00:14:01,436
现有的 action


432
00:14:01,436 --> 00:14:02,956
这样就可以提取


433
00:14:02,956 --> 00:14:04,606
评论的 action


434
00:14:04,606 --> 00:14:06,056
而不用再次创建


435
00:14:07,276 --> 00:14:09,276
然后我们创建一个


436
00:14:09,276 --> 00:14:10,326
新 action 的数组


437
00:14:10,326 --> 00:14:13,526
将数组设为


438
00:14:13,606 --> 00:14:14,936
通知 action 的变量就可以了


439
00:14:17,456 --> 00:14:19,536
这步完成后


440
00:14:19,536 --> 00:14:21,656
用户点赞之后


441
00:14:21,656 --> 00:14:23,666
UI 会自动变化


442
00:14:23,786 --> 00:14:26,236
展示新的 action


443
00:14:26,236 --> 00:14:27,416
然后用户可以再在


444
00:14:27,416 --> 00:14:28,356
两个 action 中进行选择


445
00:14:28,566 --> 00:14:29,796
这取决于你如何


446
00:14:29,796 --> 00:14:30,956
在内容扩展中


447
00:14:30,956 --> 00:14:31,486
处理状态


448
00:14:32,596 --> 00:14:34,726
这个接口


449
00:14:34,726 --> 00:14:36,026
还有其他多个用法


450
00:14:36,516 --> 00:14:38,696
例如


451
00:14:38,696 --> 00:14:40,446
在 did receive notification 方法中


452
00:14:40,446 --> 00:14:41,486
你可以在


453
00:14:41,486 --> 00:14:43,116
创建内容扩展视图的同时


454
00:14:43,116 --> 00:14:44,306
创建你的 action


455
00:14:45,036 --> 00:14:46,306
这意味着


456
00:14:46,306 --> 00:14:47,916
你的通知请求


457
00:14:47,916 --> 00:14:49,826
在定义


458
00:14:49,826 --> 00:14:51,386
通知的 action 时


459
00:14:51,386 --> 00:14:53,016
不再与类型绑定在一起


460
00:14:53,016 --> 00:14:57,126
现在你还可以


461
00:14:57,126 --> 00:14:58,956
展示二级 action


462
00:14:58,956 --> 00:15:00,846
只要将当前 action 替换掉就可以了


463
00:15:01,236 --> 00:15:03,306
例如


464
00:15:03,306 --> 00:15:05,326
如果首发 action 是评分


465
00:15:05,326 --> 00:15:07,046
下面你就可以建立一个


466
00:15:07,046 --> 00:15:08,406
包含不同评分类型的二级列表


467
00:15:08,406 --> 00:15:10,366
以供用户选择


468
00:15:12,156 --> 00:15:14,556
如果你认为


469
00:15:14,556 --> 00:15:16,176
内容扩展没有必要


470
00:15:16,176 --> 00:15:17,746
再显示这些 action 了


471
00:15:17,746 --> 00:15:19,316
你可以


472
00:15:19,316 --> 00:15:20,716
将它们去掉


473
00:15:21,106 --> 00:15:26,476
这就是通知动作的新接口


474
00:15:26,796 --> 00:15:28,456
我们认为


475
00:15:28,456 --> 00:15:30,706
这可以大大增强


476
00:15:30,706 --> 00:15:32,316
你的内容扩展的


477
00:15:32,316 --> 00:15:33,986
用户体验


478
00:15:33,986 --> 00:15:39,036
因为现在你可以 展示给用户多个选择


479
00:15:39,216 --> 00:15:40,576
我们来看下一个主题


480
00:15:40,576 --> 00:15:41,806
内容扩展的


481
00:15:41,806 --> 00:15:42,676
用户交互


482
00:15:43,836 --> 00:15:45,796
到目前为止


483
00:15:45,796 --> 00:15:47,726
通知 action 很重要


484
00:15:48,036 --> 00:15:51,146
因为 iOS 11 以前


485
00:15:51,146 --> 00:15:53,166
我们不允许在


486
00:15:53,256 --> 00:15:56,196
内容扩展视图中进行用户交互


487
00:15:56,416 --> 00:15:57,486
我们收到了


488
00:15:57,486 --> 00:15:58,536
很多相关反馈


489
00:15:58,906 --> 00:16:00,706
而我现在很高兴地宣布


490
00:16:00,836 --> 00:16:01,846
我们在 iOS 12 中


491
00:16:01,846 --> 00:16:03,126
去掉了这项限制


492
00:16:04,516 --> 00:16:07,546
[ 掌声 ]


493
00:16:08,046 --> 00:16:09,636
现在你在内容扩展中


494
00:16:09,636 --> 00:16:11,826
可以选择


495
00:16:11,826 --> 00:16:13,456
通过点触


496
00:16:13,456 --> 00:16:16,286
接收用户交互


497
00:16:16,286 --> 00:16:17,786
设置这个功能也很简单


498
00:16:18,046 --> 00:16:20,096
你只需在


499
00:16:20,096 --> 00:16:22,446
info.plist 文件中


500
00:16:22,446 --> 00:16:23,326
增添一个键值项


501
00:16:23,766 --> 00:16:26,556
也就是


502
00:16:26,556 --> 00:16:29,446
UNNotificationExtensionUser


503
00:16:29,446 --> 00:16:30,386
InteractionEnabled


504
00:16:32,586 --> 00:16:34,436
再来看示例


505
00:16:34,696 --> 00:16:36,576
如果我们想要


506
00:16:36,576 --> 00:16:38,416
去掉点赞这个 action


507
00:16:38,416 --> 00:16:40,556
将其改成


508
00:16:40,556 --> 00:16:42,626
融于视图的


509
00:16:42,626 --> 00:16:43,326
UI 点触交互


510
00:16:44,316 --> 00:16:45,506
我们再次配置


511
00:16:45,506 --> 00:16:48,376
info.plist 文件


512
00:16:48,376 --> 00:16:49,776
我们可以回到内容扩展视图


513
00:16:50,126 --> 00:16:51,976
创建自定义按钮


514
00:16:51,976 --> 00:16:53,366
来接收点赞


515
00:16:54,716 --> 00:16:56,396
我们在私有方法中添加了一个 target


516
00:16:56,396 --> 00:16:59,806
在这个函数中


517
00:16:59,806 --> 00:17:02,016
我们更新了 UI


518
00:17:02,016 --> 00:17:03,806
还有 App 的状态


519
00:17:05,316 --> 00:17:06,886
这里需要注意


520
00:17:06,886 --> 00:17:07,986
由于你在执行


521
00:17:07,986 --> 00:17:09,915
自定义的交互


522
00:17:09,915 --> 00:17:11,886
你要负责处理


523
00:17:11,886 --> 00:17:13,626
所有用户的 action


524
00:17:13,626 --> 00:17:14,846
response


525
00:17:14,846 --> 00:17:15,316
和 callback


526
00:17:17,976 --> 00:17:20,546
这部分完成后


527
00:17:20,546 --> 00:17:21,556
用户看到你的内容扩展时


528
00:17:21,556 --> 00:17:23,215
就可以看见


529
00:17:23,215 --> 00:17:24,556
这个点赞按钮


530
00:17:24,556 --> 00:17:26,705
它是 UI 中的一部分


531
00:17:26,705 --> 00:17:28,666
用户可以即时点击按钮 完成交互


532
00:17:33,126 --> 00:17:35,536
这个就是我们为


533
00:17:35,536 --> 00:17:37,096
内容扩展添加的新功能


534
00:17:37,396 --> 00:17:38,746
有了这个功能


535
00:17:38,746 --> 00:17:40,076
再加上通知 action


536
00:17:40,076 --> 00:17:41,686
还有用户交互点触


537
00:17:41,686 --> 00:17:44,966
你就可以利用这一组


538
00:17:44,966 --> 00:17:46,646
丰富的工具


539
00:17:46,646 --> 00:17:48,336
给你的 App 通知的用户


540
00:17:48,336 --> 00:17:49,986
带来更具交互性的


541
00:17:49,986 --> 00:17:50,416
动态内容扩展体验


542
00:17:52,516 --> 00:17:54,346
接下来是


543
00:17:54,346 --> 00:17:55,636
通过通知内容扩展


544
00:17:55,636 --> 00:17:56,906
启动 App


545
00:17:58,536 --> 00:18:01,146
现在 即使没有点触位置


546
00:18:01,146 --> 00:18:03,216
用户只需点击


547
00:18:03,216 --> 00:18:04,706
内容扩展视图


548
00:18:04,916 --> 00:18:07,126
就可以轻松打开 App


549
00:18:08,036 --> 00:18:09,786
用户也可以点击


550
00:18:10,046 --> 00:18:12,116
通知左上角的


551
00:18:12,596 --> 00:18:14,126
App 图标


552
00:18:14,226 --> 00:18:15,966
或者你可以创建一个


553
00:18:15,966 --> 00:18:17,786
foreground action


554
00:18:17,786 --> 00:18:19,266
让用户打开 App


555
00:18:20,936 --> 00:18:22,926
那我们如何能


556
00:18:22,926 --> 00:18:24,646
自定义启动 App 的控制呢


557
00:18:25,986 --> 00:18:27,056
如果你想通过代码启动


558
00:18:27,056 --> 00:18:28,306
要怎么做呢


559
00:18:29,206 --> 00:18:30,746
使用 NSExtensionContext


560
00:18:30,746 --> 00:18:33,136
的一个新接口


561
00:18:33,136 --> 00:18:34,656
就可以做到这点


562
00:18:34,656 --> 00:18:36,476
这个接口是 performNotification


563
00:18:36,476 --> 00:18:40,936
DefaultAction


564
00:18:40,936 --> 00:18:42,546
那么 default action 是什么呢


565
00:18:43,156 --> 00:18:45,006
刚才说过 default action


566
00:18:45,006 --> 00:18:47,046
可以启动 App


567
00:18:47,046 --> 00:18:48,036
但是同时


568
00:18:48,036 --> 00:18:49,776
会在 App 委托


569
00:18:49,776 --> 00:18:51,826
调用 UserNotificationCenter 的


570
00:18:51,826 --> 00:18:52,656
did receive response 方法


571
00:18:54,066 --> 00:18:55,416
UNNotificationResponse 的对象


572
00:18:55,416 --> 00:18:56,876
记录用户


573
00:18:56,876 --> 00:18:58,316
是从哪条通知


574
00:18:58,316 --> 00:19:00,536
点进来的


575
00:19:00,536 --> 00:19:02,476
这样你就可以根据通知


576
00:19:02,686 --> 00:19:03,416
更新 App 状态


577
00:19:04,696 --> 00:19:06,256
这里使用的


578
00:19:06,256 --> 00:19:08,766
标识符是 UNNotificationDefault


579
00:19:08,766 --> 00:19:09,746
ActionIdentifier


580
00:19:10,246 --> 00:19:12,846
让我们通过示例


581
00:19:12,956 --> 00:19:14,316
看一下如何设置


582
00:19:14,316 --> 00:19:15,806
自定义的启动控制


583
00:19:17,096 --> 00:19:19,226
现在我们创建了 UI 按钮


584
00:19:19,226 --> 00:19:21,626
以显示所有评论


585
00:19:22,656 --> 00:19:25,736
然后与我们的私有功能


586
00:19:25,736 --> 00:19:26,386
进行绑定


587
00:19:27,496 --> 00:19:28,796
在这个功能里


588
00:19:28,796 --> 00:19:29,546
我们只需调用


589
00:19:29,546 --> 00:19:30,456
PerformNotification


590
00:19:30,456 --> 00:19:31,036
DefaultAction


591
00:19:31,826 --> 00:19:33,576
这样的话


592
00:19:33,576 --> 00:19:35,186
此功能就可以


593
00:19:35,186 --> 00:19:36,446
在内容扩展的代码中


594
00:19:36,446 --> 00:19:37,586
自动调用


595
00:19:37,586 --> 00:19:40,526
这个方法


596
00:19:40,726 --> 00:19:42,676
这部分是关于启动 App 的内容


597
00:19:43,476 --> 00:19:48,336
如何解除内容扩展视图呢


598
00:19:48,546 --> 00:19:49,926
我们再来看看


599
00:19:49,926 --> 00:19:51,046
现在用户可以如何实现这一点


600
00:19:51,636 --> 00:19:52,866
用户可以点击


601
00:19:52,866 --> 00:19:54,566
右上角的退出按钮


602
00:19:55,896 --> 00:19:57,846
或者你可以


603
00:19:57,846 --> 00:19:59,346
自定义通知 action


604
00:19:59,676 --> 00:20:01,126
同样可以退出


605
00:20:01,126 --> 00:20:02,086
内容扩展视图


606
00:20:02,736 --> 00:20:04,056
我们之前讲过如何创建


607
00:20:04,056 --> 00:20:05,706
那就是向 completion block


608
00:20:05,706 --> 00:20:06,456
传递退出请求


609
00:20:08,456 --> 00:20:10,476
如果我们想


610
00:20:10,476 --> 00:20:12,326
通过自定义按钮


611
00:20:12,326 --> 00:20:14,006
退出视图


612
00:20:14,006 --> 00:20:15,006
我们如何通过代码实现呢


613
00:20:15,436 --> 00:20:16,986
假设用户点击


614
00:20:16,986 --> 00:20:18,146
点赞按钮


615
00:20:18,146 --> 00:20:19,646
视图会退出


616
00:20:19,646 --> 00:20:21,276
因为我们认为用户已经完成


617
00:20:21,276 --> 00:20:22,046
与内容扩展的交互


618
00:20:23,436 --> 00:20:25,266
为了实现这一点


619
00:20:25,266 --> 00:20:26,616
我们设了一个新接口


620
00:20:26,616 --> 00:20:27,826
dismissNotification


621
00:20:27,826 --> 00:20:29,306
ContentExtension


622
00:20:29,306 --> 00:20:30,446
它归属 NSExtensionContext


623
00:20:32,896 --> 00:20:35,046
让我们回到创建点赞按钮处


624
00:20:35,046 --> 00:20:36,556
这一次


625
00:20:36,986 --> 00:20:39,836
我们一同调用


626
00:20:39,966 --> 00:20:41,376
退出内容扩展视图的


627
00:20:41,376 --> 00:20:42,866
新功能


628
00:20:44,676 --> 00:20:46,816
创建好后


629
00:20:46,816 --> 00:20:47,816
当用户触发点赞


630
00:20:47,816 --> 00:20:49,526
内容扩展的视图


631
00:20:49,526 --> 00:20:52,776
会直接退出


632
00:20:52,826 --> 00:20:53,986
需要注意的一点是


633
00:20:53,986 --> 00:20:56,156
调用这个方法


634
00:20:56,156 --> 00:20:57,746
并不会撤回


635
00:20:57,876 --> 00:20:59,146
推送给用户的通知


636
00:20:59,836 --> 00:21:01,816
如果你想要撤回通知


637
00:21:01,816 --> 00:21:04,236
就需要使用现有的接口


638
00:21:04,236 --> 00:21:05,356
移除已发送的通知


639
00:21:05,356 --> 00:21:06,696
你需要使用标识符


640
00:21:06,696 --> 00:21:07,916
才能使用这个功能


641
00:21:09,696 --> 00:21:11,296
现在让我们总结一下


642
00:21:11,296 --> 00:21:13,266
今天介绍的


643
00:21:13,266 --> 00:21:14,486
所有通知内容扩展的


644
00:21:14,486 --> 00:21:15,926
新接口


645
00:21:18,536 --> 00:21:20,506
首先是


646
00:21:20,506 --> 00:21:22,166
通知 action


647
00:21:22,376 --> 00:21:23,356
你可以访问


648
00:21:23,356 --> 00:21:25,016
通知 action


649
00:21:25,016 --> 00:21:26,686
也可以在你的


650
00:21:26,686 --> 00:21:27,656
内容扩展代码中


651
00:21:27,656 --> 00:21:28,646
将其动态替换掉


652
00:21:28,846 --> 00:21:34,456
你现在可以选择 在内容扩展视图中


653
00:21:34,456 --> 00:21:35,886
创建可点触的


654
00:21:35,886 --> 00:21:36,666
用户交互体验


655
00:21:36,666 --> 00:21:42,116
你还可以通过内容扩展的代码


656
00:21:42,116 --> 00:21:44,926
自动启动 App


657
00:21:44,926 --> 00:21:46,196
或退出


658
00:21:46,196 --> 00:21:48,086
内容扩展视图


659
00:21:48,266 --> 00:21:49,936
你需要根据内容扩展的


660
00:21:50,056 --> 00:21:52,576
用户体验需求进行选择


661
00:21:52,896 --> 00:21:56,316
这些就是


662
00:21:56,316 --> 00:21:57,876
内容扩展的


663
00:21:57,876 --> 00:21:59,436
几个新的接口


664
00:21:59,436 --> 00:22:01,366
希望使用后


665
00:22:01,366 --> 00:22:02,476
可以帮助大家


666
00:22:02,546 --> 00:22:03,806
增强内容扩展的


667
00:22:03,806 --> 00:22:04,096
用户体验


668
00:22:04,096 --> 00:22:06,726
这些就是通知内容扩展的


669
00:22:06,726 --> 00:22:07,276
相关内容


670
00:22:07,866 --> 00:22:09,836
我们今天的


671
00:22:09,836 --> 00:22:11,316
下一个主题是


672
00:22:11,316 --> 00:22:12,986
通知管理


673
00:22:12,986 --> 00:22:14,376
现在欢迎


674
00:22:14,376 --> 00:22:15,576
我的同事 Teja 上台


675
00:22:15,776 --> 00:22:15,976
谢谢大家


676
00:22:16,516 --> 00:22:22,556
[ 掌声 ]


677
00:22:23,056 --> 00:22:23,946
>> 谢谢你 Kritarth


678
00:22:24,136 --> 00:22:24,946
大家好


679
00:22:25,416 --> 00:22:27,206
我是 Teja Kondapalli


680
00:22:27,206 --> 00:22:29,026
我也是 iOS 通知团队的


681
00:22:29,026 --> 00:22:30,146
一名工程师


682
00:22:30,546 --> 00:22:31,746
下面由我


683
00:22:31,796 --> 00:22:33,216
给大家介绍几个


684
00:22:33,216 --> 00:22:34,396
新的接口


685
00:22:35,126 --> 00:22:36,546
第一个是


686
00:22:36,916 --> 00:22:38,476
通知管理


687
00:22:39,256 --> 00:22:40,896
但是在我深入讲解前


688
00:22:40,896 --> 00:22:42,916
我想先介绍几个


689
00:22:42,916 --> 00:22:46,396
面向用户的功能


690
00:22:46,396 --> 00:22:47,776
给大家一些背景知识


691
00:22:47,776 --> 00:22:48,756
然后再让我们深入了解这些接口


692
00:22:53,136 --> 00:22:54,606
现在 用户手机上的


693
00:22:54,776 --> 00:22:55,546
App 越来越多


694
00:22:56,026 --> 00:22:59,166
通知是用户与 App 产生交互的


695
00:22:59,166 --> 00:23:00,426
主要方式


696
00:23:00,536 --> 00:23:02,516
然而通常


697
00:23:02,686 --> 00:23:04,356
用户会陷入这样一种情况


698
00:23:05,176 --> 00:23:07,446
那就是通知过多


699
00:23:07,766 --> 00:23:09,026
筛选


700
00:23:09,076 --> 00:23:10,846
重要通知


701
00:23:10,846 --> 00:23:11,096
变得非常困难


702
00:23:11,646 --> 00:23:14,756
为了减负


703
00:23:14,756 --> 00:23:16,726
有些用户认为


704
00:23:17,046 --> 00:23:18,386
播客的通知


705
00:23:19,076 --> 00:23:20,706
无需在锁屏处显示


706
00:23:21,476 --> 00:23:22,966
如果想要进行调整


707
00:23:23,606 --> 00:23:24,546
用户需要


708
00:23:24,586 --> 00:23:25,896
打开设置


709
00:23:25,896 --> 00:23:28,506
在通知里


710
00:23:29,426 --> 00:23:30,776
找到播客


711
00:23:30,776 --> 00:23:31,316
再修改设置


712
00:23:32,786 --> 00:23:33,976
我们想要缓解这个状况


713
00:23:34,616 --> 00:23:37,146
所以在 iOS 12 中


714
00:23:37,146 --> 00:23:39,936
新增了管理视图


715
00:23:39,936 --> 00:23:41,936
用户可以直接


716
00:23:41,936 --> 00:23:43,836
在接收通知的地方


717
00:23:43,836 --> 00:23:45,886
调整通知设置


718
00:23:46,026 --> 00:23:46,976
无需到设置中调整


719
00:23:51,206 --> 00:23:52,586
有三个简单的方式


720
00:23:52,626 --> 00:23:53,936
可以进入通知管理视图


721
00:23:54,436 --> 00:23:55,826
第一个我们刚才已经看过


722
00:23:56,476 --> 00:23:57,536
你只需将通知向左滑


723
00:23:57,536 --> 00:23:59,676
点击管理


724
00:24:00,416 --> 00:24:02,126
管理视图就会出现


725
00:24:03,776 --> 00:24:07,196
第二个方式


726
00:24:07,196 --> 00:24:08,956
打开通知组


727
00:24:08,956 --> 00:24:10,706
点击右上角


728
00:24:10,706 --> 00:24:12,066
你也可以打开管理视图


729
00:24:12,596 --> 00:24:15,676
第三种方式会出现在


730
00:24:15,676 --> 00:24:16,386
列表中


731
00:24:17,146 --> 00:24:18,616
这取决于用户与


732
00:24:18,616 --> 00:24:19,476
通知之间的交互


733
00:24:19,476 --> 00:24:21,006
用户有时会看到


734
00:24:21,006 --> 00:24:22,566
管理建议


735
00:24:22,616 --> 00:24:24,446
就像这个一样


736
00:24:24,446 --> 00:24:25,676
会询问用户是否保留


737
00:24:25,926 --> 00:24:27,226
播客的通知


738
00:24:27,886 --> 00:24:29,496
在这里


739
00:24:29,496 --> 00:24:31,346
用户可以点击管理


740
00:24:31,346 --> 00:24:32,086
进入管理视图


741
00:24:32,686 --> 00:24:35,456
下面我们来仔细看一下


742
00:24:35,456 --> 00:24:36,196
管理视图


743
00:24:36,866 --> 00:24:38,626
非常明显


744
00:24:38,626 --> 00:24:40,436
用户可以自行


745
00:24:40,436 --> 00:24:41,606
在这个视图中直接修改


746
00:24:41,916 --> 00:24:43,216
通知设置


747
00:24:44,136 --> 00:24:45,906
如果用户想要


748
00:24:45,906 --> 00:24:47,976
在设置里


749
00:24:47,976 --> 00:24:50,146
做更详细的修改


750
00:24:50,146 --> 00:24:52,146
可以通过设置按钮


751
00:24:52,146 --> 00:24:53,356
更快地打开


752
00:24:53,356 --> 00:24:55,446
设置程序


753
00:24:56,106 --> 00:24:58,676
在这处视图


754
00:24:58,676 --> 00:24:59,896
有一些操作用户可以直接操作


755
00:24:59,946 --> 00:25:04,046
一个是 通知静音


756
00:25:04,046 --> 00:25:05,676
这个对于大家来说


757
00:25:05,676 --> 00:25:06,276
可能比较陌生


758
00:25:07,446 --> 00:25:08,746
有时管理视图


759
00:25:08,906 --> 00:25:12,816
会显示优先发送


760
00:25:12,816 --> 00:25:16,746
我们来看看 这是什么


761
00:25:16,746 --> 00:25:18,486
在 iOS 中


762
00:25:18,486 --> 00:25:19,846
有很多设置用户都可以修改


763
00:25:19,846 --> 00:25:21,686
对于比较玩得转的用户来说


764
00:25:21,686 --> 00:25:22,896
这是一大优点


765
00:25:23,296 --> 00:25:24,756
他们可以自行修改设置


766
00:25:24,756 --> 00:25:27,326
精确到细节


767
00:25:27,326 --> 00:25:29,576
但是对于普通用户来说


768
00:25:29,576 --> 00:25:31,046
我们就需要


769
00:25:31,046 --> 00:25:32,706
协助他们


770
00:25:32,706 --> 00:25:34,516
将通知设置分成


771
00:25:34,516 --> 00:25:35,076
两大类


772
00:25:36,016 --> 00:25:37,436
一是


773
00:25:37,566 --> 00:25:39,486
优先发送的通知


774
00:25:39,536 --> 00:25:40,796
二是静音发送的通知


775
00:25:43,056 --> 00:25:46,676
我们比较熟悉优先发送的通知


776
00:25:47,076 --> 00:25:48,016
这类通知


777
00:25:48,016 --> 00:25:48,426
出现在我们的锁屏上


778
00:25:49,926 --> 00:25:50,996
出现在


779
00:25:50,996 --> 00:25:51,416
Notification Center


780
00:25:52,076 --> 00:25:53,486
也会以横幅的形式出现


781
00:25:54,226 --> 00:25:56,376
或在 App 图标上生成角标


782
00:25:56,376 --> 00:25:59,296
也有声音提示


783
00:25:59,466 --> 00:26:00,806
静音发送的通知


784
00:26:00,806 --> 00:26:02,966
只会显示在


785
00:26:02,966 --> 00:26:04,556
Notification Center 中


786
00:26:04,556 --> 00:26:08,156
并且没有声音提示


787
00:26:08,346 --> 00:26:09,876
在管理视图中


788
00:26:09,876 --> 00:26:12,066
除了可以设置


789
00:26:12,066 --> 00:26:13,506
优先发送通知


790
00:26:13,886 --> 00:26:15,176
和静音通知


791
00:26:15,176 --> 00:26:17,666
用户还可以


792
00:26:17,696 --> 00:26:20,226
选择关闭通知


793
00:26:21,636 --> 00:26:23,806
我知道现在大家


794
00:26:23,806 --> 00:26:25,146
担心用户会关闭


795
00:26:25,146 --> 00:26:26,406
你的 App 通知


796
00:26:26,406 --> 00:26:29,166
所以我们


797
00:26:29,166 --> 00:26:31,526
增加了一步确认


798
00:26:31,526 --> 00:26:33,126
以防用户误点


799
00:26:33,806 --> 00:26:35,476
用户在这里


800
00:26:35,766 --> 00:26:36,996
也可以关闭通知


801
00:26:37,426 --> 00:26:39,636
我们还新增了一个接口


802
00:26:39,636 --> 00:26:41,536
可以在确认窗口添加


803
00:26:41,906 --> 00:26:44,386
另一个选项


804
00:26:44,386 --> 00:26:46,166
播客就使用了这个接口


805
00:26:46,706 --> 00:26:48,476
所以这里显示去播客中设置


806
00:26:49,556 --> 00:26:52,176
这个地方


807
00:26:52,176 --> 00:26:54,286
链接到播客 App 内部的


808
00:26:54,326 --> 00:26:56,776
自定义设置视图


809
00:26:56,776 --> 00:26:59,256
用户可以更细致地设置


810
00:26:59,256 --> 00:27:01,106
想要接收哪个播客


811
00:27:01,106 --> 00:27:02,696
的通知


812
00:27:04,056 --> 00:27:06,096
当你的 App 通知


813
00:27:06,096 --> 00:27:07,456
数量越来越多


814
00:27:07,456 --> 00:27:09,536
类型越来越丰富时


815
00:27:09,536 --> 00:27:13,776
让用户可以细致地


816
00:27:13,776 --> 00:27:15,986
管理什么通知是重要的


817
00:27:15,986 --> 00:27:17,886
对他们来说很重要


818
00:27:21,476 --> 00:27:23,816
这个链接也可以


819
00:27:23,966 --> 00:27:26,086
从系统设置访问


820
00:27:26,336 --> 00:27:27,886
只需进入你的 App 的


821
00:27:27,886 --> 00:27:28,256
通知设置就可以找到


822
00:27:28,486 --> 00:27:30,046
对于播客来说


823
00:27:30,376 --> 00:27:31,456
这个链接在页面的下方


824
00:27:31,856 --> 00:27:34,296
名称是播客通知设置


825
00:27:34,796 --> 00:27:37,356
下面我们看看


826
00:27:37,356 --> 00:27:37,606
这些如何在代码中实现


827
00:27:38,196 --> 00:27:41,256
在 UNUserNotificationCenter


828
00:27:41,436 --> 00:27:43,256
Delegate 这个 class 中


829
00:27:43,356 --> 00:27:45,906
我们新增了一个委托方法


830
00:27:46,566 --> 00:27:48,986
也就是 openSettingsFor notification


831
00:27:49,816 --> 00:27:51,316
只要你执行


832
00:27:51,316 --> 00:27:53,296
这个委托方法


833
00:27:53,296 --> 00:27:54,866
刚才我们提到


834
00:27:54,866 --> 00:27:56,206
管理视图和系统设置中


835
00:27:56,206 --> 00:27:57,926
管理视图的链接


836
00:27:57,926 --> 00:28:00,266
系统会自动将其扩充


837
00:28:00,846 --> 00:28:03,206
所以当用户点击


838
00:28:03,206 --> 00:28:04,456
这些链接时


839
00:28:04,456 --> 00:28:06,816
就会调用这个委托方法


840
00:28:06,986 --> 00:28:09,426
重要的是


841
00:28:09,426 --> 00:28:10,696
调用这个委托方法时


842
00:28:10,696 --> 00:28:12,096
你必须立即给用户展示


843
00:28:12,096 --> 00:28:13,856
可以在 App 内


844
00:28:13,856 --> 00:28:15,906
调整通知设置的


845
00:28:15,906 --> 00:28:19,106
管理视图


846
00:28:19,366 --> 00:28:22,246
有人可能注意到


847
00:28:22,246 --> 00:28:23,626
我们给这个方法增加了一个参数


848
00:28:23,626 --> 00:28:25,766
叫做 notification


849
00:28:26,236 --> 00:28:27,726
链接在不同地方触发


850
00:28:27,726 --> 00:28:29,126
会有不同影响


851
00:28:29,126 --> 00:28:31,686
如果是在某个管理视图


852
00:28:31,686 --> 00:28:33,306
链接会包含


853
00:28:33,566 --> 00:28:35,006
该 notification 参数的值


854
00:28:35,996 --> 00:28:37,496
如果在


855
00:28:37,496 --> 00:28:39,176
系统设置中触发


856
00:28:39,176 --> 00:28:41,546
则 notification 参数的值为空


857
00:28:41,546 --> 00:28:43,366
你可以在这个委托方法


858
00:28:43,366 --> 00:28:44,466
被调用时


859
00:28:44,466 --> 00:28:46,366
显示合适的


860
00:28:46,366 --> 00:28:47,756
通知设置


861
00:28:48,286 --> 00:28:52,066
这些就是


862
00:28:52,066 --> 00:28:53,316
通知管理部分的内容


863
00:28:53,726 --> 00:28:56,266
对于用户来说


864
00:28:56,616 --> 00:28:57,726
这是一个新的方式


865
00:28:57,726 --> 00:28:58,986
可以设置重点发送或静音发送


866
00:28:59,306 --> 00:29:02,246
关闭通知


867
00:29:02,246 --> 00:29:04,346
甚至可以在 App 中


868
00:29:04,346 --> 00:29:09,293
更细致地进行设置


869
00:29:09,616 --> 00:29:12,106
为了鼓励用户


870
00:29:12,246 --> 00:29:15,616
持续接收你的通知


871
00:29:15,616 --> 00:29:16,976
我们认为很重要的一点是


872
00:29:16,976 --> 00:29:18,576
你的通知


873
00:29:18,956 --> 00:29:19,406
要切题


874
00:29:20,596 --> 00:29:23,276
我们也鼓励大家


875
00:29:23,426 --> 00:29:24,826
使用线程标识


876
00:29:24,826 --> 00:29:26,276
在适当的时候


877
00:29:26,276 --> 00:29:26,986
将通知分组


878
00:29:28,036 --> 00:29:29,046
这可以帮助用户


879
00:29:29,156 --> 00:29:31,706
更好地管理通知列表


880
00:29:32,136 --> 00:29:33,556
也确保他们


881
00:29:33,556 --> 00:29:35,186
看到你的 App 通知时


882
00:29:35,276 --> 00:29:36,526
不会觉得无从下手


883
00:29:37,716 --> 00:29:40,406
我们还认为


884
00:29:40,486 --> 00:29:41,786
如果你的 App


885
00:29:41,786 --> 00:29:43,496
会发送多个类型的通知


886
00:29:43,496 --> 00:29:44,996
你最好能在 App 中


887
00:29:44,996 --> 00:29:47,706
提供自定义设置视图


888
00:29:47,706 --> 00:29:48,986
这样用户可以


889
00:29:48,986 --> 00:29:50,566
更细致地管理


890
00:29:50,566 --> 00:29:52,686
哪种通知对他们最重要


891
00:29:54,046 --> 00:29:55,036
以上就是


892
00:29:55,036 --> 00:29:56,216
通知管理


893
00:29:57,046 --> 00:29:59,226
下面我想介绍的


894
00:29:59,226 --> 00:30:00,496
一个比较大的功能


895
00:30:00,496 --> 00:30:01,986
就是临时授权


896
00:30:02,566 --> 00:30:08,736
现在 如果一个用户安装了你的 App


897
00:30:08,736 --> 00:30:10,606
在他开始接收通知前


898
00:30:10,656 --> 00:30:12,396
必须回应


899
00:30:12,396 --> 00:30:13,586
这样的一个提示


900
00:30:14,856 --> 00:30:15,686
提示会询问用户


901
00:30:15,686 --> 00:30:16,906
是否想接收通知


902
00:30:17,606 --> 00:30:19,366
这最大的问题是


903
00:30:19,366 --> 00:30:21,596
现在用户


904
00:30:22,146 --> 00:30:23,326
无法判断


905
00:30:23,526 --> 00:30:25,126
App 会发送哪种通知


906
00:30:25,186 --> 00:30:26,676
所以他们也不知道


907
00:30:26,676 --> 00:30:27,876
是否想要接收


908
00:30:29,026 --> 00:30:31,906
在 iOS 12 中


909
00:30:32,106 --> 00:30:34,136
我们新增了临时授权


910
00:30:34,136 --> 00:30:36,356
你的 App 会自动


911
00:30:36,356 --> 00:30:38,346
试发送通知


912
00:30:39,376 --> 00:30:41,126
这可以帮助你的用户


913
00:30:41,126 --> 00:30:43,046
更好地判断


914
00:30:43,046 --> 00:30:44,156
他们是否需要


915
00:30:44,156 --> 00:30:45,336
这些通知


916
00:30:46,046 --> 00:30:48,366
你可以选择使用这个功能


917
00:30:48,366 --> 00:30:51,256
使用后


918
00:30:51,256 --> 00:30:52,586
你的用户就不会收到


919
00:30:52,586 --> 00:30:53,196
我们刚才看到的授权提示了


920
00:30:53,816 --> 00:30:56,686
相反 你的通知


921
00:30:56,686 --> 00:30:57,896
会开始自动推送


922
00:30:58,546 --> 00:31:00,946
但是这些通知


923
00:31:00,946 --> 00:31:04,076
都没有声音提示


924
00:31:04,076 --> 00:31:08,416
并且 静音发送的通知


925
00:31:08,466 --> 00:31:10,496
只会显示在 Notifications Center


926
00:31:10,606 --> 00:31:11,586
这些通知是无声的


927
00:31:15,656 --> 00:31:17,796
通过临时授权


928
00:31:17,976 --> 00:31:19,546
发送的通知


929
00:31:19,916 --> 00:31:23,246
都会带有这样的提示


930
00:31:23,846 --> 00:31:26,976
在接收了几条通知后


931
00:31:27,966 --> 00:31:29,666
可以帮助用户决定


932
00:31:29,666 --> 00:31:31,596
是否要继续接收


933
00:31:31,596 --> 00:31:32,736
这些通知


934
00:31:32,736 --> 00:31:35,236
还是决定


935
00:31:35,236 --> 00:31:39,746
关闭通知


936
00:31:40,926 --> 00:31:42,226
在确认关闭的位置


937
00:31:42,226 --> 00:31:44,056
如果你创建了


938
00:31:44,056 --> 00:31:46,076
自定义设置


939
00:31:46,076 --> 00:31:47,346
在这里它依然会出现


940
00:31:49,176 --> 00:31:50,956
我们来看看


941
00:31:50,956 --> 00:31:51,246
如何通过代码实现


942
00:31:52,426 --> 00:31:53,826
在你通常


943
00:31:53,826 --> 00:31:55,746
请求授权的位置


944
00:31:56,596 --> 00:32:00,226
除了请求的 option


945
00:32:00,356 --> 00:32:04,366
你还可以添加一个限定 option


946
00:32:04,366 --> 00:32:05,436
.provisional


947
00:32:06,176 --> 00:32:09,806
添加这个以后


948
00:32:10,036 --> 00:32:11,546
你的 App


949
00:32:11,546 --> 00:32:13,246
自动加入通知试发送


950
00:32:14,786 --> 00:32:16,126
大家需要注意


951
00:32:16,356 --> 00:32:19,656
除 .provisional option 外


952
00:32:19,656 --> 00:32:21,036
你还需要有


953
00:32:21,036 --> 00:32:22,826
其他的 option


954
00:32:23,626 --> 00:32:24,796
这是因为如果用户


955
00:32:24,796 --> 00:32:25,856
决定继续接收


956
00:32:25,856 --> 00:32:27,826
你的通知


957
00:32:27,826 --> 00:32:28,896
系统必须知道


958
00:32:28,896 --> 00:32:31,736
你想如何发送


959
00:32:31,856 --> 00:32:32,536
是否要角标 声音 还是作为提醒


960
00:32:33,186 --> 00:32:36,386
这就是临时授权


961
00:32:36,526 --> 00:32:38,236
它是自动的


962
00:32:38,236 --> 00:32:40,156
通知试发送


963
00:32:40,156 --> 00:32:41,546
可以帮助你的用户


964
00:32:41,546 --> 00:32:43,616
更好地决定


965
00:32:43,616 --> 00:32:45,116
是否要继续接收你的通知


966
00:32:46,466 --> 00:32:49,716
同样 为了鼓励用户


967
00:32:49,716 --> 00:32:51,586
继续接收


968
00:32:51,626 --> 00:32:53,266
你的通知内容


969
00:32:53,266 --> 00:32:56,066
一定要与你的 App 相关


970
00:32:57,226 --> 00:33:01,356
并且要记住一点


971
00:33:01,406 --> 00:33:03,506
使用 .provisional 作为预选项时


972
00:33:03,766 --> 00:33:05,206
还需要有其他


973
00:33:05,206 --> 00:33:05,846
你请求的 option


974
00:33:06,806 --> 00:33:07,836
这就是临时授权


975
00:33:07,836 --> 00:33:09,426
的全部内容


976
00:33:10,016 --> 00:33:14,816
我想介绍的


977
00:33:14,816 --> 00:33:16,396
最后一个大的功能


978
00:33:16,396 --> 00:33:17,456
就是重要提醒


979
00:33:18,096 --> 00:33:23,906
通常在我参加会议


980
00:33:23,906 --> 00:33:25,906
或有重要的事情时


981
00:33:25,966 --> 00:33:26,086
我的手机是这样的


982
00:33:26,506 --> 00:33:27,936
大家可以看到


983
00:33:27,936 --> 00:33:29,026
我开启了免打扰模式


984
00:33:29,736 --> 00:33:31,156
或者 我至少会


985
00:33:31,156 --> 00:33:32,606
关闭铃声


986
00:33:32,606 --> 00:33:34,476
这样我接收通知时


987
00:33:34,836 --> 00:33:35,616
就不会有声音提示


988
00:33:36,506 --> 00:33:38,326
通常来说 这样很好


989
00:33:39,346 --> 00:33:42,836
但是我可能会错过


990
00:33:42,836 --> 00:33:44,626
非常重要的通知


991
00:33:44,626 --> 00:33:46,666
就像这个 这是一条


992
00:33:46,666 --> 00:33:47,526
与健康相关的通知


993
00:33:48,016 --> 00:33:49,326
我的血糖仪提醒我


994
00:33:49,606 --> 00:33:51,336
我的血糖过低


995
00:33:51,336 --> 00:33:53,456
这样的通知


996
00:33:53,456 --> 00:33:54,746
我会希望能及时看到


997
00:33:55,996 --> 00:33:58,156
这样的场景


998
00:33:58,156 --> 00:34:00,396
让我们意识到


999
00:34:00,396 --> 00:34:02,556
我们需要一类新的通知


1000
00:34:02,556 --> 00:34:04,686
我们将它称为重要提醒


1001
00:34:05,596 --> 00:34:08,025
重要提醒是


1002
00:34:08,025 --> 00:34:09,626
医药 健康


1003
00:34:10,706 --> 00:34:12,176
家庭 安全


1004
00:34:12,176 --> 00:34:13,005
或公共安全


1005
00:34:14,286 --> 00:34:16,406
相关的通知


1006
00:34:16,766 --> 00:34:18,446
重要提醒的关键


1007
00:34:19,106 --> 00:34:21,616
在于需要用户


1008
00:34:21,616 --> 00:34:22,976
马上做出回应


1009
00:34:26,235 --> 00:34:27,716
重要提醒


1010
00:34:27,746 --> 00:34:30,065
可以忽略


1011
00:34:30,166 --> 00:34:31,516
免打扰模式


1012
00:34:31,516 --> 00:34:34,186
和铃声静音


1013
00:34:34,186 --> 00:34:35,936
发出声音提示 你甚至可以


1014
00:34:35,936 --> 00:34:36,315
自己设置提示音


1015
00:34:37,406 --> 00:34:38,616
但是这也意味着


1016
00:34:38,616 --> 00:34:40,896
重要提醒会产生干扰


1017
00:34:40,896 --> 00:34:42,795
因为这一点


1018
00:34:43,106 --> 00:34:44,806
我们认为不能允许所有的 App


1019
00:34:44,806 --> 00:34:47,996
发送重要提醒


1020
00:34:49,626 --> 00:34:51,266
想要发送重要提醒


1021
00:34:51,266 --> 00:34:53,096
首先你需要


1022
00:34:53,096 --> 00:34:55,436
申请授权


1023
00:34:55,436 --> 00:34:56,315
你可以登录


1024
00:34:56,315 --> 00:34:58,176
developer.apple 的网站申请


1025
00:34:59,776 --> 00:35:01,236
重要提醒


1026
00:35:01,236 --> 00:35:03,556
是这个样子


1027
00:35:03,556 --> 00:35:05,446
有一个独特的图标


1028
00:35:05,446 --> 00:35:06,156
表示其重要性


1029
00:35:06,706 --> 00:35:08,976
接收重要提醒时 还会有声音提示


1030
00:35:12,336 --> 00:35:14,126
在通知设置中


1031
00:35:14,196 --> 00:35:16,626
重要提醒 可单独进行设置


1032
00:35:17,996 --> 00:35:22,126
这表示 用户可以允许某个 App


1033
00:35:22,126 --> 00:35:24,456
发送重要提醒


1034
00:35:24,456 --> 00:35:26,276
但是不允许接收该 App


1035
00:35:26,276 --> 00:35:27,386
其他类型的通知


1036
00:35:27,926 --> 00:35:32,306
接收重要提醒之前


1037
00:35:32,306 --> 00:35:33,936
用户需要


1038
00:35:33,936 --> 00:35:35,866
通过这样的


1039
00:35:35,866 --> 00:35:37,416
一个提示


1040
00:35:37,416 --> 00:35:39,216
询问他们


1041
00:35:39,216 --> 00:35:41,046
是否想要接收某个 App 的


1042
00:35:41,046 --> 00:35:42,266
重要提醒


1043
00:35:43,576 --> 00:35:47,196
所以 在发送重要提醒前


1044
00:35:47,196 --> 00:35:48,576
你当然需要获得授权


1045
00:35:49,266 --> 00:35:50,536
当你的


1046
00:35:50,536 --> 00:35:53,166
授权申请通过后


1047
00:35:53,166 --> 00:35:54,356
在你通常请求授权


1048
00:35:54,356 --> 00:35:56,586
请求授权的位置


1049
00:35:56,586 --> 00:35:58,366
除了其他


1050
00:35:58,366 --> 00:36:00,916
需要请求的 option


1051
00:36:00,916 --> 00:36:02,146
你还可以请求


1052
00:36:02,146 --> 00:36:04,096
.criticalAlert option


1053
00:36:05,126 --> 00:36:07,696
用户会先看到提示


1054
00:36:13,046 --> 00:36:14,116
下面我们看看


1055
00:36:14,116 --> 00:36:15,646
如何创建和发送重要提醒


1056
00:36:15,646 --> 00:36:17,596
其实重要提醒


1057
00:36:17,596 --> 00:36:18,926
和普通通知的


1058
00:36:18,926 --> 00:36:19,696
原理相近


1059
00:36:20,376 --> 00:36:21,726
可以看到


1060
00:36:21,726 --> 00:36:23,476
我创建了一个通知


1061
00:36:23,476 --> 00:36:25,576
带有标题 主体 和类型标识


1062
00:36:25,576 --> 00:36:26,986
但是最独特的一点是


1063
00:36:26,986 --> 00:36:28,536
重要提醒


1064
00:36:28,536 --> 00:36:29,136
有声音提示


1065
00:36:29,596 --> 00:36:31,046
所以我需要设置


1066
00:36:31,046 --> 00:36:32,166
重要提醒的提示音


1067
00:36:32,806 --> 00:36:35,346
大家可以看到


1068
00:36:35,346 --> 00:36:37,286
我设置的是


1069
00:36:37,286 --> 00:36:38,926
重要提醒的默认提示音


1070
00:36:38,926 --> 00:36:39,456
由框架提供


1071
00:36:40,186 --> 00:36:43,756
我还可以自定义提示音


1072
00:36:44,716 --> 00:36:46,726
还可以自定义


1073
00:36:46,816 --> 00:36:48,006
提示音量


1074
00:36:48,996 --> 00:36:52,896
当然


1075
00:36:52,896 --> 00:36:54,926
重要提醒也可以是推送通知


1076
00:36:55,326 --> 00:36:57,356
这样所有的这些信息


1077
00:36:57,356 --> 00:36:59,826
可以在 push payload 中进行创建


1078
00:37:01,106 --> 00:37:02,746
这就是重要提醒


1079
00:37:03,356 --> 00:37:07,266
它是新类型的通知


1080
00:37:07,306 --> 00:37:09,796
需要用户及时回应


1081
00:37:10,376 --> 00:37:12,666
重要提醒会产生干扰


1082
00:37:12,666 --> 00:37:14,656
所以你需要得到授权 才可以发送


1083
00:37:18,496 --> 00:37:20,226
这就是今天要给大家介绍的


1084
00:37:20,226 --> 00:37:22,396
所有新的接口


1085
00:37:23,036 --> 00:37:24,486
我来很快给大家总结一下


1086
00:37:24,816 --> 00:37:25,996
今天的主要内容


1087
00:37:26,656 --> 00:37:30,656
我们介绍了如何


1088
00:37:30,756 --> 00:37:32,356
使用线程标识对通知分组


1089
00:37:32,356 --> 00:37:35,136
对通知分组


1090
00:37:35,136 --> 00:37:36,576
以帮助用户


1091
00:37:36,576 --> 00:37:38,706
更好地管理通知列表


1092
00:37:38,896 --> 00:37:40,206
我们介绍了


1093
00:37:40,206 --> 00:37:42,116
通知内容扩展的


1094
00:37:42,116 --> 00:37:44,046
全新接口


1095
00:37:44,046 --> 00:37:45,366
可以让你的通知


1096
00:37:45,366 --> 00:37:47,676
变得更具交互性


1097
00:37:48,256 --> 00:37:51,176
我们还谈到


1098
00:37:51,176 --> 00:37:52,796
如何在你的 App 中


1099
00:37:52,796 --> 00:37:54,746
创建自定义设置视图


1100
00:37:54,746 --> 00:37:57,256
让用户可以更精细地


1101
00:37:57,256 --> 00:37:59,626
筛选想要保留


1102
00:37:59,626 --> 00:38:02,926
哪些通知


1103
00:38:03,096 --> 00:38:04,496
再然后是


1104
00:38:04,496 --> 00:38:06,086
临时授权


1105
00:38:06,146 --> 00:38:07,306
让你的 App


1106
00:38:07,306 --> 00:38:08,876
可以自动试发送通知


1107
00:38:09,626 --> 00:38:10,806
这样你的用户


1108
00:38:10,806 --> 00:38:13,196
可以更好地决定


1109
00:38:13,196 --> 00:38:14,146
是否要保留


1110
00:38:14,146 --> 00:38:15,386
你的通知


1111
00:38:15,956 --> 00:38:18,416
最后我们介绍了


1112
00:38:18,456 --> 00:38:20,546
重要提醒


1113
00:38:20,546 --> 00:38:22,606
这是新的一类通知


1114
00:38:22,976 --> 00:38:24,566
需要用户采取


1115
00:38:24,566 --> 00:38:25,976
及时回应


1116
00:38:25,976 --> 00:38:26,686
还会产生干扰


1117
00:38:27,446 --> 00:38:29,236
我们希望你们可以利用好


1118
00:38:29,306 --> 00:38:31,506
这些非常棒的接口


1119
00:38:31,506 --> 00:38:33,236
给你们的用户


1120
00:38:33,236 --> 00:38:34,556
带来更好的通知用户体验


1121
00:38:35,556 --> 00:38:36,886
有关本次会议的


1122
00:38:36,886 --> 00:38:37,976
所有信息


1123
00:38:37,976 --> 00:38:39,206
可以在会议页面看到


1124
00:38:39,206 --> 00:38:40,776
developer.apple.com


1125
00:38:41,136 --> 00:38:42,726
我们的会议号码是 710


1126
00:38:43,406 --> 00:38:45,096
接下来还有一次会议


1127
00:38:45,096 --> 00:38:46,636
在三号大厅举行


1128
00:38:46,966 --> 00:38:48,136
内容是如何使用


1129
00:38:48,196 --> 00:38:50,096
分组通知


1130
00:38:50,096 --> 00:38:52,136
我们会帮助大家决定


1131
00:38:52,136 --> 00:38:54,346
如何将你的通知分组最有效


1132
00:38:54,736 --> 00:38:56,336
我们有两个通知实验议程


1133
00:38:56,686 --> 00:38:58,176
一个在今天 一个在明天


1134
00:38:58,426 --> 00:38:59,636
你可以向我们团队的


1135
00:38:59,636 --> 00:39:01,396
工程师询问


1136
00:39:01,396 --> 00:39:03,456
任何相关问题


1137
00:39:03,456 --> 00:39:05,416
周五上午


1138
00:39:05,416 --> 00:39:06,806
我们还有一场非常有趣的会议


1139
00:39:06,806 --> 00:39:08,166
叫做如何设计通知


1140
00:39:08,656 --> 00:39:11,726
讲者是我们的设计师


1141
00:39:11,726 --> 00:39:13,526
他们帮助我们设计了所有的这些


1142
00:39:13,566 --> 00:39:14,566
到时候他们会介绍


1143
00:39:14,916 --> 00:39:16,716
通知的最佳使用方法


1144
00:39:17,466 --> 00:39:18,976
感谢大家 祝大家顺利


1145
00:39:19,508 --> 00:39:21,508
[ 掌声 ]

