1
00:00:07,516 --> 00:00:20,516
［ 音乐 ］


2
00:00:21,246 --> 00:00:23,246
［ 掌声 ］


3
00:00:23,476 --> 00:00:23,976
>> 早上好


4
00:00:25,526 --> 00:00:27,136
早上好 欢迎来到


5
00:00:27,136 --> 00:00:29,756
管理你的 iOS App 上的文稿


6
00:00:30,836 --> 00:00:32,436
我是 Brandon Tennant 一名


7
00:00:32,436 --> 00:00:33,446
Apple 和文稿管理团队的


8
00:00:33,446 --> 00:00:34,736
软件工程师


9
00:00:35,156 --> 00:00:36,276
稍后 一起加入我的还有


10
00:00:36,276 --> 00:00:38,786
我的同事 Thomas Deniau 和 Rony Fadel


11
00:00:39,386 --> 00:00:41,476
今天我们将


12
00:00:41,476 --> 00:00:43,316
为你简单描述


13
00:00:43,316 --> 00:00:45,076
iOS 上的文稿管理是什么


14
00:00:45,106 --> 00:00:46,286
接下来我们将分享一些


15
00:00:46,286 --> 00:00:47,246
这个领域的新发现


16
00:00:48,376 --> 00:00:49,576
Thomas 将上台


17
00:00:49,576 --> 00:00:51,966
展示如何在你的 App 上 


18
00:00:51,966 --> 00:00:54,236
使用文稿管理 API


19
00:00:55,056 --> 00:00:56,886
最后 Rony 将加入我们 


20
00:00:56,886 --> 00:00:58,576
上台展示几个小建议


21
00:00:58,576 --> 00:01:00,136
和小窍门来提升


22
00:01:00,326 --> 00:01:01,256
App 的性能


23
00:01:02,436 --> 00:01:04,385
让我们先开始


24
00:01:04,385 --> 00:01:05,686
复习一下 iOS 上的文稿


25
00:01:05,686 --> 00:01:07,026
管理是什么


26
00:01:08,486 --> 00:01:10,096
它是一个多种技术的集合


27
00:01:10,416 --> 00:01:13,056
首先 为 App 开发人员提供一个 API


28
00:01:13,946 --> 00:01:15,206
为云服务供应商也提供


29
00:01:15,206 --> 00:01:16,286
File Provider API


30
00:01:16,286 --> 00:01:19,406
还有 Files App


31
00:01:20,796 --> 00:01:22,976
在 iOS 11 中 我们引入了


32
00:01:23,046 --> 00:01:24,766
UIDocumentBrowserViewController


33
00:01:25,046 --> 00:01:26,686
也显著地改进了


34
00:01:26,756 --> 00:01:28,266
UIDocumentPickerViewController


35
00:01:30,166 --> 00:01:31,406
在你的 App 中使用这个新的控制器


36
00:01:31,406 --> 00:01:33,776
你的顾客将


37
00:01:33,776 --> 00:01:35,186
能够从所有最喜欢的云服务


38
00:01:35,186 --> 00:01:36,716
供应商中 管理和浏览


39
00:01:36,716 --> 00:01:37,466
他们的文件


40
00:01:38,396 --> 00:01:39,836
搜索功能也很强大


41
00:01:39,836 --> 00:01:41,146
可以搜索所有的


42
00:01:41,146 --> 00:01:42,046
云服务供应商


43
00:01:43,276 --> 00:01:44,236
能够发现你喜欢用的文件夹


44
00:01:45,096 --> 00:01:46,276
这些你最喜欢的文件夹


45
00:01:46,276 --> 00:01:47,586
将会出现在侧边栏


46
00:01:48,636 --> 00:01:51,946
也能够用标签来管理文件夹


47
00:01:53,006 --> 00:01:55,196
最近项目使用的文件夹也会出现在


48
00:01:55,286 --> 00:01:55,946
最近项目标签中


49
00:02:00,186 --> 00:02:01,316
所以 通过在你的 App 中使用


50
00:02:01,316 --> 00:02:02,826
UIDocumentBrowserViewController


51
00:02:02,896 --> 00:02:04,276
你将为顾客提供


52
00:02:04,276 --> 00:02:05,796
一种连贯的体验


53
00:02:05,796 --> 00:02:07,166
把文件中的所有优势


54
00:02:07,166 --> 00:02:08,925
都聚集到你的 App 中


55
00:02:09,425 --> 00:02:11,026
它也使得你


56
00:02:11,026 --> 00:02:12,416
不需要编写自己的文稿浏览器


57
00:02:14,406 --> 00:02:15,686
这也允许你将精力放在


58
00:02:15,686 --> 00:02:16,846
完善你顾客的体验上


59
00:02:16,846 --> 00:02:18,966
当他们用你的 App 浏览


60
00:02:18,966 --> 00:02:20,566
或者编辑文稿时


61
00:02:21,716 --> 00:02:24,916
首先让我们看看去年的大会


62
00:02:24,916 --> 00:02:28,566
“建立伟大的基于文稿的 iOS App”


63
00:02:29,876 --> 00:02:32,096
为云服务供应商也提供了 API


64
00:02:33,786 --> 00:02:35,306
这个叫做 File Provider API


65
00:02:36,076 --> 00:02:37,506
你用这个来编写


66
00:02:37,506 --> 00:02:39,576
文件提供程序扩展


67
00:02:39,796 --> 00:02:42,196
和客户 UI 行为


68
00:02:42,196 --> 00:02:43,656
包括帐户登录界面


69
00:02:45,766 --> 00:02:47,466
对于 App 开发人员来说


70
00:02:47,466 --> 00:02:48,826
你不必通过 API 来


71
00:02:48,826 --> 00:02:50,246
让大家访问文件


72
00:02:50,246 --> 00:02:53,586
当你编写一个


73
00:02:53,996 --> 00:02:56,086
文件提供程序扩展 时


74
00:02:56,086 --> 00:02:57,336
它将会出现在文件 App 中


75
00:02:57,336 --> 00:02:58,296
出现在 UIDocumentBrowserView


76
00:02:58,296 --> 00:03:00,256
Controllers 中 在定位


77
00:03:00,256 --> 00:03:01,896
标签下 位于 Locations 这个部分


78
00:03:03,946 --> 00:03:07,746
因为登录是通过 FPUI


79
00:03:07,816 --> 00:03:09,596
ActionExtensionViewController 实现的


80
00:03:10,376 --> 00:03:11,646
你想要使用这个


81
00:03:11,646 --> 00:03:12,646
来减少和你的顾客之间的摩擦


82
00:03:12,646 --> 00:03:14,306
通过这种方式


83
00:03:14,306 --> 00:03:15,206
使得登录你的服务器更简单


84
00:03:16,096 --> 00:03:19,696
让我们通过几个例子来说明一下


85
00:03:19,916 --> 00:03:23,126
首先 在这个例子当中 


86
00:03:23,126 --> 00:03:24,136
你可以做的 或者用户


87
00:03:24,136 --> 00:03:25,796
可以做的 是登录到


88
00:03:25,796 --> 00:03:27,016
服务系统中 不被


89
00:03:27,016 --> 00:03:28,286
他们的工作流程所打断


90
00:03:28,366 --> 00:03:29,456
他们也不用离开 App 


91
00:03:29,676 --> 00:03:30,566
他们仅仅需要登录


92
00:03:30,566 --> 00:03:32,326
然后继续他们的工作就行


93
00:03:32,866 --> 00:03:35,056
应该尝试避免的是


94
00:03:35,056 --> 00:03:37,066
一些类似这样的东西


95
00:03:37,066 --> 00:03:39,096
有多余的 UI 元素


96
00:03:39,096 --> 00:03:40,576
或者屏幕商标


97
00:03:40,726 --> 00:03:41,766
你可以看到这个例子中的


98
00:03:41,766 --> 00:03:43,516
两个导航栏 或者两个取消按钮


99
00:03:44,386 --> 00:03:46,216
另一个尝试避免的例子是


100
00:03:46,216 --> 00:03:48,906
有一个简单的登录按钮


101
00:03:48,906 --> 00:03:50,616
在按钮中 登录所要做的是


102
00:03:50,616 --> 00:03:52,186
启动你的 App


103
00:03:53,046 --> 00:03:54,656
这会中断顾客的工作流程


104
00:03:55,036 --> 00:03:58,256
所以 我们应该努力避免这些


105
00:03:58,876 --> 00:04:00,136
最后 我们已经看到 


106
00:04:00,136 --> 00:04:02,996
所有开发人员和云服务供应商在去年


107
00:04:02,996 --> 00:04:04,246
所采用的这些技术


108
00:04:05,026 --> 00:04:06,966
所以有很多 App 早已使用了


109
00:04:06,966 --> 00:04:07,826
这项技术


110
00:04:08,706 --> 00:04:10,686
所以现在是在你的 App 中尝试采用


111
00:04:10,686 --> 00:04:12,236
UIDocumentBrowserViewController 


112
00:04:12,236 --> 00:04:13,536
的最佳时机


113
00:04:14,426 --> 00:04:15,516
如果你是一个


114
00:04:15,516 --> 00:04:17,396
现在还未被提供


115
00:04:17,476 --> 00:04:18,946
文件提供程序扩展 的云服务供应商


116
00:04:18,946 --> 00:04:19,805
如今是时候这样做了


117
00:04:20,696 --> 00:04:23,836
让我们谈谈一些新的东西


118
00:04:24,616 --> 00:04:26,636
首先 对于云服务供应商来说 


119
00:04:26,636 --> 00:04:28,956
我们在从事文件提供程序扩展时


120
00:04:28,956 --> 00:04:30,586
已经遇到了一些困难


121
00:04:31,316 --> 00:04:32,056
今天我们很开心地宣布


122
00:04:32,056 --> 00:04:34,036
有新工具的出现可以解决这些难题


123
00:04:34,446 --> 00:04:35,126
这个工具叫做 File 


124
00:04:35,126 --> 00:04:36,586
Provider-Validation 工具


125
00:04:37,756 --> 00:04:39,486
这个工具将指导你帮助你


126
00:04:39,486 --> 00:04:41,376
将运行测试


127
00:04:41,376 --> 00:04:42,376
向你展示 文件提供程序扩展 中的问题


128
00:04:42,376 --> 00:04:44,836
指导你修复这些问题


129
00:04:45,496 --> 00:04:46,466
如今从 developer.apple.com 中


130
00:04:46,466 --> 00:04:48,206
下载也是可行的


131
00:04:48,336 --> 00:04:49,886
当你下载的时候


132
00:04:50,666 --> 00:04:51,876
你将遇到一些东西


133
00:04:52,706 --> 00:04:53,746
你将遇到一组资源文件


134
00:04:53,746 --> 00:04:56,196
你需要添加到你的 文件提供程序扩展中


135
00:04:56,196 --> 00:04:58,666
安装一个 iOS App


136
00:04:58,666 --> 00:05:01,306
在你的 iPad 中运行


137
00:05:03,046 --> 00:05:04,506
一旦你修改了你的文件提供程序项目


138
00:05:04,506 --> 00:05:07,076
在你的 iPad 上安装了这个 App


139
00:05:07,076 --> 00:05:08,486
并且运行它


140
00:05:08,946 --> 00:05:09,876
将会出现一个


141
00:05:09,876 --> 00:05:11,446
像这样的屏幕


142
00:05:11,866 --> 00:05:13,056
你的文件提供程序将会被列出来


143
00:05:13,056 --> 00:05:14,106
在左侧进行展示


144
00:05:14,106 --> 00:05:15,566
当你轻点时


145
00:05:15,626 --> 00:05:16,886
会有一个运行按钮


146
00:05:16,886 --> 00:05:18,676
你可以点按然后


147
00:05:18,676 --> 00:05:21,136
按照你的文件提供拓展程序 来运行全套测试


148
00:05:22,246 --> 00:05:23,106
当你做完这件事情 


149
00:05:23,106 --> 00:05:25,466
你会看到一个成功和失败的列表


150
00:05:26,066 --> 00:05:26,846
你想要轻点那些失败的


151
00:05:26,846 --> 00:05:29,446
搞清楚失败的原因


152
00:05:29,446 --> 00:05:30,376
找出你代码中的错误


153
00:05:31,186 --> 00:05:32,056
在周四和周五的实验室


154
00:05:32,056 --> 00:05:33,676
我们将对你们


155
00:05:33,676 --> 00:05:36,956
提供帮助


156
00:05:38,516 --> 00:05:40,656
今年要宣布的还有一个令人激动的消息


157
00:05:40,656 --> 00:05:43,096
就是 Siri 捷径


158
00:05:43,126 --> 00:05:45,946
我们很高兴的地说 Siri 捷径


159
00:05:45,946 --> 00:05:47,386
也列入文件提供程序拓展中了


160
00:05:48,266 --> 00:05:50,136
这个所做的是屏幕会出现


161
00:05:50,196 --> 00:05:52,306
最近项目使用的


162
00:05:52,306 --> 00:05:54,116
被打开或者被创建的文件


163
00:05:54,116 --> 00:05:55,326
它们在搜索者锁屏


164
00:05:55,326 --> 00:05:57,896
中都会出现


165
00:05:58,986 --> 00:06:01,796
你能够你的顾客也能够


166
00:06:01,796 --> 00:06:05,096
在设备之间同步使用捷径


167
00:06:05,566 --> 00:06:06,436
需要注意的是


168
00:06:06,436 --> 00:06:07,686
在设备之间同步时


169
00:06:08,666 --> 00:06:10,526
为了支持这项功能


170
00:06:10,526 --> 00:06:12,396
你的文件提供程序


171
00:06:12,396 --> 00:06:14,376
需要为每一个特定客户


172
00:06:14,486 --> 00:06:16,656
的所有使用设备


173
00:06:16,656 --> 00:06:18,616
使用特定标识符


174
00:06:19,426 --> 00:06:21,266
如果是这样


175
00:06:21,316 --> 00:06:22,976
或者你可以使其发生


176
00:06:22,976 --> 00:06:24,456
你所需要做的是在你的文件提供程序中


177
00:06:24,456 --> 00:06:26,366
支持 Siri 捷径


178
00:06:26,366 --> 00:06:27,986
即添加 NSFileProvider


179
00:06:28,116 --> 00:06:30,136
UsesUniqueItemIdentifiers


180
00:06:30,136 --> 00:06:32,296
AcrossDevices 到你的文件提供拓展程序


181
00:06:32,296 --> 00:06:34,406
中的 info.plist 文件


182
00:06:35,126 --> 00:06:36,026
一旦你完成这个


183
00:06:36,026 --> 00:06:37,846
提交到商店 你就操作好了


184
00:06:38,726 --> 00:06:40,476
对于 App 的开发人员来说


185
00:06:40,476 --> 00:06:41,416
你不需要做任何事


186
00:06:42,616 --> 00:06:44,196
有关 Siri 捷径的信息
	
00:06:44,196 --> 00:06:45,736
请查看一下昨天的大会


187
00:06:45,736 --> 00:06:47,836
介绍 Siri 捷径


188
00:06:50,596 --> 00:06:54,176
今年同样 我们很高兴地宣布


189
00:06:54,176 --> 00:06:55,256
我们正在发布


190
00:06:55,256 --> 00:06:56,426
Particle Sample App


191
00:06:57,206 --> 00:06:58,196
这是一个我们示例代码


192
00:06:58,196 --> 00:06:59,516
我们去年在大会上使用过


193
00:06:59,516 --> 00:07:00,516
来展示如何在你的 App 中使用


194
00:07:00,516 --> 00:07:03,056
UIDocumentBrowserViewController 的


195
00:07:03,056 --> 00:07:05,826
它看起来是这样的 


196
00:07:06,366 --> 00:07:07,836
使用 UIDocumentBrowserViewController


197
00:07:08,206 --> 00:07:09,416
作为它主要的 viewController


198
00:07:09,806 --> 00:07:12,546
它定义一个文件的格式


199
00:07:13,296 --> 00:07:17,046
完成状态的恢复


200
00:07:17,606 --> 00:07:20,056
并且运用 UIDocumentPickerViewController


201
00:07:20,056 --> 00:07:21,796
来输入素材


202
00:07:23,406 --> 00:07:24,676
现在你能够下载这个了


203
00:07:25,336 --> 00:07:27,266
在 WW App 中可以获得链接


204
00:07:27,266 --> 00:07:29,226
你也可以上网找


205
00:07:29,786 --> 00:07:31,656
这就是 Particles


206
00:07:33,356 --> 00:07:34,636
所以 为此 我想要 


207
00:07:34,636 --> 00:07:35,976
介绍 Thomas 来到台上 


208
00:07:36,516 --> 00:07:41,546
[ 掌声 ]


209
00:07:42,046 --> 00:07:42,676
>> 大家好


210
00:07:43,286 --> 00:07:44,856
我是 Thomas 一名


211
00:07:44,856 --> 00:07:46,136
文稿管理团队的软件工程师


212
00:07:46,526 --> 00:07:47,796
我将要教大家


213
00:07:47,796 --> 00:07:49,806
如何利用你的 App 中的


214
00:07:49,806 --> 00:07:54,026
iOS 的文稿管理功能


215
00:07:54,616 --> 00:07:56,836
我们还会一起讨论


216
00:07:56,946 --> 00:07:58,536
文稿选取器


217
00:07:58,536 --> 00:08:01,686
和文稿浏览器是什么


218
00:08:01,686 --> 00:08:02,476
什么时候以及如何使用它们


219
00:08:03,566 --> 00:08:05,356
我们将添加一个文稿选取器到


220
00:08:05,356 --> 00:08:07,676
我们的样本 App Particles 中


221
00:08:08,696 --> 00:08:11,266
最后我们讨论文稿的类型


222
00:08:11,356 --> 00:08:13,016
以及如何


223
00:08:13,016 --> 00:08:14,696
在 Xcode 中正确地配置它们


224
00:08:17,256 --> 00:08:18,936
如今与这些文稿


225
00:08:18,936 --> 00:08:21,146
交互意味着什么呢


226
00:08:21,626 --> 00:08:26,926
当然 这意味着你需要提供 UI


227
00:08:26,926 --> 00:08:29,356
让你的顾客组织他们文稿


228
00:08:29,816 --> 00:08:32,246
在你的 App 容器中开始


229
00:08:32,846 --> 00:08:35,846
但是由于大多数文稿


230
00:08:35,846 --> 00:08:38,265
现在都在云端中 这意味着


231
00:08:38,426 --> 00:08:39,556
你需要让它们访问


232
00:08:39,556 --> 00:08:41,246
储存在云服务的文稿


233
00:08:41,936 --> 00:08:43,946
以及其他 App 中的文稿


234
00:08:44,876 --> 00:08:47,346
你应该怎么做


235
00:08:47,546 --> 00:08:50,196
我们为你准备两种解决方案


236
00:08:50,966 --> 00:08:53,336
文稿选取器


237
00:08:53,336 --> 00:08:55,136
和文稿浏览器


238
00:08:55,246 --> 00:08:56,936
二者之间的区别


239
00:08:56,936 --> 00:08:57,936
又是什么呢


240
00:08:59,636 --> 00:09:02,956
它们都让你浏览


241
00:09:02,956 --> 00:09:04,606
存储在你的 iOS 设备中的文件


242
00:09:04,606 --> 00:09:06,946
和在多种云服务中的文件


243
00:09:07,426 --> 00:09:11,796
也让你从其他 App 中访问文件


244
00:09:13,616 --> 00:09:16,076
然而 它们有不同的使用案例


245
00:09:16,656 --> 00:09:19,186
在很短的时间内


246
00:09:19,416 --> 00:09:21,286
你可以使用文稿选取器


247
00:09:21,286 --> 00:09:23,496
和你想要寻找的文件


248
00:09:23,496 --> 00:09:26,566
进行快速的用户交互


249
00:09:27,096 --> 00:09:29,906
另一方面文稿浏览器


250
00:09:29,906 --> 00:09:35,906
有望成为你 App 中主要的文稿浏览 UI


251
00:09:38,616 --> 00:09:41,146
让我们先开始看文稿浏览器


252
00:09:44,936 --> 00:09:46,986
就像 Brandon 提到的


253
00:09:46,986 --> 00:09:48,536
文稿浏览器是


254
00:09:48,646 --> 00:09:49,956
当你启动任何 UI App 时


255
00:09:49,956 --> 00:09:50,876
所看到的东西


256
00:09:50,876 --> 00:09:54,136
如果你的 App 是基于文稿的


257
00:09:54,696 --> 00:09:56,206
你应该使用一个


258
00:09:56,236 --> 00:09:58,786
文稿浏览器来展示这些文件


259
00:10:00,316 --> 00:10:01,686
如果你这样做了


260
00:10:02,596 --> 00:10:04,026
你的顾客启动 App 时会


261
00:10:04,026 --> 00:10:06,266
看到这些


262
00:10:06,936 --> 00:10:08,796
他们会立马找到这些文件


263
00:10:08,796 --> 00:10:11,796
这是很重要的事情


264
00:10:13,176 --> 00:10:14,756
文稿浏览器是全屏的


265
00:10:14,756 --> 00:10:17,236
可以让你的顾客


266
00:10:17,236 --> 00:10:19,506
打开和组织你的 App


267
00:10:19,506 --> 00:10:21,496
所处理的文稿


268
00:10:25,076 --> 00:10:26,966
就像 Brandon 所说


269
00:10:26,966 --> 00:10:28,206
它拥有所有文件 App 的功能


270
00:10:29,556 --> 00:10:32,326
所以搜索 标签 收藏


271
00:10:32,456 --> 00:10:34,546
最近项目 所有的这些都是免费的


272
00:10:34,546 --> 00:10:36,976
我们可以为你编辑所有内容


273
00:10:41,046 --> 00:10:43,966
可以使用自己的按钮


274
00:10:43,966 --> 00:10:46,096
进行自定义 比如
	
00:10:46,096 --> 00:10:47,116
右上角的按钮


275
00:10:47,116 --> 00:10:51,486
或者来匹配你的 App 外观


276
00:10:52,316 --> 00:10:53,986
正如你所看到的 Numbers 表格和


277
00:10:53,986 --> 00:10:56,106
Keynote 讲演看起来完全不同


278
00:10:56,106 --> 00:10:58,206
但是都在文稿浏览器控制器的


279
00:10:58,206 --> 00:10:59,036
基础上建立的


280
00:11:00,616 --> 00:11:02,856
当然 一旦你的顾客


281
00:11:02,856 --> 00:11:05,096
打开一个文稿


282
00:11:05,096 --> 00:11:08,186
你将会在浏览器顶端


283
00:11:08,356 --> 00:11:10,076
呈现你自己的 UI


284
00:11:10,076 --> 00:11:11,576
例如呈现你的文稿 UI


285
00:11:12,146 --> 00:11:13,866
如今 因为文稿 


286
00:11:13,866 --> 00:11:15,466
浏览器是你 App 的入口点


287
00:11:15,466 --> 00:11:18,916
最好让它成为根视图控制器
	
00:11:18,916 --> 00:11:21,996
然而 我们去年从你们那里


288
00:11:21,996 --> 00:11:23,616
得到很多反馈说


289
00:11:23,616 --> 00:11:25,696
使它成为


290
00:11:25,696 --> 00:11:27,626
根视图控制器并不容易


291
00:11:28,156 --> 00:11:31,116
如果是这样 我们想要


292
00:11:31,116 --> 00:11:33,246
说明一下去年给出的指南


293
00:11:33,776 --> 00:11:36,556
文稿浏览器也可以


294
00:11:36,556 --> 00:11:38,016
以全屏的方式进行呈现文稿 


295
00:11:38,016 --> 00:11:41,976
很可能就在启动后不久


296
00:11:43,496 --> 00:11:45,956
然而 这也意味着


297
00:11:45,956 --> 00:11:48,466
你 App 的起点


298
00:11:48,466 --> 00:11:50,806
在基于文稿的 App 中


299
00:11:50,806 --> 00:11:52,976
我们首先应该看到的是文稿


300
00:11:55,956 --> 00:11:58,286
所以 我们不建议


301
00:11:58,286 --> 00:12:01,996
离开浏览器


302
00:12:02,636 --> 00:12:04,686
如果你认为你需要隐藏


303
00:12:04,866 --> 00:12:07,816
浏览器 也许你可能


304
00:12:07,816 --> 00:12:09,586
需要寻找的是文稿


305
00:12:09,586 --> 00:12:11,686
选取起 我们接下来会进行讨论


306
00:12:14,056 --> 00:12:16,156
如何通过新的


307
00:12:16,226 --> 00:12:18,296
文稿浏览器控制器开始


308
00:12:18,626 --> 00:12:19,806
你可以在 Xcode 中打开一个新的 App


309
00:12:19,806 --> 00:12:21,676
然后使用


310
00:12:21,676 --> 00:12:23,006
基于文稿的 App 模板


311
00:12:24,446 --> 00:12:26,016
这个模板将给你


312
00:12:26,106 --> 00:12:28,116
基于文稿浏览器控制器的 App


313
00:12:29,226 --> 00:12:31,286
如果你有正在用的 App


314
00:12:31,286 --> 00:12:32,576
你想向其中添加一个


315
00:12:32,576 --> 00:12:34,226
DocumentBrowserViewController


316
00:12:34,226 --> 00:12:36,946
你可以拖一个文稿浏览器


317
00:12:36,946 --> 00:12:39,336
到你的 Storyboard 中


318
00:12:39,336 --> 00:12:41,976
并且在 Xcode 中用初始试图控制器复选框


319
00:12:47,606 --> 00:12:48,966
一旦你有了文稿


320
00:12:48,966 --> 00:12:50,846
浏览器控制器 你就可以进行自定义


321
00:12:52,216 --> 00:12:54,096
你可以把自己的按钮加到


322
00:12:54,096 --> 00:12:55,496
栏和菜单中


323
00:12:56,036 --> 00:12:58,966
你也可以设置自己的颜色


324
00:12:58,966 --> 00:12:59,966
和主题来匹配你 App 的外观


325
00:13:04,536 --> 00:13:07,356
你也可以自定义开关


326
00:13:07,356 --> 00:13:08,796
文稿动画


327
00:13:09,186 --> 00:13:10,436
这样一来你就可以放大


328
00:13:10,436 --> 00:13:12,016
从文稿的中心 


329
00:13:12,016 --> 00:13:14,376
转换到你自己的文件附加 UI


330
00:13:14,376 --> 00:13:16,136
想要了解这个


331
00:13:16,136 --> 00:13:18,196
请观看去年的大会


332
00:13:18,196 --> 00:13:19,986
我们在其中详细讲解了这些


333
00:13:22,046 --> 00:13:24,776
正如 Brandon 所说 我们


334
00:13:24,776 --> 00:13:26,906
在去年的大会上已经制作了示例 App


335
00:13:26,906 --> 00:13:28,816
就像现在可以获得的


336
00:13:28,846 --> 00:13:30,356
示例代码


337
00:13:32,766 --> 00:13:34,816
如今文稿选取器是一件


338
00:13:34,816 --> 00:13:36,606
截然不同的东西


339
00:13:36,656 --> 00:13:40,896
你使用它来让你的客户


340
00:13:41,016 --> 00:13:42,986
打开存储在


341
00:13:43,046 --> 00:13:45,046
云服务或者其他


342
00:13:45,046 --> 00:13:47,886
App 中的文稿或素材 但是只在


343
00:13:47,886 --> 00:13:50,226
选择文稿的时候它出现 一会就消失了


344
00:13:51,556 --> 00:13:53,576
文稿选取起就是我们


345
00:13:53,576 --> 00:13:54,236
在邮件中使用的东西


346
00:13:55,776 --> 00:13:57,686
当你想在邮件中加入一个文件


347
00:13:57,686 --> 00:14:00,316
你点击添加附件按钮


348
00:14:00,316 --> 00:14:03,526
这张表单就会弹出来


349
00:14:04,576 --> 00:14:05,976
这就是一个文稿选取器


350
00:14:06,986 --> 00:14:09,416
你选择一个添加一个文件


351
00:14:10,206 --> 00:14:11,236
这个表就消失了


352
00:14:11,806 --> 00:14:15,086
在 iWork 中是一样的


353
00:14:15,976 --> 00:14:18,056
如果你想添加一个 PDF


354
00:14:18,376 --> 00:14:20,516
到你的 Pages 文稿中


355
00:14:22,066 --> 00:14:23,736
你将从按钮轻点插入


356
00:14:23,736 --> 00:14:26,226
相同的表单会弹出来


357
00:14:26,866 --> 00:14:28,506
你选择一个文件 表单就消失了


358
00:14:29,856 --> 00:14:31,436
所以如果你需要展示用户


359
00:14:31,436 --> 00:14:33,676
界面来让你的客户


360
00:14:34,556 --> 00:14:36,406
打开 从云端中浏览东西


361
00:14:36,406 --> 00:14:39,176
一旦选中文件它就会藏起来


362
00:14:39,176 --> 00:14:41,136
文稿选取器对你来说


363
00:14:41,136 --> 00:14:42,726
是个很好的选择


364
00:14:45,336 --> 00:14:48,746
我们为什么需要给你一个文稿选取器呢


365
00:14:50,066 --> 00:14:52,156
因为正如我们所说的


366
00:14:52,426 --> 00:14:54,696
文稿可能在多个位置中


367
00:14:55,276 --> 00:14:57,386
它们可能在云端中


368
00:14:57,386 --> 00:14:58,316
也可能在其他 App 容器中


369
00:14:59,106 --> 00:15:03,576
而且在默认情况下 你无法添加访问权限


370
00:15:03,796 --> 00:15:06,226
所以 你需要做一些事情来获得


371
00:15:06,256 --> 00:15:08,586
访问权限 在这些不同的位置中


372
00:15:08,586 --> 00:15:10,236
复制和移动文稿


373
00:15:10,236 --> 00:15:16,986
这就是文稿选取器所做的事


374
00:15:17,636 --> 00:15:19,676
一旦文件被选中 它就消失


375
00:15:19,676 --> 00:15:21,756
所以如果你想让


376
00:15:21,866 --> 00:15:23,566
什么在屏幕上待的久一点


377
00:15:23,566 --> 00:15:24,986
你应该查看 


378
00:15:24,986 --> 00:15:25,916
文稿浏览器


379
00:15:31,406 --> 00:15:33,136
你可以用文件选取器做什么呢


380
00:15:33,996 --> 00:15:35,466
你可以用它干很多事情


381
00:15:36,346 --> 00:15:38,216
你可以用它在云端中


382
00:15:38,316 --> 00:15:39,466
直接访问文件


383
00:15:42,536 --> 00:15:45,646
现在 通过复制 你可以


384
00:15:45,786 --> 00:15:50,106
把文件移动到


385
00:15:50,106 --> 00:15:52,366
云端中来实现一个安全的


386
00:15:52,366 --> 00:15:52,956
云服务功能


387
00:15:53,456 --> 00:15:56,556
复制文稿通常令人


388
00:15:56,676 --> 00:15:59,106
很困惑 但是如果你


389
00:15:59,106 --> 00:16:00,896
真的想复制文件 你可以使用它


390
00:16:01,366 --> 00:16:04,796
从云端复制东西或者复制东西到云端中去


391
00:16:09,336 --> 00:16:12,506
让我们假设我们的顾客


392
00:16:12,506 --> 00:16:14,646
想要访问一部


393
00:16:14,646 --> 00:16:15,646
他们储存在云服务中的电影


394
00:16:16,506 --> 00:16:18,076
这就是使用文稿


395
00:16:18,076 --> 00:16:18,746
选取器控制器的一个绝佳例子


396
00:16:20,116 --> 00:16:21,626
你创建一个文稿选取器


397
00:16:21,626 --> 00:16:23,426
控制器 你指定


398
00:16:23,426 --> 00:16:25,566
你想让用户选择的文件类型


399
00:16:25,566 --> 00:16:27,306
作为第一个文稿


400
00:16:28,166 --> 00:16:29,666
第二个文稿是


401
00:16:29,666 --> 00:16:34,276
我们在之前的幻灯片中描述的常量之一


402
00:16:34,366 --> 00:16:36,046
然后你设置文稿


403
00:16:36,046 --> 00:16:38,026
picker.delegate 因为这是


404
00:16:38,026 --> 00:16:41,446
我们得知你的


405
00:16:41,706 --> 00:16:43,106
顾客已经选择他们的文件的一种方式


406
00:16:43,106 --> 00:16:45,866
然后你将它呈现出来


407
00:16:47,016 --> 00:16:49,376
一旦文件被选中 你将


408
00:16:49,376 --> 00:16:53,976
调用这个委托方法


409
00:16:54,136 --> 00:16:55,296
你用这种方法获得 


410
00:16:55,296 --> 00:16:56,766
你的文件 URL


411
00:16:57,426 --> 00:16:58,586
你可以直接使用它们


412
00:17:00,076 --> 00:17:03,196
你可以获得不止一个 URL


413
00:17:03,636 --> 00:17:05,236
因为你可以在


414
00:17:05,236 --> 00:17:07,646
选取器中设置一种属性


415
00:17:07,646 --> 00:17:09,566
你的顾客可以一次同时选择


416
00:17:09,566 --> 00:17:11,185
多种文件


417
00:17:15,386 --> 00:17:17,156
所以 让我们继续


418
00:17:17,286 --> 00:17:20,286
添加一个文稿选取器到我们去年的


419
00:17:20,286 --> 00:17:21,886
示例 App Particles 中 


420
00:17:26,455 --> 00:17:28,626
这是去年选择的 App


421
00:17:28,986 --> 00:17:30,316
它在文稿浏览器的基础之上


422
00:17:30,316 --> 00:17:32,486
允许我选择一个文件来打开


423
00:17:33,496 --> 00:17:35,116
正如你所看到的 我有最近项目


424
00:17:35,116 --> 00:17:36,876
有标签 有搜索


425
00:17:36,876 --> 00:17:39,276
有浏览 来列出所有的来源


426
00:17:39,796 --> 00:17:41,136
所有这些都是免费的


427
00:17:42,506 --> 00:17:44,976
现在 我可以继续 打开


428
00:17:44,976 --> 00:17:48,006
这个文件 可以微调这个


429
00:17:48,006 --> 00:17:49,536
漂亮的粒子系统


430
00:17:50,076 --> 00:17:53,586
现在 我的顾客喜欢这款 App


431
00:17:54,436 --> 00:17:56,546
但是他们想要 


432
00:17:56,546 --> 00:17:59,906
粒子变得更好看一点儿


433
00:18:00,086 --> 00:18:02,386
所以他们要求设计师们


434
00:18:02,426 --> 00:18:03,926
设计出一些更好看的


435
00:18:03,976 --> 00:18:05,586
粒子图像 


436
00:18:05,586 --> 00:18:07,336
设计师们已经在 iCloud 中共享了


437
00:18:07,336 --> 00:18:08,476
这些图像


438
00:18:09,346 --> 00:18:11,456
所以我们怎样获取这些图像然后


439
00:18:11,746 --> 00:18:12,496
对它们进行自定义呢


440
00:18:13,246 --> 00:18:15,726
我们将要做的是添加一个


441
00:18:15,726 --> 00:18:17,146
选择图像按钮在


442
00:18:17,146 --> 00:18:19,866
导航栏中 从 iCloud 中选择一个


443
00:18:19,866 --> 00:18:22,546
文件 然后自定义


444
00:18:22,816 --> 00:18:23,496
这些粒子


445
00:18:25,196 --> 00:18:26,476
所以 你可以打开你的


446
00:18:26,476 --> 00:18:29,946
Storyboard 在这里我在操作控制器


447
00:18:30,836 --> 00:18:32,306
我将拖一个新的按钮


448
00:18:32,306 --> 00:18:34,966
到编辑器中


449
00:18:40,616 --> 00:18:44,846
我将设置选择图像


450
00:18:51,156 --> 00:18:54,586
选择图像 现在 我要写代码来呈现


451
00:18:55,066 --> 00:18:59,206
控制器中的 


452
00:18:59,206 --> 00:19:00,696
文稿选取器


453
00:19:01,116 --> 00:19:05,956
我可以从我的按钮中


454
00:19:06,786 --> 00:19:10,036
拖到源代码中


455
00:19:10,036 --> 00:19:11,996
我同意叫它选择图像


456
00:19:12,556 --> 00:19:14,986
然后选择这里再连接


457
00:19:16,386 --> 00:19:17,546
现在我的代码出现了两次


458
00:19:17,886 --> 00:19:20,406
让我在一个更大的窗口


459
00:19:21,156 --> 00:19:21,976
为大家进行展示


460
00:19:26,076 --> 00:19:28,556
我在使用我的 ChooseImage 方法


461
00:19:28,996 --> 00:19:31,396
我首先要创建


462
00:19:31,486 --> 00:19:32,696
一个 UIDocumentPickerController


463
00:19:32,776 --> 00:19:34,826
我指定了


464
00:19:34,826 --> 00:19:36,006
想让顾客选择的文件类型


465
00:19:36,396 --> 00:19:40,666
这是 UTTypeImage 和模式


466
00:19:40,966 --> 00:19:42,306
我在使用输入因为我


467
00:19:42,306 --> 00:19:44,896
想把粒子图像嵌入到


468
00:19:44,896 --> 00:19:45,536
我的文稿中


469
00:19:46,236 --> 00:19:49,316
但是在大多数情况下 你将使用的是打开


470
00:19:51,536 --> 00:19:54,256
你设置你的文稿 picker.delegate


471
00:19:54,796 --> 00:19:56,056
然后将其呈现出来


472
00:19:57,406 --> 00:19:59,986
当文稿选取器被调用


473
00:19:59,986 --> 00:20:02,796
文件被选中


474
00:20:02,796 --> 00:20:03,976
你又返回到了原来的界面


475
00:20:04,046 --> 00:20:07,436
所以 我们需要用这种方法完成 document.Picker


476
00:20:08,136 --> 00:20:10,516
我不知道你注意到没有 但是


477
00:20:10,986 --> 00:20:14,136
我没有设置一种属性来


478
00:20:14,446 --> 00:20:16,416
选择文件夹


479
00:20:17,716 --> 00:20:20,006
所以 我将要检查


480
00:20:20,006 --> 00:20:22,046
这儿只有一个 URL


481
00:20:24,296 --> 00:20:27,016
找到第一个 URL


482
00:20:27,076 --> 00:20:28,306
从那创建一个图像


483
00:20:29,296 --> 00:20:31,756
在我们的粒子系统中设置它


484
00:20:31,756 --> 00:20:32,976
这也许是[ 音质不清晰 ]


485
00:20:34,396 --> 00:20:36,156
让我们再运行一次


486
00:20:37,836 --> 00:20:39,796
它启动我的 App 并且会


487
00:20:39,796 --> 00:20:40,976
迅速打开我的模拟器


488
00:20:47,776 --> 00:20:48,566
所以 我现在到这了


489
00:20:48,636 --> 00:20:49,976
我在模拟器里


490
00:20:50,026 --> 00:20:51,076
我可以打开我的文件


491
00:20:51,076 --> 00:20:52,716
在我的导航栏中


492
00:20:52,716 --> 00:20:55,426
我有了这个新的选择 图像按钮


493
00:20:55,426 --> 00:20:58,236
我可以轻点它 然后我的文稿


494
00:20:58,236 --> 00:20:59,446
选取器就出来了


495
00:20:59,446 --> 00:21:01,136
正如你所看到的 再一次 我们


496
00:21:01,166 --> 00:21:02,296
在文件 App 中有了所有的图像


497
00:21:02,296 --> 00:21:03,926
我们可以搜索我们的文件 你有标签


498
00:21:04,256 --> 00:21:06,476
你可以浏览


499
00:21:06,476 --> 00:21:07,696
所有这些都是免费的


500
00:21:09,266 --> 00:21:12,146
现在 我的粒子图像


501
00:21:12,146 --> 00:21:13,066
分享到了 
	
00:21:13,066 --> 00:21:14,576
iCloud 所以它们出现在


502
00:21:14,576 --> 00:21:15,536
［ 音质不清晰 ］


503
00:21:15,536 --> 00:21:18,166
再一次 使用这个小星星的图像


504
00:21:18,866 --> 00:21:21,976
选择它 我的粒子就变成了小星星


505
00:21:22,516 --> 00:21:28,616
［ 掌声 ］


506
00:21:29,116 --> 00:21:30,126
这个很简单


507
00:21:30,736 --> 00:21:32,646
当你回来工作时


508
00:21:32,646 --> 00:21:33,816
你将能够立刻添加


509
00:21:33,816 --> 00:21:36,796
一个文稿选取器到你的 App 中


510
00:21:37,386 --> 00:21:39,836
它没有很多代码


511
00:21:39,836 --> 00:21:41,806
也不依赖任何


512
00:21:41,806 --> 00:21:42,736
第三方资料库


513
00:21:43,576 --> 00:21:45,416
你的顾客可以很简单地访问


514
00:21:45,416 --> 00:21:47,916
他们的文件 不管文件存储在哪儿


515
00:21:48,446 --> 00:21:51,116
现在 你注意到


516
00:21:51,116 --> 00:21:53,536
在演示中 我们再一次提到了文件类型


517
00:21:53,866 --> 00:21:55,596
你们当中的很多人可能


518
00:21:55,596 --> 00:21:56,866
不知道文件类型是什么


519
00:21:57,246 --> 00:22:01,296
让我们谈一谈文件类型


520
00:22:02,186 --> 00:22:04,126
文件类型可以让系统


521
00:22:04,126 --> 00:22:05,706
识别 你的 App 知道如何处理


522
00:22:05,706 --> 00:22:07,516
哪种文件


523
00:22:08,036 --> 00:22:12,176
它们很重要因为


524
00:22:12,366 --> 00:22:16,376
当在文件 App 中选择文件时


525
00:22:16,376 --> 00:22:17,916
它们让 iOS 打开你的 App


526
00:22:19,096 --> 00:22:21,456
它们也会让它在


527
00:22:21,596 --> 00:22:22,406
分享表单中显示你的 App


528
00:22:23,016 --> 00:22:26,436
最后它允许 iOS


529
00:22:26,436 --> 00:22:27,976
为你的文稿选择合适的图标


530
00:22:29,126 --> 00:22:30,626
所以 如果我想正确配置我的类型


531
00:22:30,626 --> 00:22:32,336
如果我想


532
00:22:32,336 --> 00:22:35,406
进行扩展 我将在浏览


533
00:22:35,406 --> 00:22:37,426
粒子文件时在文件 App 中看到这个


534
00:22:37,906 --> 00:22:40,606
如果我没有 我将看到的


535
00:22:40,606 --> 00:22:42,456
是这个 不太美观


536
00:22:42,456 --> 00:22:44,236
我的客户也不能


537
00:22:44,236 --> 00:22:46,056
从文件 App 中打开我的文件


538
00:22:47,256 --> 00:22:48,856
所以 让我们一起设置这个


539
00:22:51,376 --> 00:22:55,036
当你想设置文稿类型 这有两个步骤


540
00:22:55,966 --> 00:22:57,376
首先你需要声明类型


541
00:22:57,376 --> 00:22:58,986
如果不是已被 iOS


542
00:22:58,986 --> 00:23:00,936
声明过的 接下来你需要 


543
00:23:00,936 --> 00:23:04,216
确认 告诉 iOS 你可以


544
00:23:04,216 --> 00:23:06,486
浏览或者编辑这种文件类型


545
00:23:07,136 --> 00:23:10,326
首先开始声明类型


546
00:23:10,836 --> 00:23:13,056
第一个问题是你需要


547
00:23:13,056 --> 00:23:15,616
问问自己 你需要声明它吗


548
00:23:16,486 --> 00:23:19,146
因为在多数情况下 你将


549
00:23:19,146 --> 00:23:20,666
处理普通的文件类型


550
00:23:21,176 --> 00:23:23,316
比如视频 图像 PDF


551
00:23:23,366 --> 00:23:24,896
展示和电子表格


552
00:23:25,966 --> 00:23:28,226
如果是这样 iOS


553
00:23:28,226 --> 00:23:30,416
很可能已为你声明了类型


554
00:23:31,266 --> 00:23:32,626
想要知道是否属实


555
00:23:32,626 --> 00:23:35,056
你可以在这个短的


556
00:23:35,056 --> 00:23:37,846
URL 中查看文件


557
00:23:40,536 --> 00:23:42,996
如果是这样 很好 你


558
00:23:42,996 --> 00:23:45,386
不需要再做任何事 


559
00:23:45,386 --> 00:23:47,746
你可以立即确认类型了


560
00:23:50,496 --> 00:23:53,276
另一种常见的情况是


561
00:23:53,276 --> 00:23:55,326
当你写入一个 App 它定义


562
00:23:55,446 --> 00:23:56,756
它自己的文件格式


563
00:23:57,856 --> 00:23:58,996
你创造了自己的文件


564
00:23:58,996 --> 00:24:01,546
格式 你定义它的类型


565
00:24:02,466 --> 00:24:03,716
接下来你应该声明你的


566
00:24:03,716 --> 00:24:06,406
类型 正如输出的那样 告诉


567
00:24:06,406 --> 00:24:08,986
iOS 你有权力声明


568
00:24:08,986 --> 00:24:10,166
这个文件类型


569
00:24:12,216 --> 00:24:14,316
这就是我所在的情景


570
00:24:14,316 --> 00:24:17,536
在文件 App 中 对不起


571
00:24:18,016 --> 00:24:18,816
在 Particles App 中


572
00:24:19,236 --> 00:24:21,956
我的 Particles 文件格式是我自己设置的


573
00:24:21,996 --> 00:24:25,976
所以我可以打开 Xcode


574
00:24:25,976 --> 00:24:29,346
来设置这种类型


575
00:24:29,536 --> 00:24:31,996
在这个输出的 UI


576
00:24:31,996 --> 00:24:34,346
部分 可以让我编辑自己的 


577
00:24:34,346 --> 00:24:37,176
info.plist 我指定类型标识符


578
00:24:37,176 --> 00:24:40,846
这是一个我选择的字符串


579
00:24:41,516 --> 00:24:42,696
所以 接下来是


580
00:24:42,696 --> 00:24:44,766
一个例子 有关示例


581
00:24:44,766 --> 00:24:50,026
代码 粒子 我需要


582
00:24:50,026 --> 00:24:51,276
声明一系列父类型


583
00:24:51,276 --> 00:24:53,186
在 Conforms To 字段中


584
00:24:54,396 --> 00:24:58,356
什么是父类型


585
00:24:58,536 --> 00:25:01,406
类型形成一棵树 


586
00:25:01,406 --> 00:25:02,946
我们叫做［ 音质不清晰 ］树


587
00:25:03,906 --> 00:25:08,276
你可以把它想成一个


588
00:25:08,276 --> 00:25:09,196
［ 音质不清晰 ］比如 Swift


589
00:25:10,546 --> 00:25:13,856
例如 JPEG 图像和


590
00:25:14,256 --> 00:25:17,556
HEIF 图像都是图像


591
00:25:18,626 --> 00:25:21,116
图像符合我们的根


592
00:25:21,116 --> 00:25:23,536
类型 为客户所创建或


593
00:25:23,536 --> 00:25:26,156
客户所见文稿


594
00:25:26,156 --> 00:25:29,976
叫做 public.content


595
00:25:30,076 --> 00:25:31,416
现在 public.content 有其他 


596
00:25:31,416 --> 00:25:33,366
孩子 比如像


597
00:25:33,366 --> 00:25:34,166
public.spreadsheet


598
00:25:35,996 --> 00:25:38,666
你可以在我之前


599
00:25:38,786 --> 00:25:42,586
指出的文件中找到这一类型系列


600
00:25:42,586 --> 00:25:43,776
现在 我们需要在这棵树中


601
00:25:43,776 --> 00:25:45,706
为我的类型 Particle 找到一个点


602
00:25:46,956 --> 00:25:49,186
因为 Particle 系统不是


603
00:25:49,296 --> 00:25:51,916
一个普通的文件种类


604
00:25:51,916 --> 00:25:53,516
没有任何［ 音质不清晰 ］种类 


605
00:25:54,076 --> 00:25:55,736
所以 我不能仅仅直接


606
00:25:55,736 --> 00:25:58,786
遵照 public.content 


607
00:25:58,876 --> 00:26:00,226
我需要通过 public.spreadsheet 


608
00:26:00,226 --> 00:26:02,196
或者图像直接


609
00:26:02,506 --> 00:26:03,786
或间接遵照


610
00:26:03,786 --> 00:26:06,326
public.content 如果


611
00:26:06,326 --> 00:26:07,956
我想要我的文件在


612
00:26:07,956 --> 00:26:11,616
最近项目或者搜索中出现


613
00:26:12,456 --> 00:26:13,766
接下来你有了第二棵树


614
00:26:14,166 --> 00:26:15,446
我们叫做物理树


615
00:26:16,046 --> 00:26:17,706
它可以让 iOS 知道


616
00:26:17,706 --> 00:26:19,316
文件怎样在磁盘中显示


617
00:26:20,216 --> 00:26:21,706
这个就简单多了


618
00:26:22,036 --> 00:26:23,926
因为你只有两种选择


619
00:26:25,406 --> 00:26:27,556
多数情况下 你将为 


620
00:26:27,556 --> 00:26:29,286
你的文稿处理磁盘上的


621
00:26:29,286 --> 00:26:31,496
单个文件


622
00:26:32,136 --> 00:26:35,956
如果你需要把很多


623
00:26:35,956 --> 00:26:38,446
资源聚集起来 你有


624
00:26:38,446 --> 00:26:40,446
文件包 你将


625
00:26:40,446 --> 00:26:42,006
使用 com.apple.package


626
00:26:42,466 --> 00:26:43,536
但多数情况下 你有一个


627
00:26:43,536 --> 00:26:45,926
单独的文件磁盘 它是 public.data


628
00:26:47,656 --> 00:26:49,146
这是因为我现在在用


629
00:26:49,186 --> 00:26:52,156
Particle 我要遵守 public.data


630
00:26:52,746 --> 00:26:55,936
现在 因为这是一棵树


631
00:26:56,346 --> 00:26:58,666
从物理体系结构和根类型中


632
00:26:58,666 --> 00:27:00,786
迭代 .data 和 .pakage


633
00:27:00,786 --> 00:27:04,366
这就是 public.item


634
00:27:04,816 --> 00:27:06,566
但是 如果你不在乎这个


635
00:27:06,616 --> 00:27:08,476
你只需要在


636
00:27:08,476 --> 00:27:10,546
.data 和 .package 进行选择 


637
00:27:11,026 --> 00:27:12,126
因此 你有两个父母


638
00:27:12,726 --> 00:27:14,536
public.data 和 public.content


639
00:27:15,586 --> 00:27:17,756
所以在我的 Xcode UI 中 我将要


640
00:27:17,756 --> 00:27:20,266
遵循 public.data 和


641
00:27:20,266 --> 00:27:21,726
public.content 来编写


642
00:27:22,196 --> 00:27:26,336
我需要做的最后一件事是


643
00:27:26,456 --> 00:27:28,966
告诉 iOS 哪个文件扩展和 


644
00:27:29,026 --> 00:27:31,786
我的类型有联系


645
00:27:33,016 --> 00:27:35,046
这就是 iOS 如何知道 


646
00:27:35,046 --> 00:27:37,796
Particle 文件是这种定义的类型


647
00:27:38,336 --> 00:27:41,326
为此 我将 UTType


648
00:27:41,386 --> 00:27:45,786
分类属性添加到我的属性中 


649
00:27:46,776 --> 00:27:50,036
在这个词典当中 我添加一把钥匙


650
00:27:50,076 --> 00:27:53,436
叫做 public.filename-extension 和


651
00:27:53,436 --> 00:27:55,286
你想与你的类型相联系的


652
00:27:55,286 --> 00:27:58,926
［ 音质不清晰 ］文件拓展


653
00:27:59,066 --> 00:28:01,996
我在 Particle 上有一个新项目


654
00:28:02,656 --> 00:28:06,396
说完这话 我们的声明


655
00:28:06,886 --> 00:28:07,286
就完成了


656
00:28:08,856 --> 00:28:11,876
还有一件事我没提


657
00:28:12,406 --> 00:28:19,056
就是我们声明自己类型的情况


658
00:28:19,746 --> 00:28:21,026
但是 你可能想使用


659
00:28:21,026 --> 00:28:22,926
另一 App定义的类型


660
00:28:23,476 --> 00:28:26,286
如果是这样 你也


661
00:28:26,286 --> 00:28:28,616
需要声明类型以便


662
00:28:28,616 --> 00:28:31,596
iOS 知道 以防 App 不安全


663
00:28:32,486 --> 00:28:34,486
因为这是一个输入的


664
00:28:34,636 --> 00:28:39,096
类型声明 这意味着


665
00:28:39,486 --> 00:28:41,856
如果 iOS 发现一个额外的


666
00:28:41,856 --> 00:28:42,956
别处的类型定义


667
00:28:43,006 --> 00:28:44,856
它可能更喜欢这个定义


668
00:28:44,856 --> 00:28:46,366
胜过你的定义


669
00:28:47,476 --> 00:28:48,826
这也是你需要做的事


670
00:28:49,236 --> 00:28:50,606
如果你想使用一个至今 iOS


671
00:28:50,606 --> 00:28:53,396
还没有声明的类型


672
00:28:54,536 --> 00:28:55,736
现在 不要惊慌 这个 UI


673
00:28:55,736 --> 00:28:58,976
与我们刚才所做的一样


674
00:28:58,976 --> 00:29:02,136
除了它是输入


675
00:29:02,136 --> 00:29:03,946
而不是输出


676
00:29:08,046 --> 00:29:09,696
一旦你定义了类型


677
00:29:10,066 --> 00:29:11,846
你可以要求支持它


678
00:29:12,256 --> 00:29:14,966
这仍然在你的 info.plist 里或者 Xcode UI 里


679
00:29:15,596 --> 00:29:19,996
为此 你指定


680
00:29:19,996 --> 00:29:21,336
你已定义的类型标识符


681
00:29:21,336 --> 00:29:23,586
你需要做的


682
00:29:23,836 --> 00:29:26,176
另一件事是


683
00:29:26,276 --> 00:29:27,276
定义一个等级


684
00:29:28,016 --> 00:29:30,596
这让 iOS 知道 


685
00:29:30,596 --> 00:29:32,476
当你轻点文件时做什么


686
00:29:32,526 --> 00:29:35,026
且多个 App 可以打开这个文件


687
00:29:36,796 --> 00:29:39,046
为此 你有三种选择


688
00:29:42,316 --> 00:29:44,646
第一种是如果是你自己的文件类型


689
00:29:45,716 --> 00:29:46,496
你选择 Owner 


690
00:29:47,026 --> 00:29:48,316
要清楚的是


691
00:29:48,316 --> 00:29:50,396
只有当你碰巧建立


692
00:29:50,396 --> 00:29:52,586
自己的文件类型时才可以使用


693
00:29:53,896 --> 00:29:56,346
大多数情况 你想使用


694
00:29:56,426 --> 00:30:00,386
Default 如果你可以编辑


695
00:30:00,386 --> 00:30:02,466
这种类型的文件 或者 Alternate 如果


696
00:30:02,586 --> 00:30:03,996
你可以阅读这种类型的文件


697
00:30:03,996 --> 00:30:04,976
但是不编辑它们


698
00:30:05,876 --> 00:30:09,786
以及一系列的规则


699
00:30:09,786 --> 00:30:12,946
在 macOS 上是不同的 如果是


700
00:30:12,946 --> 00:30:14,936
是 macOS 请


701
00:30:14,936 --> 00:30:17,166
看这个其他的短链接


702
00:30:20,616 --> 00:30:21,756
当声明支持一个


703
00:30:21,756 --> 00:30:24,156
类型 请尽可能具体化


704
00:30:25,086 --> 00:30:26,666
我们刚声明支持


705
00:30:26,666 --> 00:30:28,076
一个很具体的文件类型 所以是


706
00:30:28,076 --> 00:30:28,986
Particle 文件类型


707
00:30:29,616 --> 00:30:30,656
但你也可以声明支持


708
00:30:30,656 --> 00:30:32,346
不同类别 比如任何


709
00:30:32,346 --> 00:30:34,206
用 public.image 的图像


710
00:30:35,336 --> 00:30:37,396
这很好 但你需要 
	
00:30:37,396 --> 00:30:39,106
尽可能具体地使


711
00:30:39,106 --> 00:30:41,826
你的 App 准确展示出它需要展示的内容


712
00:30:42,926 --> 00:30:44,646
不要声明支持


713
00:30:44,646 --> 00:30:46,156
更宽泛的类型 比如 


714
00:30:46,156 --> 00:30:48,086
public.data 或者 public.content


715
00:30:49,766 --> 00:30:51,076
因为这会使你的 App


716
00:30:51,076 --> 00:30:52,696
出现在你的顾客


717
00:30:52,696 --> 00:30:54,596
不希望看到它出现的地方


718
00:30:54,596 --> 00:30:55,946
它会使他们困惑


719
00:31:00,246 --> 00:31:02,006
所以 有了这些信息你可以做什么


720
00:31:02,506 --> 00:31:05,866
首先 如果你需要


721
00:31:05,936 --> 00:31:07,566
在云端中访问文件


722
00:31:07,906 --> 00:31:09,106
你应该使用文稿


723
00:31:09,106 --> 00:31:10,336
浏览器或文稿选取器


724
00:31:10,626 --> 00:31:11,676
来获取这些文件


725
00:31:12,646 --> 00:31:15,216
大多数云服务供应商已采用


726
00:31:15,836 --> 00:31:18,836
我们的 API 所以如果你使用 


727
00:31:18,836 --> 00:31:20,206
这些 viewControllers 中的一个 


728
00:31:20,206 --> 00:31:21,976
你的顾客就能够访问


729
00:31:21,976 --> 00:31:24,186
他们的文件 不管文件在哪儿


730
00:31:24,546 --> 00:31:26,136
你不必为每个


731
00:31:26,136 --> 00:31:28,256
云服务供应商写代码


732
00:31:29,896 --> 00:31:32,736
如果你在 iOS 11 前写了自己


733
00:31:32,816 --> 00:31:35,356
自定的文件浏览 UI


734
00:31:35,356 --> 00:31:38,216
现在是时候换到


735
00:31:38,216 --> 00:31:39,556
UIDocumentBrowserViewController 了


736
00:31:40,896 --> 00:31:42,856
它有很多功能


737
00:31:43,996 --> 00:31:47,316
它有很多功能 所以


738
00:31:47,316 --> 00:31:49,336
困难的工作交给我们


739
00:31:49,336 --> 00:31:50,626
为你免费提供你 App 中的


740
00:31:50,626 --> 00:31:51,996
所有功能


741
00:31:54,196 --> 00:31:55,626
最后 请保证你的


742
00:31:55,626 --> 00:31:57,226
文稿类型在 Xcode 中得到


743
00:31:57,226 --> 00:31:59,276
正确设置以便你的 App


744
00:31:59,276 --> 00:32:02,386
在它需要的地方准确出现


745
00:32:02,386 --> 00:32:05,676
并帮助客户找到它


746
00:32:05,676 --> 00:32:08,676
说到这 我接下来要


747
00:32:08,676 --> 00:32:09,976
把舞台交给我的同事 Ronny


748
00:32:10,516 --> 00:32:15,576
［ 掌声 ］


749
00:32:16,076 --> 00:32:16,846
>> 谢谢 Thomas


750
00:32:17,336 --> 00:32:18,136
大家好


751
00:32:18,516 --> 00:32:20,026
我是 Rony Fadel


752
00:32:20,026 --> 00:32:21,346
文稿管理团队的一名


753
00:32:21,346 --> 00:32:22,836
软件工程师


754
00:32:23,356 --> 00:32:25,306
Thomas 已经解释了


755
00:32:25,306 --> 00:32:27,256
在你的 App 中


756
00:32:27,486 --> 00:32:29,486
使用文稿浏览器和文稿选取器


757
00:32:29,486 --> 00:32:30,946
API 是多么简单 


758
00:32:31,426 --> 00:32:32,826
现在 你已使用这些


759
00:32:32,826 --> 00:32:34,586
API 我们想介绍一些


760
00:32:34,586 --> 00:32:36,526
最佳做法来确保


761
00:32:36,526 --> 00:32:38,066
你的 App 在 iOS 生态体系中


762
00:32:38,126 --> 00:32:40,736
表现良好


763
00:32:41,196 --> 00:32:44,856
在你向 App Store 提交它的时候


764
00:32:44,856 --> 00:32:46,906
既然我们已经完成一个


765
00:32:46,906 --> 00:32:48,986
基于文稿浏览器的 App 或者


766
00:32:48,986 --> 00:32:51,596
增加了选取器的支持 现在我们准备


767
00:32:51,596 --> 00:32:53,366
好最后选择一些文稿


768
00:32:54,446 --> 00:32:56,146
你的 App 可能想要


769
00:32:56,146 --> 00:32:58,816
直接访问文件 避免


770
00:32:58,816 --> 00:33:00,906
Thomas 提过的输入复制模式


771
00:33:00,906 --> 00:33:03,236
或者如果你


772
00:33:03,296 --> 00:33:04,956
想直接编辑你的文稿


773
00:33:05,376 --> 00:33:06,816
为此 你需要在


774
00:33:06,816 --> 00:33:08,076
打开模式下激活选取器


775
00:33:09,536 --> 00:33:11,096
在此例中


776
00:33:11,096 --> 00:33:13,476
我们在 Particle App 中 我们已经


777
00:33:13,476 --> 00:33:15,726
在打开模式中创建和呈现了选取器


778
00:33:16,366 --> 00:33:17,616
我们想选择一个图像


779
00:33:17,616 --> 00:33:19,146
文件来改变粒子


780
00:33:19,146 --> 00:33:19,936
系统的图像


781
00:33:21,436 --> 00:33:23,936
一旦我们选中一个文件 我们


782
00:33:23,936 --> 00:33:26,686
调用两个委托方法中的一个


783
00:33:27,566 --> 00:33:29,616
第一 如果我们在


784
00:33:29,616 --> 00:33:32,126
浏览器中选择文稿或者


785
00:33:32,346 --> 00:33:34,216
第二 如果我们


786
00:33:34,216 --> 00:33:36,326
在选取器中选择 就像我们的示例


787
00:33:36,326 --> 00:33:40,716
我们在这看到了文稿


788
00:33:40,936 --> 00:33:43,466
我们看到的实际是这个文稿选取器


789
00:33:43,466 --> 00:33:46,956
为我们刚刚选择 URL 为我们的 App 服务


790
00:33:48,066 --> 00:33:50,036
如果我们想直接


791
00:33:50,036 --> 00:33:52,536
访问文稿 我们冒着


792
00:33:52,536 --> 00:33:53,976
权限错误的风险


793
00:33:55,356 --> 00:33:57,546
让我们试着理解这种情况发生的原因


794
00:33:58,546 --> 00:34:00,376
你也许知道 你在 iOS 的


795
00:34:00,506 --> 00:34:01,966
App 是沙箱


796
00:34:02,816 --> 00:34:04,666
这个沙箱 App 是一个安全


797
00:34:04,666 --> 00:34:07,286
功能 然而每个 App 在


798
00:34:07,356 --> 00:34:09,426
它自己的 App 容器中都可以


799
00:34:09,426 --> 00:34:12,126
不受限地进行访问


800
00:34:12,126 --> 00:34:14,896
默认情况下 在其他容器内 


801
00:34:14,896 --> 00:34:16,775
访问文件


802
00:34:17,085 --> 00:34:18,735
也就是在其他 App 容器


803
00:34:18,735 --> 00:34:20,196
和云服务容器内


804
00:34:21,466 --> 00:34:23,636
因此 这个安全功能


805
00:34:23,906 --> 00:34:25,585
可保证其他 App 和


806
00:34:25,585 --> 00:34:27,426
进程不能


807
00:34:27,426 --> 00:34:29,036
偷窥你的 App


808
00:34:29,036 --> 00:34:31,016
容器 访问你的文件


809
00:34:31,356 --> 00:34:33,166
而且要确保如果


810
00:34:33,166 --> 00:34:35,076
他们想访问 访问


811
00:34:35,076 --> 00:34:37,815
这些文稿 需要


812
00:34:37,906 --> 00:34:39,126
用户许可


813
00:34:40,636 --> 00:34:43,916
所以 既然从其他容器内


814
00:34:43,916 --> 00:34:45,656
访问文件受限


815
00:34:46,106 --> 00:34:48,065
你的 App 怎么获取


816
00:34:48,065 --> 00:34:50,485
这些你的顾客已经挑选好的文件呢


817
00:34:51,585 --> 00:34:53,666
我们必须要做的是扩展 App


818
00:34:53,666 --> 00:34:56,065
沙箱使它包含这些文稿


819
00:34:56,775 --> 00:34:59,246
再一次回到 URL 通过 


820
00:34:59,246 --> 00:35:00,266
浏览器或选取器返回


821
00:35:01,716 --> 00:35:03,896
这个 URL 有一个附加的 


822
00:35:03,896 --> 00:35:06,026
安全范围资源


823
00:35:06,326 --> 00:35:07,676
你可以认为这个资源


824
00:35:07,676 --> 00:35:11,246
是一个系统赠予你的令牌 


825
00:35:11,306 --> 00:35:13,126
获得这个令牌可以允许


826
00:35:13,126 --> 00:35:15,936
你的 App 访问此文稿


827
00:35:16,356 --> 00:35:19,446
我们可以用


828
00:35:19,446 --> 00:35:21,646
下面的 URL API 来访问文件


829
00:35:22,846 --> 00:35:23,666
当我们调用


830
00:35:23,836 --> 00:35:25,826
startAccessingSecurityScopedResource


831
00:35:25,826 --> 00:35:28,576
你的 App 就可以访问


832
00:35:28,576 --> 00:35:30,206
这个文稿 你也可以


833
00:35:30,206 --> 00:35:32,166
开始展示或者编辑此文稿


834
00:35:32,896 --> 00:35:34,386
一旦你用完


835
00:35:34,386 --> 00:35:36,796
这个文稿 你应该在 URL 上调用


836
00:35:36,796 --> 00:35:38,806
stopAccessingSecurityScopedResource


837
00:35:38,806 --> 00:35:42,856
API 正如你所见 


838
00:35:42,856 --> 00:35:45,196
该文件访问权限受限


839
00:35:47,676 --> 00:35:50,546
这有一个简单的秘诀来


840
00:35:50,546 --> 00:35:51,866
保证你和


841
00:35:51,866 --> 00:35:54,596
沙箱文稿总可以成功交互


842
00:35:55,136 --> 00:35:57,556
我们快速看一下这个例子中


843
00:35:57,626 --> 00:35:58,716
我们调用的地方


844
00:35:59,996 --> 00:36:01,586
首先 我们在 URL 上


845
00:36:01,586 --> 00:36:03,716
调用 startAccessing 


846
00:36:04,256 --> 00:36:05,706
然后我们可以开始


847
00:36:05,706 --> 00:36:06,376
和这个文稿互动


848
00:36:07,386 --> 00:36:09,036
你注意到在这个 Defer 代码块中


849
00:36:09,036 --> 00:36:10,856
一旦我们用完该文件


850
00:36:10,856 --> 00:36:12,886
我们会调用 stopAccessing


851
00:36:14,546 --> 00:36:16,576
你注意到这些调用是


852
00:36:16,576 --> 00:36:19,476
平衡的 如果 startAccessing


853
00:36:19,476 --> 00:36:21,946
返回 true 值


854
00:36:21,946 --> 00:36:25,116
我们只调用 stopAccessing 


855
00:36:25,336 --> 00:36:27,166
我们尽可能使资源


856
00:36:27,166 --> 00:36:29,426
访问时间短 因为当


857
00:36:29,426 --> 00:36:30,826
我们调用 startAccessing


858
00:36:30,826 --> 00:36:33,196
我们消耗有限的系统


859
00:36:33,196 --> 00:36:35,266
资源 为你的 App 进行保留


860
00:36:35,806 --> 00:36:37,276
所以一旦我们用完这个文稿 


861
00:36:37,276 --> 00:36:40,696
我们需要放弃这些资源来确保


862
00:36:40,696 --> 00:36:43,066
我们可以在进程中


863
00:36:43,066 --> 00:36:45,496
访问文件


864
00:36:47,376 --> 00:36:49,116
如果你确定这个


865
00:36:49,116 --> 00:36:50,906
文稿存在于你的


866
00:36:50,906 --> 00:36:52,626
App 容器中 你不需要


867
00:36:52,626 --> 00:36:53,436
调用这些


868
00:36:54,206 --> 00:36:56,376
但是如有疑问


869
00:36:56,376 --> 00:36:57,036
可以调用这些


870
00:36:57,736 --> 00:36:59,196
如果它们不被需要


871
00:36:59,366 --> 00:37:01,126
它们就是无操作指令


872
00:37:03,176 --> 00:37:05,336
很好 现在我们知道如何


873
00:37:05,336 --> 00:37:06,626
访问我们的文件


874
00:37:06,766 --> 00:37:08,816
我们可以继续选择


875
00:37:08,816 --> 00:37:10,396
文稿 像我们示例中的


876
00:37:10,396 --> 00:37:11,386
粒子图像


877
00:37:11,666 --> 00:37:14,466
开始访问


878
00:37:14,466 --> 00:37:16,316
你可以看到 云


879
00:37:16,316 --> 00:37:17,726
服务管理着这个


880
00:37:17,726 --> 00:37:19,706
文稿 其他 App 也


881
00:37:20,046 --> 00:37:21,606
可以访问这个文件


882
00:37:21,746 --> 00:37:23,716
有时候和你的 App


883
00:37:23,716 --> 00:37:24,966
同时运行


884
00:37:25,236 --> 00:37:26,746
我们在这里需要的是一个


885
00:37:26,746 --> 00:37:29,046
全系统机制来


886
00:37:29,046 --> 00:37:30,396
确保访问这个文件


887
00:37:30,396 --> 00:37:32,166
总是协调的


888
00:37:32,656 --> 00:37:34,326
这样的话各项进程之间


889
00:37:34,326 --> 00:37:35,666
不会互相干扰


890
00:37:36,076 --> 00:37:39,466
访问 读取 编写这个文稿


891
00:37:40,916 --> 00:37:43,806
在 iOS 上 这个机制叫做


892
00:37:43,986 --> 00:37:46,076
文件协调性


893
00:37:46,076 --> 00:37:48,956
通过 NSFileCoordinator 和


894
00:37:49,046 --> 00:37:50,486
NSFilePresenter API 来展现


895
00:37:51,616 --> 00:37:53,316
它充当全系统的


896
00:37:53,486 --> 00:37:55,166
多阅读器／单独写


897
00:37:55,166 --> 00:37:58,546
锁 也是


898
00:37:58,546 --> 00:38:00,506
你的 App 指导系统


899
00:38:00,586 --> 00:38:02,576
下载本地不可用文稿


900
00:38:02,576 --> 00:38:03,886
的一种方式


901
00:38:04,146 --> 00:38:05,856
因为你知道


902
00:38:05,856 --> 00:38:07,306
这些文件许多都可以放入


903
00:38:07,306 --> 00:38:09,136
云端 而不是在设备里


904
00:38:10,896 --> 00:38:12,566
所以 你可能发现自己


905
00:38:12,566 --> 00:38:14,496
写很多样板文件和


906
00:38:14,496 --> 00:38:16,056
易于出错的代码来处理


907
00:38:16,056 --> 00:38:18,756
沙箱 来处理文件协调性


908
00:38:19,846 --> 00:38:21,556
如果你只是


909
00:38:21,976 --> 00:38:23,456
对展示和编辑你的


910
00:38:23,456 --> 00:38:25,936
文件感兴趣 解决方法就更容易


911
00:38:26,176 --> 00:38:27,986
在 iOS 上 它以 UIDocument 的


912
00:38:27,986 --> 00:38:29,376
形式出现


913
00:38:30,346 --> 00:38:32,006
UIDocument 自从 iOS 5


914
00:38:32,006 --> 00:38:32,956
就开始有了


915
00:38:33,946 --> 00:38:36,016
建议使用


916
00:38:36,016 --> 00:38:38,246
当你的 App 展示和编辑文稿时


917
00:38:39,256 --> 00:38:40,946
它为你处理沙箱


918
00:38:41,256 --> 00:38:44,466
所以没必要调动 stopAccessing


919
00:38:45,336 --> 00:38:46,696
它也为你处理


920
00:38:46,696 --> 00:38:47,736
文件协调性


921
00:38:47,986 --> 00:38:49,246
所以 你不需要


922
00:38:49,286 --> 00:38:50,896
手动协调这些文件的


923
00:38:50,896 --> 00:38:51,706
访问权限


924
00:38:53,256 --> 00:38:55,646
想要获取更多关于文件


925
00:38:55,646 --> 00:38:58,186
协调和 UIDocument 的消息


926
00:38:58,186 --> 00:38:59,386
我们邀请你回去看


927
00:38:59,386 --> 00:39:02,176
2015 年的全球开发人员大会


928
00:39:02,176 --> 00:39:06,056
建立基于文稿的 App


929
00:39:06,056 --> 00:39:09,526
大会中详细包含了这些主题


930
00:39:10,036 --> 00:39:11,976
好 我们现在可以访问


931
00:39:11,976 --> 00:39:13,466
文件 我们确定


932
00:39:13,466 --> 00:39:15,586
读写处于一致状态


933
00:39:16,446 --> 00:39:18,026
我们可以编辑我们的粒子系统


934
00:39:18,316 --> 00:39:19,526
现在我们要做的是


935
00:39:19,526 --> 00:39:21,106
只用一秒钟切换 App


936
00:39:21,106 --> 00:39:22,716
查看网页上的全球开发人员大会


937
00:39:22,716 --> 00:39:25,566
再跳转到我们的 App 中


938
00:39:26,136 --> 00:39:28,526
正如你所看到的


939
00:39:28,526 --> 00:39:30,236
我们现在在编辑器中 但是我们


940
00:39:30,236 --> 00:39:31,576
回到刚刚的浏览器中


941
00:39:32,366 --> 00:39:34,016
你的顾客总是期待


942
00:39:34,016 --> 00:39:35,576
回到刚刚他们


943
00:39:35,576 --> 00:39:38,726
使用你 App 时所在的地方


944
00:39:39,076 --> 00:39:40,426
让我们尝试理解一下


945
00:39:40,426 --> 00:39:42,166
之前的示例发生了什么


946
00:39:42,976 --> 00:39:45,796
这是我们 App 的生命周期图表


947
00:39:47,196 --> 00:39:48,586
当我们编辑 App


948
00:39:48,846 --> 00:39:49,946
粒子系统时 我们被带到前台


949
00:39:49,946 --> 00:39:52,436
当我们从 App Switcher 转到 Safari 时


950
00:39:52,806 --> 00:39:57,726
我们被带到后台


951
00:39:59,096 --> 00:40:00,816
系统暂停了我们的 App


952
00:40:00,816 --> 00:40:01,906
当它在后台的时候


953
00:40:02,716 --> 00:40:04,486
事实证明在这个时候


954
00:40:04,716 --> 00:40:06,236
我们的系统遭受内存


955
00:40:06,236 --> 00:40:08,126
压力 所以系统 


956
00:40:08,586 --> 00:40:09,566
终止了我们的 App


957
00:40:10,776 --> 00:40:12,866
当我们使用 App Switcher 来


958
00:40:12,866 --> 00:40:14,866
转换到我们的 App 中 我们的 App


959
00:40:14,866 --> 00:40:15,546
开始重新启动


960
00:40:16,246 --> 00:40:18,046
我们在这并没有做成功的是


961
00:40:18,046 --> 00:40:19,176
恢复 UI 状态


962
00:40:19,726 --> 00:40:21,196
这个时间是


963
00:40:21,196 --> 00:40:22,956
恢复 UI 状态的最佳时机


964
00:40:22,956 --> 00:40:24,736
把我们的顾客带到他们原来所在的地方


965
00:40:26,206 --> 00:40:28,736
所以 我们怎样实现状态的 恢复呢


966
00:40:29,136 --> 00:40:31,266
一个简单的方法是


967
00:40:31,266 --> 00:40:32,686
存留我们从


968
00:40:32,726 --> 00:40:34,146
文稿浏览器或文稿选取器


969
00:40:34,146 --> 00:40:35,726
中获取的 URL


970
00:40:36,166 --> 00:40:37,856
然后在 App 重启时恢复它


971
00:40:39,246 --> 00:40:40,846
但这并不管用 因为


972
00:40:40,846 --> 00:40:41,586
以下两个原因


973
00:40:42,236 --> 00:40:44,856
第一 URL 指向的文稿


974
00:40:44,926 --> 00:40:47,306
很有可能已被移动或者重命名


975
00:40:47,586 --> 00:40:48,826
所以 App 重启时


976
00:40:48,826 --> 00:40:50,406
我们链接也中断了


977
00:40:51,266 --> 00:40:53,286
第二 附在我们 URL 中的


978
00:40:53,286 --> 00:40:55,436
安全范围资源


979
00:40:55,436 --> 00:40:59,166
在 URL 起作用时不可编码


980
00:40:59,866 --> 00:41:01,446
所以 我们重启我们的


981
00:41:01,446 --> 00:41:03,886
App 我们不能访问


982
00:41:03,886 --> 00:41:05,986
该文稿 即使这个


983
00:41:05,986 --> 00:41:07,646
文件没有移动也没有改名


984
00:41:08,076 --> 00:41:12,026
正确的解决方式是使用一个


985
00:41:12,026 --> 00:41:13,886
安全范围书签


986
00:41:13,886 --> 00:41:15,176
我们可以从 URL 中获取


987
00:41:15,556 --> 00:41:17,376
正如你所看到的 这个


988
00:41:17,376 --> 00:41:18,886
书签可以正确地查阅


989
00:41:18,886 --> 00:41:20,906
文稿 即使它


990
00:41:20,906 --> 00:41:21,966
被移动或重命名


991
00:41:27,316 --> 00:41:29,206
为了保持这个安全范围


992
00:41:29,206 --> 00:41:31,326
书签  我们必须首先


993
00:41:31,326 --> 00:41:33,166
从 URL 中获取


994
00:41:33,166 --> 00:41:35,356
在 URL 上使用 bookmarkData API


995
00:41:35,676 --> 00:41:37,566
让它在磁盘继续存在


996
00:41:38,636 --> 00:41:40,596
一旦重启我们的 App 我们


997
00:41:40,596 --> 00:41:42,386
可以还原原来的 URL 


998
00:41:42,736 --> 00:41:47,546
调用 URL 产生的 bookmarkData


999
00:41:47,746 --> 00:41:49,636
好的 既然我们做好了 


1000
00:41:49,636 --> 00:41:51,036
所有准备来保存和


1001
00:41:51,036 --> 00:41:53,076
还原 UI 状态 让我们快速跳转到


1002
00:41:53,076 --> 00:41:53,926
一个示例中看看工作中的它


1003
00:42:02,046 --> 00:42:04,296
所以 我们来到了


1004
00:42:04,366 --> 00:42:07,266
模拟器中 运行 Particle App     


1005
00:42:07,266 --> 00:42:08,736
就像之前看到的那样


1006
00:42:10,286 --> 00:42:11,556
我们接下来要做的是


1007
00:42:11,556 --> 00:42:13,056
带着我们的 App 来到后台


1008
00:42:13,546 --> 00:42:14,606
现在 我们将要


1009
00:42:14,606 --> 00:42:15,966
模拟一个现实


1010
00:42:15,966 --> 00:42:17,596
系统正在关闭我们的 App 


1011
00:42:17,636 --> 00:42:18,976
在 Xcode 中关闭它


1012
00:42:23,056 --> 00:42:25,596
如果我们重启我们的 App 我们


1013
00:42:25,596 --> 00:42:27,336
看到我们跳到了浏览器中


1014
00:42:28,086 --> 00:42:29,276
所以 现在我们将要做的


1015
00:42:29,276 --> 00:42:31,646
是完成状态的保存


1016
00:42:31,686 --> 00:42:33,336
和还原 来回到


1017
00:42:33,336 --> 00:42:34,456
我们原来所在的地方


1018
00:42:35,776 --> 00:42:37,536
所以 我将移动到 Xcode 中


1019
00:42:38,086 --> 00:42:39,716
首先 在我们的 App


1020
00:42:39,716 --> 00:42:41,096
委托中 我们要向我们的


1021
00:42:41,096 --> 00:42:42,546
App 声明我们对


1022
00:42:42,546 --> 00:42:44,706
状态保存和恢复感兴趣


1023
00:42:45,206 --> 00:42:48,936
为了做到上述这些首先


1024
00:42:48,936 --> 00:42:49,946
在 App shouldSaveApplicationState 中 


1025
00:42:49,946 --> 00:42:51,746
返回一个真值 也在


1026
00:42:52,466 --> 00:42:54,306
App shouldRestoreApplicationState 中    


1027
00:42:54,306 --> 00:42:55,896
返回真值          


1028
00:42:57,716 --> 00:42:59,536
第二点 我们要到我们的


1029
00:42:59,536 --> 00:43:01,406
Storyboard 中 给我们的


1030
00:43:01,406 --> 00:43:02,886
DocumentBrowserViewController


1031
00:43:02,886 --> 00:43:05,296
子类一个恢复身份


1032
00:43:05,296 --> 00:43:08,926
以便系统可以恢复它


1033
00:43:09,846 --> 00:43:11,366
在这个例子中 我们将


1034
00:43:11,366 --> 00:43:16,306
只使用 Storyboard ID


1035
00:43:16,566 --> 00:43:18,326
接下来 我们将要完成


1036
00:43:18,376 --> 00:43:19,716
状态的保存和


1037
00:43:19,716 --> 00:43:21,256
还原 在这个


1038
00:43:21,256 --> 00:43:22,726
documentBrowserViewController


1039
00:43:22,726 --> 00:43:23,316
子类别中


1040
00:43:25,996 --> 00:43:28,846
首先 我通过完成


1041
00:43:28,846 --> 00:43:30,166
encodeRestorableState 来开始


1042
00:43:31,436 --> 00:43:35,036
我们来到这个 editorViewController


1043
00:43:35,086 --> 00:43:36,856
如果它存在 从它当中


1044
00:43:36,856 --> 00:43:39,366
获取文稿 URL       


1045
00:43:39,736 --> 00:43:40,716
一旦我们有了 URL       


1046
00:43:40,716 --> 00:43:42,856
我把这个弄大一点   


1047
00:43:43,376 --> 00:43:45,976
一旦我们有了这个URL 我们开始


1048
00:43:45,976 --> 00:43:47,276
访问它来扩展我们的


1049
00:43:47,276 --> 00:43:49,176
沙箱 像之前描述的那样


1050
00:43:50,626 --> 00:43:52,596
在这个 Defer 代码块中 我们停止 


1051
00:43:52,596 --> 00:43:58,886
访问 一旦我们结束使用


1052
00:43:59,836 --> 00:44:01,606
如果我们可以访问这个


1053
00:44:01,606 --> 00:44:04,826
文稿 我们从这个文稿中


1054
00:44:04,826 --> 00:44:06,666
简单创立一个 bookmarkData 代码块   


1055
00:44:06,666 --> 00:44:08,076
然后进行编码


1056
00:44:08,576 --> 00:44:12,556
最后 我们不要忘记调用 Super


1057
00:44:13,816 --> 00:44:16,116
好啦 既然我们知道了怎样


1058
00:44:16,116 --> 00:44:17,506
对我们的恢复状态进行编码


1059
00:44:17,846 --> 00:44:20,486
我们将进行恢复状态的解码


1060
00:44:21,146 --> 00:44:23,916
为此 我们开始执行


1061
00:44:23,916 --> 00:44:25,126
decodeRestorableState


1062
00:44:25,686 --> 00:44:27,266
我们将反着来


1063
00:44:28,036 --> 00:44:29,506
所以 首先我们从编码器中    


1064
00:44:29,506 --> 00:44:30,896
获取 bookmarkData      


1065
00:44:31,526 --> 00:44:34,396
如果它存在 建立       


1066
00:44:34,396 --> 00:44:36,166
文件 URL 调用


1067
00:44:36,166 --> 00:44:38,346
resolvingBookmarkData        


1068
00:44:38,886 --> 00:44:42,556
我们在 URL 中       


1069
00:44:42,556 --> 00:44:45,506
展示这个文件       


1070
00:44:45,506 --> 00:44:47,956
最后 我们    


1071
00:44:47,956 --> 00:44:49,106
不要忘记调用 Super     


1072
00:44:50,496 --> 00:44:51,916
好的 所以 让我们运行我们的 App 吧  


1073
00:44:57,646 --> 00:44:59,156
我们的 App 将要     


1074
00:44:59,156 --> 00:45:00,686
在模拟器中启动     


1075
00:45:02,116 --> 00:45:03,916
正如你所见 我们可以开始   


1076
00:45:04,786 --> 00:45:05,726
使用我们的文稿了  


1077
00:45:06,616 --> 00:45:09,556
再一次 把我们的 App 放到后台去   


1078
00:45:09,886 --> 00:45:11,886
模仿系统关闭我们的 App     


1079
00:45:16,156 --> 00:45:18,186
接下来我们要重启我们的  


1080
00:45:18,886 --> 00:45:19,926
App 正如你在这所见  


1081
00:45:20,246 --> 00:45:20,976
我们回到了编辑器中   


1082
00:45:21,516 --> 00:45:28,546
［ 掌声 ］


1083
00:45:29,046 --> 00:45:31,046
了不起 我们现在可以访问 


1084
00:45:31,046 --> 00:45:32,936
文稿 读写文稿  


1085
00:45:32,936 --> 00:45:34,306
不必害怕数据


1086
00:45:34,306 --> 00:45:36,336
损毁 我们甚至可以


1087
00:45:36,336 --> 00:45:37,776
恢复状态 把我们的


1088
00:45:37,776 --> 00:45:39,406
顾客带到他们一开始所在的地方


1089
00:45:39,716 --> 00:45:40,886
当他们在用我们的 App 时所在的地方


1090
00:45:41,386 --> 00:45:44,946
即使我们的 App 在后台被关闭


1091
00:45:45,286 --> 00:45:47,246
所以 如果你打开文件


1092
00:45:47,706 --> 00:45:48,936
我们在弹出菜单中  


1093
00:45:48,936 --> 00:45:50,956
点击分享 在你的 App   


1094
00:45:50,956 --> 00:45:52,976
可以处理的文件中 你会注意到   


1095
00:45:52,976 --> 00:45:55,136
我们的 App 现在在分享表单中可以获得


1096
00:45:56,096 --> 00:45:58,726
然而 它显示复制


1097
00:45:58,906 --> 00:45:59,926
而不是打开


1098
00:46:00,856 --> 00:46:03,106
这就意味着一旦我们  


1099
00:46:03,106 --> 00:46:04,726
在分享表单轻点我们的 App 图标  


1100
00:46:04,726 --> 00:46:06,456
系统就会  


1101
00:46:06,456 --> 00:46:09,096
复制这个文稿 复制到  


1102
00:46:09,096 --> 00:46:10,986
我们的 App 中  


1103
00:46:10,986 --> 00:46:12,596
这意味着 


1104
00:46:12,596 --> 00:46:14,326
客户将开始编辑


1105
00:46:14,326 --> 00:46:15,616
这个文稿的副本


1106
00:46:17,096 --> 00:46:19,056
为了让你的客户打开  


1107
00:46:19,056 --> 00:46:20,816
和编辑原来的文件 


1108
00:46:21,756 --> 00:46:23,696
我们希望在你的 App 中访问  


1109
00:46:23,696 --> 00:46:26,206
的文稿 你需要使用 


1110
00:46:26,206 --> 00:46:28,106
就地打开的功能   


1111
00:46:28,636 --> 00:46:32,066
如果你使用就地打开


1112
00:46:32,456 --> 00:46:34,276
你将在你的 App 分享表单里   


1113
00:46:34,536 --> 00:46:35,856
看到打开而不是  


1114
00:46:35,856 --> 00:46:38,576
在之前的复制


1115
00:46:38,826 --> 00:46:41,076
使用就地打开很简单  


1116
00:46:41,816 --> 00:46:43,676
如果你使用基于文稿的


1117
00:46:43,676 --> 00:46:45,586
App Xcode 模板 你将


1118
00:46:45,586 --> 00:46:47,656
可以免费获得 仿佛   


1119
00:46:47,656 --> 00:46:49,856
就地打开这是默认的   


1120
00:46:50,876 --> 00:46:52,966
否则  你需要添加这个 


1121
00:46:52,966 --> 00:46:55,026
LSSupportsOpeningDocumentInPlace


1122
00:46:55,026 --> 00:46:57,756
到你的 info.plist 中


1123
00:46:57,756 --> 00:46:58,806
一旦你向系统声明 


1124
00:46:58,806 --> 00:47:00,956
你的 App 在处理  


1125
00:47:00,956 --> 00:47:03,056
就地打开 我们必须


1126
00:47:03,056 --> 00:47:05,076
使用下面的 UI App 委托方法


1127
00:47:05,076 --> 00:47:06,356
来访问文件


1128
00:47:08,076 --> 00:47:09,876
再一次 如果你的 App 是


1129
00:47:09,876 --> 00:47:12,996
基于文稿浏览器 通常是用这种


1130
00:47:12,996 --> 00:47:14,646
方法 你要在            


1131
00:47:14,646 --> 00:47:16,646
documentBrowserViewController 中  


1132
00:47:16,646 --> 00:47:18,166
调用 revealDocument    


1133
00:47:19,376 --> 00:47:21,016
一旦你用这个方法


1134
00:47:21,016 --> 00:47:22,596
调用完成处理程序


1135
00:47:22,596 --> 00:47:23,686
你将在完成处理程序中


1136
00:47:23,686 --> 00:47:24,476
展示该文件


1137
00:47:25,126 --> 00:47:26,926
在 Xcode 模板中  


1138
00:47:26,926 --> 00:47:27,676
早已为你完成


1139
00:47:28,016 --> 00:47:31,246
我们可以在分享表单中 


1140
00:47:31,466 --> 00:47:32,806
轻点 App 图标   


1141
00:47:32,806 --> 00:47:34,506
直接进入我们的 App    


1142
00:47:34,506 --> 00:47:36,176
正如你在这所见的 我们在  


1143
00:47:36,246 --> 00:47:38,266
UI 中报告进度 因为这个  


1144
00:47:38,266 --> 00:47:41,116
文稿可以放到云端中   


1145
00:47:41,276 --> 00:47:42,866
既然下载需要


1146
00:47:42,866 --> 00:47:44,926
一会儿 我们也支持


1147
00:47:44,926 --> 00:47:46,626
用户取消 所以我们可以 


1148
00:47:46,666 --> 00:47:48,096
取消打开这个文稿


1149
00:47:48,096 --> 00:47:51,116
然后跳回到浏览器中 


1150
00:47:51,596 --> 00:47:52,946
这是你如何在你的 App 中


1151
00:47:52,996 --> 00:47:56,186
实现进度支持


1152
00:47:56,456 --> 00:47:57,216
如果你调用


1153
00:47:57,216 --> 00:47:58,666
documentBrowserViewController


1154
00:47:58,666 --> 00:48:00,896
revealDocument API 而这是之前已经   


1155
00:48:00,896 --> 00:48:02,736
描述过的 你可以  


1156
00:48:02,736 --> 00:48:03,886
免费得到那个 UI  


1157
00:48:04,216 --> 00:48:06,436
所以 你将在浏览器图标 


1158
00:48:06,526 --> 00:48:08,426
的顶部看到一个载入的 UI 


1159
00:48:09,556 --> 00:48:11,646
否则 你可能选择  


1160
00:48:11,646 --> 00:48:13,366
展示你自己的进程 UI  


1161
00:48:14,336 --> 00:48:16,376
如果你的 App 使用 UIDocument 你  


1162
00:48:16,376 --> 00:48:17,906
应该知道 UIDocument    


1163
00:48:18,256 --> 00:48:20,116
遵循 progressReporting


1164
00:48:20,876 --> 00:48:22,506
这样 展示你自己的


1165
00:48:22,506 --> 00:48:24,796
进度 UI 你可以简单设置


1166
00:48:24,796 --> 00:48:26,786
访问进程属性来展示


1167
00:48:26,786 --> 00:48:30,326
你自己的进度


1168
00:48:30,706 --> 00:48:32,306
好的 我们的 App 很了不起 


1169
00:48:32,416 --> 00:48:36,566
我们也已经准备好了


1170
00:48:36,846 --> 00:48:38,946
所以 今天带走什么


1171
00:48:38,946 --> 00:48:41,126
会使你的 App 在


1172
00:48:41,126 --> 00:48:43,466
管理 iOS 文稿时更出色


1173
00:48:45,036 --> 00:48:47,636
在展示和编辑文稿时


1174
00:48:47,636 --> 00:48:49,396
使用 UIDocument 因为它


1175
00:48:49,536 --> 00:48:51,396
消除很多样板文件


1176
00:48:51,396 --> 00:48:52,436
和易于出错的代码


1177
00:48:54,786 --> 00:48:56,276
然而 如果你早已


1178
00:48:56,346 --> 00:48:57,586
使用文件编码


1179
00:48:57,586 --> 00:48:59,866
不使用 UIDocument  


1180
00:48:59,866 --> 00:49:01,436
而是使用 start- 和 stopAccessing


1181
00:49:01,436 --> 00:49:03,696
是最好的做法来确保


1182
00:49:03,696 --> 00:49:05,036
你和沙箱文稿


1183
00:49:05,036 --> 00:49:07,726
或者沙箱 App 的沙箱技术 


1184
00:49:08,356 --> 00:49:09,576
成功交互 


1185
00:49:11,096 --> 00:49:13,456
也要协调好各种


1186
00:49:13,456 --> 00:49:15,346
文稿的访问来确保


1187
00:49:15,346 --> 00:49:19,656
你可以持续地读写它们


1188
00:49:19,826 --> 00:49:21,476
实现状态恢复可以


1189
00:49:21,476 --> 00:49:22,986
把你的顾客带到


1190
00:49:22,986 --> 00:49:24,396
他们使用你的


1191
00:49:24,396 --> 00:49:26,186
App 时所在的位置 即使


1192
00:49:26,186 --> 00:49:29,086
你的 App 在后台被关闭了


1193
00:49:29,086 --> 00:49:31,166
使用就地打开以便


1194
00:49:31,306 --> 00:49:32,876
你的顾客总是编辑


1195
00:49:32,876 --> 00:49:34,926
原始文件 而


1196
00:49:34,926 --> 00:49:37,366
不需要开始复制


1197
00:49:37,366 --> 00:49:40,346
这个文件报告进程  


1198
00:49:40,466 --> 00:49:43,356
特别是当大多数文稿在云端


1199
00:49:43,356 --> 00:49:45,116
而在本地不可用时


1200
00:49:46,816 --> 00:49:49,136
所以 我们今天都涉及了什么


1201
00:49:49,936 --> 00:49:51,996
我们向你展示了使用


1202
00:49:52,116 --> 00:49:53,866
文稿浏览器和


1203
00:49:53,866 --> 00:49:55,116
文稿选取器 API 是多么简单


1204
00:49:55,686 --> 00:49:58,836
今天在你的 App 中试一下吧


1205
00:49:59,016 --> 00:50:02,026
我们学到了一些最佳做法


1206
00:50:02,166 --> 00:50:03,486
以便我们的 App 在 


1207
00:50:03,486 --> 00:50:05,266
管理文稿方面表现卓越  


1208
00:50:06,326 --> 00:50:09,296
对你们云服务供应商来说


1209
00:50:09,296 --> 00:50:10,406
我们讨论了新的 Siri 的


1210
00:50:10,406 --> 00:50:12,456
捷径 以及他们怎样允许


1211
00:50:12,456 --> 00:50:15,276
你的 App 对不起 你的文稿


1212
00:50:15,686 --> 00:50:17,866
通过系统可以


1213
00:50:17,866 --> 00:50:20,296
频繁地被顾客访问


1214
00:50:20,816 --> 00:50:23,486
我们谈论了


1215
00:50:23,486 --> 00:50:25,206
fileProvider 验证工具  


1216
00:50:26,466 --> 00:50:28,296
并且关于怎样   


1217
00:50:28,296 --> 00:50:29,616
在你的 fileProviderUI 扩展中实现 


1218
00:50:29,616 --> 00:50:31,016
有效的身份验证给出  


1219
00:50:31,016 --> 00:50:32,736
指导意见  


1220
00:50:34,126 --> 00:50:36,056
更多关于这个会议的


1221
00:50:36,056 --> 00:50:39,356
消息 请查看在下面 URL 中的会议网站


1222
00:50:40,016 --> 00:50:41,606
确保查看今年的 


1223
00:50:41,606 --> 00:50:43,826
介绍 Siri 捷径会议


1224
00:50:44,386 --> 00:50:45,606
谢谢大家的到来


1225
00:50:45,946 --> 00:50:47,976
下午愉快 实验室见啦 谢谢


1226
00:50:48,516 --> 00:50:51,500
［ 掌声 ］

