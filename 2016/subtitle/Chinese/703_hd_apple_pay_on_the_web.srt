1
00:00:19,486 --> 00:00:25,025
<c.magenta>在网页中使用Apple Pay</c>


2
00:00:28,695 --> 00:00:29,897
<c.magenta>大家好</c>


3
00:00:30,764 --> 00:00:33,600
<c.magenta>欢迎回来</c>
<c.magenta>参加去年Apple Pay会议的人</c>


4
00:00:34,034 --> 00:00:34,868
<c.magenta>我是Nick</c>


5
00:00:35,435 --> 00:00:37,738
<c.magenta>今天我与同事Anders会在这里</c>


6
00:00:38,138 --> 00:00:40,974
<c.magenta>我们将会讲述一个新的特性</c>


7
00:00:41,341 --> 00:00:43,510
<c.magenta>在网页中使用Apple Pay</c>


8
00:00:44,545 --> 00:00:47,214
<c.magenta>首先 我想先问大家一个问题</c>


9
00:00:48,382 --> 00:00:51,852
<c.magenta>你们当中有多少人</c>
<c.magenta>举起你们的手或者对着屏幕喊出来</c>


10
00:00:51,919 --> 00:00:54,054
<c.magenta>如果你在楼下或者在线观看的话</c>


11
00:00:54,121 --> 00:00:56,623
<c.magenta>你们当中有多少人尝试过网上购物</c>


12
00:00:57,057 --> 00:00:59,993
<c.magenta>但是发现过程太复杂</c>
<c.magenta>然后放弃了购物</c>


13
00:01:01,461 --> 00:01:02,596
<c.magenta>我看到了很多人举手了</c>


14
00:01:03,297 --> 00:01:05,199
<c.magenta>毫无疑问 这是一个大问题</c>


15
00:01:05,331 --> 00:01:09,102
<c.magenta>这是我昨天访问的一个网站</c>
<c.magenta>非常的传统</c>


16
00:01:10,003 --> 00:01:12,139
<c.magenta>无视这名字Honest Bob</c>
<c.magenta>他是一个很棒的家伙</c>


17
00:01:13,073 --> 00:01:15,075
<c.magenta>但他在结账的时候遇到了一些困扰</c>


18
00:01:15,776 --> 00:01:18,745 line:1
<c.magenta>为了举例</c>
<c.magenta>我将我的名字改变一下</c>


19
00:01:18,812 --> 00:01:21,014 line:1
<c.magenta>改成了Johnny Appleseed</c>
<c.magenta>避免重名</c>


20
00:01:21,315 --> 00:01:22,716 line:1
<c.magenta>然后我开始输入卡号</c>


21
00:01:22,816 --> 00:01:24,251 line:1
<c.magenta>获得了令人迷惑的错误信息</c>


22
00:01:24,985 --> 00:01:27,654 line:1
<c.magenta>提示说卡号必须是一连串的数字</c>


23
00:01:28,522 --> 00:01:31,758 line:1
<c.magenta>这样我就会心里想</c>
<c.magenta>我觉得没有空格是错误的</c>


24
00:01:31,825 --> 00:01:34,161 line:1
<c.magenta>并且我的卡上就是有空格的</c>


25
00:01:34,494 --> 00:01:35,696 line:1
<c.magenta>于是我做了修改</c>


26
00:01:36,530 --> 00:01:39,666 line:1
<c.magenta>然后我又得到了一个错误信息</c>
<c.magenta>比较明显 月份不符合</c>


27
00:01:39,733 --> 00:01:42,336 line:1
<c.magenta>而不是提示我</c>
<c.magenta>没有选择月份</c>


28
00:01:42,903 --> 00:01:44,771 line:1
<c.magenta>这样很令人困扰</c>


29
00:01:45,372 --> 00:01:48,542 line:1
<c.magenta>希望大家不会遇到像这样糟糕的场景</c>


30
00:01:49,109 --> 00:01:52,012 line:1
<c.magenta>但是因特网支付</c>
<c.magenta>真的还非常的落后</c>


31
00:01:52,713 --> 00:01:54,081 line:1
<c.magenta>且我们希望能解决这种问题</c>


32
00:01:54,481 --> 00:01:56,750
<c.magenta>认为可通过</c>
<c.magenta>Apple Pay解决这种问题</c>


33
00:01:58,085 --> 00:01:59,486
<c.magenta>并且我们今天将会讲述</c>


34
00:01:59,653 --> 00:02:01,955
<c.magenta>如何解决这些问题</c>


35
00:02:02,089 --> 00:02:05,392
<c.magenta>可以通过在网页中使用良好的接口</c>


36
00:02:05,592 --> 00:02:07,261
<c.magenta>及Apple Pay带来的好处</c>


37
00:02:07,928 --> 00:02:11,231
<c.magenta>我们将会讲到很多内容</c>
<c.magenta>让我们首先开始做一个介绍</c>


38
00:02:11,298 --> 00:02:14,001
<c.magenta>我们将会通过一些事例</c>
<c.magenta>来讲述Apple Pay</c>


39
00:02:14,067 --> 00:02:16,937
<c.magenta>你们可能还不熟悉它</c>
<c.magenta>还不了解它能做什么</c>


40
00:02:17,671 --> 00:02:19,406
<c.magenta>然后我们会讲述一些具体的API</c>


41
00:02:19,473 --> 00:02:22,843
<c.magenta>我们将这些新JavaScript</c>
<c.magenta>API添加进了Safari</c>


42
00:02:23,810 --> 00:02:27,281
<c.magenta>然后我们会讲述支付处理的过程</c>
<c.magenta>以及如何获得付款</c>


43
00:02:28,582 --> 00:02:30,517
<c.magenta>最后是关于Apple Pay的设计</c>


44
00:02:30,584 --> 00:02:34,021
<c.magenta>如何让你的网站变的出众而且实用</c>


45
00:02:34,321 --> 00:02:36,356
<c.magenta>及拥有比较好的</c>
<c.magenta>Apple Pay体验</c>


46
00:02:37,658 --> 00:02:38,692
<c.magenta>所以 让我们开始吧</c>


47
00:02:40,194 --> 00:02:41,428
<c.magenta>Apple Pay是什么？</c>


48
00:02:42,429 --> 00:02:44,932
<c.magenta>希望你们大多数人</c>
<c.magenta>都比较熟悉Apple Pay</c>


49
00:02:45,399 --> 00:02:49,303
<c.magenta>它是一种简单安全以及私密的支付方式</c>


50
00:02:50,404 --> 00:02:54,141
<c.magenta>你可以在商店中使用</c>


51
00:02:54,208 --> 00:02:56,176
<c.magenta>也可以在iOS应用中使用</c>


52
00:02:57,477 --> 00:02:59,847
<c.magenta>也许你们已试过了</c>
<c.magenta>若没有 请放心的去尝试一下</c>


53
00:02:59,913 --> 00:03:02,783
<c.magenta>有很多非常好的应用</c>
<c.magenta>比如Lyft Uber DoorDash</c>


54
00:03:02,850 --> 00:03:05,152
<c.magenta>即便在参加会议 你也可以使用它们</c>


55
00:03:06,386 --> 00:03:09,356
<c.magenta>且应用中的Apple Pay提供了</c>


56
00:03:09,423 --> 00:03:10,924
<c.magenta>一流的商业体验</c>


57
00:03:11,391 --> 00:03:13,126
<c.magenta>这些应用真的非常突出</c>


58
00:03:14,394 --> 00:03:19,066
<c.magenta>现在已经有非常多的应用</c>
<c.magenta>采用了Apple Pay</c>


59
00:03:19,533 --> 00:03:24,071
<c.magenta>它们在世界范围内得到了使用</c>
<c.magenta>在中国 英国以及美国</c>


60
00:03:25,038 --> 00:03:28,041
<c.magenta>这些应用有着良好的发展</c>


61
00:03:28,175 --> 00:03:31,278
<c.magenta>它们看上去有着更高的转化率</c>


62
00:03:31,612 --> 00:03:32,946
<c.magenta>那些使用Apple Pay的用户</c>


63
00:03:33,013 --> 00:03:35,382
<c.magenta>有着更高的消费倾向</c>


64
00:03:36,216 --> 00:03:38,585
<c.magenta>并且再次消费的概率也更高</c>


65
00:03:39,186 --> 00:03:42,356
<c.magenta>在消费之外 他们也会花费更多的时间</c>


66
00:03:42,422 --> 00:03:43,590
<c.magenta>在这些应用上</c>


67
00:03:44,591 --> 00:03:46,260
<c.magenta>最后 这些用户会感到更加快乐</c>


68
00:03:47,094 --> 00:03:50,163
<c.magenta>Apple Pay用户满意度最高的</c>


69
00:03:50,364 --> 00:03:51,932
<c.magenta>支付手段之一</c>


70
00:03:52,833 --> 00:03:54,968
<c.magenta>它非常好用</c>
<c.magenta>所以用户喜欢它</c>


71
00:03:56,503 --> 00:04:00,908
<c.magenta>Apple Pay在应用中表现优秀</c>
<c.magenta>但我觉得应该需要注意的是</c>


72
00:04:02,442 --> 00:04:04,211
<c.magenta>大量的电子商务</c>


73
00:04:04,478 --> 00:04:07,414
<c.magenta>没有发生在应用当中</c>


74
00:04:08,248 --> 00:04:09,950
<c.magenta>应用是很好的</c>
<c.magenta>我喜欢各种应用</c>


75
00:04:10,217 --> 00:04:13,353
<c.magenta>但是部分人仍然会在网页上进行支付</c>


76
00:04:14,454 --> 00:04:17,291
<c.magenta>绝大部分情况下 在网页上进行的支付</c>
<c.magenta>是非常缓慢的</c>


77
00:04:17,357 --> 00:04:18,992
<c.magenta>是很繁琐的</c>
<c.magenta>并且也不透明</c>


78
00:04:19,059 --> 00:04:21,827
<c.magenta>每一个商户的付款流程都不一样</c>


79
00:04:21,894 --> 00:04:23,664
<c.magenta>同样 每个网站付款流程也不一样</c>


80
00:04:25,232 --> 00:04:27,067
<c.magenta>现在我们正在尝试解决这个问题</c>


81
00:04:27,134 --> 00:04:32,039
<c.magenta>我们正通过向更多的场景以及更多的人</c>
<c.magenta>引入Apple Pay来解决这问题</c>


82
00:04:33,607 --> 00:04:35,576
<c.magenta>我们称之为</c>
<c.magenta>Apple Pay Everywhere</c>


83
00:04:35,943 --> 00:04:38,478
<c.magenta>我们现在主要在三个地方</c>
<c.magenta>引入Apple Pay</c>


84
00:04:39,479 --> 00:04:40,714
<c.magenta>第一是WatchKit</c>


85
00:04:40,881 --> 00:04:42,983
<c.magenta>你可能在昨天的主题中已经见过了</c>


86
00:04:43,050 --> 00:04:46,053
<c.magenta>且Kevin已提到过把Apple Pay</c>
<c.magenta>引入到WatchKit的应用中</c>


87
00:04:46,520 --> 00:04:49,623
<c.magenta>当然我们也会在所有的新扩展中</c>
<c.magenta>引入Apple Pay</c>


88
00:04:49,690 --> 00:04:53,227
<c.magenta>就像你看过的那些：</c>
<c.magenta>SiriKit地图以及信息</c>


89
00:04:54,061 --> 00:04:58,198
<c.magenta>但最大的场景</c>
<c.magenta>也就是你们今天来这的理由</c>


90
00:04:58,265 --> 00:05:00,767
<c.magenta>是网络和Safari</c>


91
00:05:02,102 --> 00:05:04,638
<c.magenta>我们稍后会讨论</c>
<c.magenta>WatchKit以及扩展</c>


92
00:05:04,705 --> 00:05:06,139
<c.magenta>那将是下个会议的主题</c>


93
00:05:06,273 --> 00:05:08,675
<c.magenta>若你喜欢我的嗓音</c>
<c.magenta>待会继续留在这里就好了</c>


94
00:05:09,276 --> 00:05:11,912
<c.magenta>现在让我们关于Safari</c>


95
00:05:12,713 --> 00:05:15,282
<c.magenta>让我们关注在网页上</c>
<c.magenta>使用Apple Pay</c>


96
00:05:16,850 --> 00:05:20,888
<c.magenta>前面我已经谈论了</c>
<c.magenta>当今的电子商务有多么糟糕</c>


97
00:05:22,422 --> 00:05:24,391
<c.magenta>然而非常多的商品都是通过网页销售的</c>


98
00:05:24,858 --> 00:05:27,828
<c.magenta>但是支付流程却很冗长</c>
<c.magenta>它们太复杂了</c>


99
00:05:27,928 --> 00:05:29,129
<c.magenta>以致于很难使用</c>


100
00:05:29,196 --> 00:05:31,598
<c.magenta>手机上这个问题更严重</c>


101
00:05:32,232 --> 00:05:35,536
<c.magenta>因为屏幕更小</c>
<c.magenta>但是繁琐的流程并没有减少</c>


102
00:05:36,937 --> 00:05:40,007
<c.magenta>用户会希望在网页上</c>
<c.magenta>有着与应用一样的体验</c>


103
00:05:40,107 --> 00:05:41,341
<c.magenta>使用起来非常简便</c>


104
00:05:41,408 --> 00:05:43,477
<c.magenta>并且在安全与隐私方面也没有区别</c>


105
00:05:43,577 --> 00:05:46,013
<c.magenta>有多少人不得不去办理一张新的卡片</c>


106
00:05:46,079 --> 00:05:48,549
<c.magenta>因为一封邮件告诉你</c>
<c.magenta>你曾经在上面买过东西的网站</c>


107
00:05:48,615 --> 00:05:50,384
<c.magenta>早在三年前就已经被黑掉了</c>


108
00:05:50,651 --> 00:05:51,718
<c.magenta>我就有过这种经历</c>


109
00:05:52,653 --> 00:05:54,888
<c.magenta>然而Apple Pay</c>
<c.magenta>可避免这种事情发生</c>


110
00:05:55,756 --> 00:05:57,758
<c.magenta>且通过网页上使用</c>
<c.magenta>Apple Pay功能</c>


111
00:05:57,824 --> 00:06:00,093
<c.magenta>已可支持任何</c>
<c.magenta>带Apple Pay的设备</c>


112
00:06:01,028 --> 00:06:03,197
<c.magenta>也就是iPhone与iPad</c>


113
00:06:03,864 --> 00:06:08,869
<c.magenta>并可通过Safari或者</c>
<c.magenta>SafariViewController来使用它</c>


114
00:06:09,036 --> 00:06:13,073
<c.magenta>它与现有的Apple Pay体验</c>
<c.magenta>是一样的只不过形式是通过网页而已</c>


115
00:06:13,273 --> 00:06:16,109
<c.magenta>同样的UI界面</c>
<c.magenta>同样的使用方式</c>


116
00:06:16,376 --> 00:06:18,312
<c.magenta>若你熟悉应用中的Apple Pay</c>


117
00:06:18,378 --> 00:06:19,513
<c.magenta>你会感觉有熟悉的感觉</c>


118
00:06:21,715 --> 00:06:23,317
<c.magenta>但是需要注意的是</c>


119
00:06:24,251 --> 00:06:26,086
<c.magenta>这些设备并没有包括台式机</c>


120
00:06:27,221 --> 00:06:29,957
<c.magenta>现在在一些国家 比如中国</c>
<c.magenta>手机电子商务</c>


121
00:06:30,023 --> 00:06:31,425
<c.magenta>已是主流的电子商务方式了</c>


122
00:06:31,491 --> 00:06:34,761
<c.magenta>但是在美国</c>
<c.magenta>大部分人还是习惯于</c>


123
00:06:34,828 --> 00:06:36,163
<c.magenta>通过台式电脑来买东西</c>


124
00:06:36,230 --> 00:06:39,533
<c.magenta>你可能是通过Mac电脑</c>
<c.magenta>购买了 WWDC 门票</c>


125
00:06:40,501 --> 00:06:43,537
<c.magenta>我们认为Apple Pay</c>
<c.magenta>应该可以在任何地方使用</c>


126
00:06:45,506 --> 00:06:49,142
<c.magenta>我们在Mac OS Sierra</c>
<c.magenta>中引入Apple Pay</c>


127
00:06:50,310 --> 00:06:53,046
<c.magenta>你们可在Mac电脑上</c>
<c.magenta>通过Apple Pay支付了</c>


128
00:06:53,347 --> 00:06:55,849
<c.magenta>并且具有同样的安全性</c>


129
00:06:56,216 --> 00:06:59,052
<c.magenta>与在你的iPhone或者Apple Watch</c>
<c.magenta>使用Apple Pay的情况相比话</c>


130
00:06:59,319 --> 00:07:02,823
<c.magenta>你可以简单的触摸一下</c>
<c.magenta>就可以进行授权了</c>


131
00:07:03,524 --> 00:07:06,460
<c.magenta>这样用起来非常的简单与直接</c>


132
00:07:06,727 --> 00:07:09,463
<c.magenta>它支持在任何使用Handoff</c>
<c.magenta>的Mac上使用</c>


133
00:07:09,696 --> 00:07:10,964
<c.magenta>并且操作系统需要是</c>
<c.magenta>Mac OS Sierra</c>


134
00:07:11,198 --> 00:07:14,601
<c.magenta>这对于四年内销售的</c>
<c.magenta>Mac电脑都不是问题</c>


135
00:07:15,302 --> 00:07:16,937
<c.magenta>Safari浏览器是</c>
<c.magenta>完全支持Apple Pay的</c>


136
00:07:17,738 --> 00:07:20,107
<c.magenta>你可以在手机上通过授权来进行支付</c>


137
00:07:20,374 --> 00:07:21,808
<c.magenta>在Apple Watch也是一样</c>


138
00:07:22,342 --> 00:07:26,346
<c.magenta>因为Mac OS上</c>
<c.magenta>使用Apple Pay是非常快速的</c>


139
00:07:26,547 --> 00:07:29,183
<c.magenta>可能有人之前没有看过我们昨天的演示</c>


140
00:07:29,249 --> 00:07:30,651
<c.magenta>现在我来展示另外一个演示</c>


141
00:07:30,951 --> 00:07:32,486
<c.magenta>不用担心</c>
<c.magenta>这次演示会很快</c>


142
00:07:33,420 --> 00:07:34,588
<c.magenta>让我们转到这里来</c>


143
00:07:38,025 --> 00:07:40,928
<c.magenta>在左边 我访问了一个网站</c>


144
00:07:41,361 --> 00:07:43,764
<c.magenta>在右边是一部iPhone手机</c>


145
00:07:43,830 --> 00:07:47,367
<c.magenta>现在Craig</c>
<c.magenta>通过网络预定了一些门票</c>


146
00:07:47,434 --> 00:07:48,869
<c.magenta>好在周四去观看海底总动员</c>


147
00:07:48,969 --> 00:07:53,173
<c.magenta>让我修改一下日期 改到周五</c>
<c.magenta>我们会和他一起去</c>


148
00:07:53,440 --> 00:07:56,543
<c.magenta>我会和十个工程师一起去</c>
<c.magenta>他们是我的同事</c>


149
00:07:57,344 --> 00:07:58,879
<c.magenta>好 向Craig打招呼</c>


150
00:07:59,847 --> 00:08:01,982
<c.magenta>好了 让我来点击下</c>
<c.magenta>Apple Pay来进行支付</c>


151
00:08:02,115 --> 00:08:04,318
<c.magenta>这一切都是即时发生的</c>


152
00:08:04,718 --> 00:08:06,553
<c.magenta>让我们来再做一次</c>
<c.magenta>这次我会取消它</c>


153
00:08:06,620 --> 00:08:09,656
<c.magenta>可以看到 当我取消了之后</c>
<c.magenta>在我的手机上也自动的取消了</c>


154
00:08:10,824 --> 00:08:12,326
<c.magenta>当我点击Apple Pay</c>
<c.magenta>支付按钮的时候</c>


155
00:08:13,927 --> 00:08:15,028
<c.magenta>一切都是立刻发生的</c>


156
00:08:15,095 --> 00:08:16,697
<c.magenta>它立刻出现了</c>


157
00:08:16,997 --> 00:08:18,765
<c.magenta>然后在我的手机上</c>
<c.magenta>进行了Touch ID的匹配</c>


158
00:08:23,170 --> 00:08:24,204
<c.magenta>这样就完成了</c>


159
00:08:24,271 --> 00:08:25,405
<c.magenta>几秒内完成了整个支付</c>


160
00:08:25,639 --> 00:08:27,641
<c.magenta>在这两个设备之间反应都是即时的</c>


161
00:08:27,708 --> 00:08:30,644
<c.magenta>然后我获得了一个消息</c>
<c.magenta>告知我完成了一次支付</c>


162
00:08:30,878 --> 00:08:35,182
<c.magenta>在Mac OS上使用</c>
<c.magenta>Apple Pay就这么简单和快速</c>


163
00:08:35,349 --> 00:08:36,650
<c.magenta>这个过程真的非常快速</c>


164
00:08:40,486 --> 00:08:43,023
<c.magenta>希望我说服了你们</c>
<c.magenta>Apple Pay是那么优秀</c>


165
00:08:43,490 --> 00:08:46,860
<c.magenta>让我们讲述一下在网页上</c>
<c.magenta>集成Apple Pay的细节</c>


166
00:08:47,561 --> 00:08:49,963
<c.magenta>在我们讨论网页API之前</c>


167
00:08:50,030 --> 00:08:51,565
<c.magenta>让我们来简单看一下</c>
<c.magenta>Apple Pay的基本知识</c>


168
00:08:51,632 --> 00:08:54,668
<c.magenta>因为很多人还没将Apple Pay</c>
<c.magenta>集成到应用之中的经历</c>


169
00:08:54,735 --> 00:08:56,537
<c.magenta>可能有人是一个纯粹的网页端开发者</c>


170
00:08:58,105 --> 00:09:01,642
<c.magenta>Apple Pay提供</c>
<c.magenta>具有唯一性的支付token给你</c>


171
00:09:03,177 --> 00:09:06,747
<c.magenta>你将这个token发送给网银平台</c>
<c.magenta>比如Stripe</c>


172
00:09:06,914 --> 00:09:09,016
<c.magenta>比如Braintree</c>
<c.magenta>还有Chase Paymentech</c>


173
00:09:10,217 --> 00:09:13,053
<c.magenta>对于一次交易来说</c>
<c.magenta>token是唯一的</c>


174
00:09:13,153 --> 00:09:14,588
<c.magenta>该token只能使用一次</c>


175
00:09:14,721 --> 00:09:16,323
<c.magenta>若需多次交易</c>
<c.magenta>同样需请求相应数量token</c>


176
00:09:16,990 --> 00:09:20,260
<c.magenta>无论你在应用或者</c>
<c.magenta>网页上使用Apple Pay</c>


177
00:09:20,327 --> 00:09:22,896
<c.magenta>t对商家来说token都是唯一的</c>


178
00:09:23,030 --> 00:09:24,031
<c.magenta>token经过加密</c>


179
00:09:24,431 --> 00:09:27,034
<c.magenta>即便token被盗取了</c>


180
00:09:27,367 --> 00:09:31,071
<c.magenta>比如用户处于</c>
<c.magenta>一个不安全的Wifi连接的时候</c>


181
00:09:31,305 --> 00:09:34,174
<c.magenta>这个token仍然是安全的</c>


182
00:09:34,274 --> 00:09:37,744
<c.magenta>因为它使用了商户的证书</c>
<c.magenta>以及商户的标识符进行了加密的编码</c>


183
00:09:40,080 --> 00:09:41,481
<c.magenta>商户的标识符</c>


184
00:09:41,548 --> 00:09:44,518
<c.magenta>以及商户的证书能够代表你是一个商户</c>


185
00:09:45,385 --> 00:09:48,255
<c.magenta>它们比较像标准的反向域名解析</c>


186
00:09:48,322 --> 00:09:51,124
<c.magenta>如果你是一个iOS开发者</c>
<c.magenta>你会非常熟悉这种格式</c>


187
00:09:51,792 --> 00:09:54,294
<c.magenta>它们是通过我们的开发者中心生成的</c>


188
00:09:55,028 --> 00:09:56,330
<c.magenta>并且是唯一的</c>


189
00:09:56,430 --> 00:09:58,932
<c.magenta>因为只有你能够解码这些tokens</c>


190
00:10:00,334 --> 00:10:02,736
<c.magenta>只有你才能读取</c>
<c.magenta>用户Apple Pay的token</c>


191
00:10:04,471 --> 00:10:08,575
<c.magenta>让我们来看一下</c>
<c.magenta>在实际的应用中是什么样的工作流程</c>


192
00:10:09,409 --> 00:10:10,611 line:1
<c.magenta>在一个iOS的应用中</c>


193
00:10:11,545 --> 00:10:13,847 line:1
<c.magenta>当Apple Pay按钮点击后</c>
<c.magenta>就开始了用Apple Pay的支付</c>


194
00:10:15,816 --> 00:10:18,018 line:1
<c.magenta>当点击了Apple Pay按钮之后</c>


195
00:10:19,086 --> 00:10:21,321 line:1
<c.magenta>iOS系统允许了这次支付</c>


196
00:10:21,488 --> 00:10:23,490 line:1
<c.magenta>然后出现了Apple Pay</c>
<c.magenta>表单页面</c>


197
00:10:24,491 --> 00:10:27,060 line:1
<c.magenta>然后用户使用</c>
<c.magenta>Touch ID或者密码</c>


198
00:10:27,561 --> 00:10:31,331 line:1
<c.magenta>这样支付信息会通过手机的</c>
<c.magenta>安全信息单元芯片产生</c>


199
00:10:31,465 --> 00:10:34,001 line:1
<c.magenta>这些芯片专门为</c>
<c.magenta>Apple Pay打造</c>


200
00:10:34,101 --> 00:10:35,636 line:1
<c.magenta>能够安全持有你的银行卡信息</c>


201
00:10:37,070 --> 00:10:40,607 line:1
<c.magenta>然后你的手机会做什么呢</c>


202
00:10:41,175 --> 00:10:44,378 line:1
<c.magenta>它会把数据发送给苹果的服务器</c>


203
00:10:44,478 --> 00:10:45,779 line:1
<c.magenta>服务端重新包装这些数据</c>
<c.magenta>该处理过程为Rewrap</c>


204
00:10:46,046 --> 00:10:49,049 line:1
<c.magenta>也就到时候对于商户来说</c>
<c.magenta>这些数据是再次加密过的</c>


205
00:10:49,616 --> 00:10:51,051 line:1
<c.magenta>该处理过程不会显示在手机</c>


206
00:10:52,319 --> 00:10:56,156 line:1
<c.magenta>当应用获取再次加密的支付数据的时候</c>
<c.magenta>它同时可以进行一个回调操作</c>


207
00:10:56,256 --> 00:10:59,826 line:1
<c.magenta>然后你就可以连接商户的服务器</c>


208
00:11:00,627 --> 00:11:04,198 line:1
<c.magenta>或者网银支付的服务器</c>


209
00:11:04,598 --> 00:11:07,000 line:1
<c.magenta>只要交易完成了 表单就会关闭</c>


210
00:11:09,570 --> 00:11:11,538 line:1
<c.magenta>在网页上使用</c>
<c.magenta>Apple Pay与此非常类似</c>


211
00:11:11,872 --> 00:11:13,407 line:1
<c.magenta>稍有几处不同</c>


212
00:11:13,473 --> 00:11:16,410 line:1
<c.magenta>发生在与验证商户有关的地方</c>


213
00:11:16,510 --> 00:11:18,478 line:1
<c.magenta>因为在iOS中应用都是</c>
<c.magenta>从App Store上获取的</c>


214
00:11:18,579 --> 00:11:19,913 line:1
<c.magenta>它们是已签名二进制文件</c>


215
00:11:20,380 --> 00:11:23,617 line:1
<c.magenta>在我们继续讨论这些之前</c>
<c.magenta>先让我们来看一下</c>


216
00:11:23,750 --> 00:11:24,751 line:1
<c.magenta>Apple Pay的一些要求</c>


217
00:11:25,953 --> 00:11:29,690
<c.magenta>任何网站都可使用Apple Pay</c>


218
00:11:30,524 --> 00:11:33,093
<c.magenta>前提是需要拥有一个苹果开发者帐号</c>


219
00:11:34,561 --> 00:11:37,364
<c.magenta>并且站点需要支持HTTPS</c>


220
00:11:39,499 --> 00:11:42,836
<c.magenta>最后 站点需要遵守</c>
<c.magenta>Apple Pay的指导方针</c>


221
00:11:43,003 --> 00:11:44,705
<c.magenta>这些指导方针都非常的明确</c>


222
00:11:44,838 --> 00:11:46,874
<c.magenta>大多数的网银平台都有着相关的条款</c>


223
00:11:47,007 --> 00:11:49,142
<c.magenta>关于那些商品可进行出售</c>
<c.magenta>那些商品禁止出售</c>


224
00:11:51,678 --> 00:11:55,282
<c.magenta>现在已经有一些电子商务平台</c>


225
00:11:55,449 --> 00:11:56,450
<c.magenta>已支持Apple Pay</c>


226
00:11:57,751 --> 00:12:00,120
<c.magenta>我们还将会谈到</c>
<c.magenta>一些具体的电子商务平台</c>


227
00:12:00,821 --> 00:12:02,789
<c.magenta>的网银支付处理</c>


228
00:12:02,856 --> 00:12:04,791
<c.magenta>如果你已经加入了某个电子商务平台</c>


229
00:12:04,858 --> 00:12:06,360
<c.magenta>你就不需要一个开发者帐户了</c>


230
00:12:06,527 --> 00:12:07,995
<c.magenta>它可以帮你处理这些</c>


231
00:12:10,130 --> 00:12:13,300
<c.magenta>假设你的站点符合所有的要求</c>


232
00:12:14,368 --> 00:12:18,038
<c.magenta>那么为了使用Apple Pay</c>
<c.magenta>首先需要为你的站点注册</c>


233
00:12:19,840 --> 00:12:21,742
<c.magenta>为你的站点注册是非常简单的</c>


234
00:12:21,808 --> 00:12:25,479
<c.magenta>你只需要在开发者中心</c>
<c.magenta>创建一个商户标识符以及证书</c>


235
00:12:27,214 --> 00:12:29,583
<c.magenta>然后注册你的域名</c>


236
00:12:29,883 --> 00:12:31,318
<c.magenta>并且让它与商户标识符对应</c>


237
00:12:31,518 --> 00:12:33,554
<c.magenta>域名需要是全称</c>


238
00:12:33,620 --> 00:12:36,857
<c.magenta>比如store.apple.com</c>


239
00:12:37,291 --> 00:12:39,493
<c.magenta>你想在哪站点支付</c>
<c.magenta>就需要填写相应的域名</c>


240
00:12:40,294 --> 00:12:43,397
<c.magenta>当你通过域名注册之后</c>
<c.magenta>我们会前往该域名进行验证</c>


241
00:12:44,665 --> 00:12:46,700
<c.magenta>然后你会获得一个证书</c>


242
00:12:46,767 --> 00:12:48,969
<c.magenta>一个苹果公司发行的TLS证书</c>


243
00:12:49,036 --> 00:12:52,105
<c.magenta>我们称之为Session证书</c>
<c.magenta>我需要重新说一下</c>


244
00:12:52,172 --> 00:12:55,542
<c.magenta>在注册Apple Pay中</c>
<c.magenta>使用了三种信息</c>


245
00:12:55,609 --> 00:12:58,679
<c.magenta>商户表识符以及商户证书</c>


246
00:12:58,745 --> 00:13:00,347
<c.magenta>通过这两项</c>
<c.magenta>证明我们商户的身份</c>


247
00:13:00,914 --> 00:13:03,016
<c.magenta>然后还有Apple Pay的</c>
<c.magenta>Session证书</c>


248
00:13:03,083 --> 00:13:04,718
<c.magenta>代表了我们的域名</c>


249
00:13:05,853 --> 00:13:08,522
<c.magenta>在开发者中心注册Apple Pay</c>
<c.magenta>非常简单和直接</c>


250
00:13:08,589 --> 00:13:11,558
<c.magenta>应该现在就已经可以注册了</c>
<c.magenta>就像这样做</c>


251
00:13:11,825 --> 00:13:12,960
<c.magenta>首先添加一个域名</c>


252
00:13:13,393 --> 00:13:15,696
<c.magenta>然后我们会检查这个域名上</c>


253
00:13:15,762 --> 00:13:17,931
<c.magenta>是否有我们要求放置的文件</c>


254
00:13:18,265 --> 00:13:19,099
<c.magenta>这样就可以了</c>


255
00:13:21,668 --> 00:13:24,338
<c.magenta>来看一下它为什么更适合使用</c>


256
00:13:26,840 --> 00:13:28,876 line:1
<c.magenta>让我们来看看在网页上使用</c>
<c.magenta>Apple Pay的流程</c>


257
00:13:29,109 --> 00:13:31,712 line:1
<c.magenta>就像在应用中</c>
<c.magenta>使用Apple Pay一样</c>


258
00:13:32,179 --> 00:13:36,316 line:1
<c.magenta>首先需要点击进行</c>
<c.magenta>Apple Pay支付的按钮</c>


259
00:13:38,218 --> 00:13:39,820 line:1
<c.magenta>在网页上有一个关键的地方不同</c>


260
00:13:40,254 --> 00:13:42,256 line:1
<c.magenta>当你创建了一个支付请求的时候</c>


261
00:13:42,689 --> 00:13:45,659 line:1
<c.magenta>也就是通知我们</c>
<c.magenta>你想对什么收费</c>


262
00:13:46,793 --> 00:13:48,695 line:1
<c.magenta>然后有一些额外的处理</c>


263
00:13:48,762 --> 00:13:52,099 line:1
<c.magenta>需要进行一次验证</c>
<c.magenta>你创建了一个商户的session</c>


264
00:13:53,033 --> 00:13:55,702 line:1
<c.magenta>然后从你的网页服务器</c>
<c.magenta>发送到了Apple服务器</c>


265
00:13:57,304 --> 00:13:59,840 line:1
<c.magenta>当Apple服务器有响应时</c>


266
00:13:59,907 --> 00:14:01,275 line:1
<c.magenta>你再将这个支付请求</c>
<c.magenta>发送给Apple服务器</c>


267
00:14:04,311 --> 00:14:05,512 line:1
<c.magenta>这就是唯一的区别了</c>


268
00:14:05,579 --> 00:14:08,081 line:1
<c.magenta>这是与在应用中</c>
<c.magenta>进行Apple Pay相比</c>


269
00:14:08,615 --> 00:14:10,317 line:1
<c.magenta>在网页中进行Apple Pay</c>
<c.magenta>的唯一的区别了</c>


270
00:14:10,617 --> 00:14:12,252 line:1
<c.magenta>商户有效性验证</c>


271
00:14:13,887 --> 00:14:16,023
<c.magenta>让我们看下商户验证的细节</c>


272
00:14:16,123 --> 00:14:17,791
<c.magenta>让我们来谈下为什么我们要这么做</c>


273
00:14:21,929 --> 00:14:24,998
<c.magenta>我在一分钟前提过</c>


274
00:14:25,165 --> 00:14:27,568
<c.magenta>那就是网页与应用之间有一些不同之处</c>


275
00:14:28,202 --> 00:14:32,039
<c.magenta>在iOS应用中</c>


276
00:14:32,105 --> 00:14:35,075
<c.magenta>类似Apple Pay或</c>
<c.magenta>位置安全性被签署授权所保护着</c>


277
00:14:35,209 --> 00:14:37,177
<c.magenta>如果你对此不是很熟悉</c>


278
00:14:37,244 --> 00:14:40,380
<c.magenta>签署授权就是 App Store中</c>
<c.magenta>你应用的二进制文件部分签名信息</c>


279
00:14:40,647 --> 00:14:44,184
<c.magenta>签署授权同时保护着用户和开发者</c>


280
00:14:44,585 --> 00:14:46,854
<c.magenta>以及Apple Pay中的商户</c>


281
00:14:47,387 --> 00:14:49,456
<c.magenta>我们需要注意的是</c>
<c.magenta>在网页上并不存在app store</c>


282
00:14:49,523 --> 00:14:51,124
<c.magenta>所以我们并没有这些签署授权</c>


283
00:14:51,225 --> 00:14:53,694
<c.magenta>我们使用了一个商户验证的处理</c>
<c.magenta>用替代签署授权</c>


284
00:14:54,661 --> 00:14:58,232
<c.magenta>它保护了用户</c>
<c.magenta>也同时保护了像你一样的商户</c>


285
00:14:58,332 --> 00:15:00,534
<c.magenta>举例来说</c>
<c.magenta>如果你的网站被攻破了</c>


286
00:15:00,601 --> 00:15:02,669
<c.magenta>你可方便停掉</c>
<c.magenta>该站点Apple Pay</c>


287
00:15:03,937 --> 00:15:06,573
<c.magenta>商户验证非常的简单和直接</c>


288
00:15:06,640 --> 00:15:07,841
<c.magenta>它并不复杂</c>


289
00:15:08,141 --> 00:15:10,711
<c.magenta>你拿到一个Apple Pay</c>
<c.magenta>服务器的URL</c>


290
00:15:11,879 --> 00:15:13,947
<c.magenta>这个URL是Safari提供的</c>


291
00:15:16,250 --> 00:15:18,285
<c.magenta>你让你的网页服务器使用这个URL</c>


292
00:15:19,386 --> 00:15:21,488
<c.magenta>在请求商户的session中会用到</c>


293
00:15:22,689 --> 00:15:25,125
<c.magenta>现在开始请求商户的session</c>


294
00:15:25,425 --> 00:15:28,228 line:1
<c.magenta>你需简单提供一TLS证书</c>
<c.magenta>这证书是我们之前为网站域名得到的</c>


295
00:15:28,362 --> 00:15:29,763 line:1
<c.magenta>这是个有挑战的回应</c>


296
00:15:30,831 --> 00:15:33,166 line:1
<c.magenta>如果这个证书看上去很好</c>
<c.magenta>是有效的</c>


297
00:15:33,300 --> 00:15:35,102 line:1
<c.magenta>并且它与这个域名匹配</c>


298
00:15:35,502 --> 00:15:37,371 line:1
<c.magenta>就是你提交支付请求网站对应的域名</c>


299
00:15:37,538 --> 00:15:38,739 line:1
<c.magenta>我们会收到一个session</c>


300
00:15:41,942 --> 00:15:43,610 line:1
<c.magenta>这个session中的内容无法获得</c>


301
00:15:43,710 --> 00:15:45,479
<c.magenta>你们不需要关注它的内容</c>


302
00:15:45,612 --> 00:15:47,648
<c.magenta>它是一个具有唯一性的token</c>


303
00:15:47,714 --> 00:15:49,216
<c.magenta>代表了一次Apple Pay的请求</c>


304
00:15:50,250 --> 00:15:52,452
<c.magenta>它被用来确认</c>
<c.magenta>你的网站依然是安全的</c>


305
00:15:52,786 --> 00:15:56,156
<c.magenta>每一次的Apple Pay</c>
<c.magenta>你都需要请求一次session</c>


306
00:15:56,390 --> 00:15:58,125
<c.magenta>但是这种请求的开销比较少</c>


307
00:15:58,292 --> 00:15:59,793
<c.magenta>且这过程不会占用太多的时间</c>


308
00:16:00,727 --> 00:16:02,763
<c.magenta>在你会通过你的网页服务器来请求它</c>


309
00:16:02,963 --> 00:16:05,098
<c.magenta>你并不是从你的用户那里来获得它</c>


310
00:16:07,534 --> 00:16:09,870
<c.magenta>对于商户效验</c>
<c.magenta>我有一些建议</c>


311
00:16:10,404 --> 00:16:13,440
<c.magenta>首先 让客户端发出</c>
<c.magenta>获得session的请求</c>


312
00:16:13,507 --> 00:16:16,009
<c.magenta>因为请求速度可能会有比较大的差别</c>


313
00:16:16,076 --> 00:16:17,244
<c.magenta>取决于用户所在的国家</c>


314
00:16:17,377 --> 00:16:19,246
<c.magenta>Apple Pay有很多</c>
<c.magenta>服务器部署在世界各地</c>


315
00:16:19,379 --> 00:16:21,548
<c.magenta>我们会使用</c>


316
00:16:21,648 --> 00:16:23,217
<c.magenta>离用户当前位置最近的服务器</c>


317
00:16:23,483 --> 00:16:25,886
<c.magenta>对于有些人来说</c>


318
00:16:25,953 --> 00:16:29,523
<c.magenta>需要预先知道这些服务器的IP地址</c>


319
00:16:29,590 --> 00:16:30,991
<c.magenta>用来让连接通过防火墙</c>


320
00:16:31,058 --> 00:16:32,292
<c.magenta>我们会提供一份列表</c>


321
00:16:32,459 --> 00:16:35,095
<c.magenta>放置在developmentalapple.com上</c>
<c.magenta>这样你们就能看到了</c>


322
00:16:36,530 --> 00:16:38,932
<c.magenta>你应该只请求一次session</c>


323
00:16:38,999 --> 00:16:39,967
<c.magenta>当用户点击Apple Pay按钮时</c>


324
00:16:40,033 --> 00:16:42,169
<c.magenta>别在加载页面时就请求</c>
<c.magenta>那样是没有必要的</c>


325
00:16:42,236 --> 00:16:44,471
<c.magenta>只需在用户点击了相应按钮后</c>
<c.magenta>才去请求session</c>


326
00:16:44,538 --> 00:16:47,875
<c.magenta>当请求session时</c>
<c.magenta>我们会展示Apple Pay表单</c>


327
00:16:48,275 --> 00:16:50,577
<c.magenta>用户会觉得这种情况是即时出现的</c>


328
00:16:50,711 --> 00:16:52,479
<c.magenta>当他们点击了</c>
<c.magenta>Apple Pay按钮后</c>


329
00:16:52,546 --> 00:16:55,048
<c.magenta>他们会看到这个表单</c>
<c.magenta>我们也会让它处于加载状态</c>


330
00:16:55,182 --> 00:16:56,717
<c.magenta>直到效验完成</c>


331
00:16:57,184 --> 00:16:59,253
<c.magenta>在下个部分</c>
<c.magenta>你们会看这些如何工作</c>


332
00:16:59,319 --> 00:17:00,621
<c.magenta>即在我们讲述</c>
<c.magenta>JavaScript API时</c>


333
00:17:02,089 --> 00:17:04,925
<c.magenta>最后一个建议 别在客户端</c>
<c.magenta>生成一个商户的session</c>


334
00:17:05,592 --> 00:17:08,428
<c.magenta>这是因为你需要</c>
<c.magenta>提供一个session证书</c>


335
00:17:08,529 --> 00:17:10,430
<c.magenta>而这个证书与你的域名对应</c>


336
00:17:10,497 --> 00:17:12,799
<c.magenta>你是不想把这证书</c>
<c.magenta>也嵌入到你的网页页面中的</c>


337
00:17:12,900 --> 00:17:14,902
<c.magenta>将这个证书保密是很重要的</c>


338
00:17:15,502 --> 00:17:18,105
<c.magenta>因此你会在网页服务端来进行这种验证</c>


339
00:17:19,705 --> 00:17:21,375
<c.magenta>好吧 让我们来概述一下</c>


340
00:17:22,342 --> 00:17:23,410
<c.magenta>我们先需建立个网站</c>


341
00:17:23,477 --> 00:17:26,813
<c.magenta>我们需要保证我们的网站</c>
<c.magenta>遵守Apple的要求</c>


342
00:17:27,580 --> 00:17:30,484
<c.magenta>我们创建了虚拟的标识符</c>
<c.magenta>以及商户证书</c>


343
00:17:31,118 --> 00:17:32,586
<c.magenta>我们将它与我们的域名相对应</c>


344
00:17:34,621 --> 00:17:36,356
<c.magenta>然后我们了解到了如何进行验证</c>


345
00:17:36,423 --> 00:17:40,027
<c.magenta>如何为每一个Apple Pay</c>
<c.magenta>支付进行效验</c>


346
00:17:42,629 --> 00:17:45,165 line:1
<c.magenta>所以说这样覆盖了部分同样的流程</c>


347
00:17:46,834 --> 00:17:47,968 line:1
<c.magenta>这个部分是什么？</c>


348
00:17:49,069 --> 00:17:53,874 line:1
<c.magenta>就是我说过的与应用中</c>
<c.magenta>使用Apple Pay相一致的部分</c>


349
00:17:54,875 --> 00:17:56,310 line:1
<c.magenta>但显然它们是不同的API</c>


350
00:17:56,376 --> 00:17:59,646 line:1
<c.magenta>因为我们无法在服务端调用Swift</c>


351
00:18:00,514 --> 00:18:01,882 line:1
<c.magenta>所以接下来我们会谈论到</c>


352
00:18:01,982 --> 00:18:05,152
<c.magenta>如何用JavaScript API</c>
<c.magenta>来支持这个新特性</c>


353
00:18:05,485 --> 00:18:07,354
<c.magenta>下面请Anders来进行介绍</c>


354
00:18:07,454 --> 00:18:09,523
<c.magenta>他是WebKit团队中的一员</c>


355
00:18:09,656 --> 00:18:10,657
<c.magenta>Anders</c>


356
00:18:19,633 --> 00:18:20,667
<c.magenta>谢谢 Nick</c>


357
00:18:21,668 --> 00:18:23,904
<c.magenta>今天在这里</c>
<c.magenta>我非常的兴奋</c>


358
00:18:24,004 --> 00:18:28,008
<c.magenta>我会告诉大家使用Apple Pay</c>
<c.magenta>JavaScript API多简单</c>


359
00:18:31,745 --> 00:18:35,349
<c.magenta>Nick已提到过Apple Pay</c>
<c.magenta>JavaScript API</c>


360
00:18:35,482 --> 00:18:39,586
<c.magenta>已可以在iOS 10的Safari中</c>


361
00:18:39,720 --> 00:18:41,388
<c.magenta>和那些通过SafariView</c>
<c.magenta>Controller的应用中使用</c>


362
00:18:42,623 --> 00:18:47,327
<c.magenta>现通过Mac OS Sierra系统</c>
<c.magenta>可让你在Mac的safari中使用Apple Pay</c>


363
00:18:48,028 --> 00:18:51,899
<c.magenta>同时需要使用Apple</c>
<c.magenta>Watch或者iPhone</c>


364
00:18:51,999 --> 00:18:53,667
<c.magenta>来进行实际的授权</c>


365
00:18:55,669 --> 00:18:57,671
<c.magenta>这些API非常的简单</c>


366
00:18:57,871 --> 00:19:00,908
<c.magenta>它有一个单一的入口</c>
<c.magenta>叫做ApplePaySession</c>


367
00:19:01,408 --> 00:19:06,079
<c.magenta>它受到了PassKit API影响</c>
<c.magenta>只是将场景切换到了应用中使用Apple Pay下</c>


368
00:19:06,580 --> 00:19:10,651
<c.magenta>如果你熟悉PassKit API</c>
<c.magenta>那么你会发现两者很类似</c>


369
00:19:12,953 --> 00:19:16,857
<c.magenta>在我们进行深入的了解之前</c>


370
00:19:16,924 --> 00:19:18,325
<c.magenta>我需要介绍一个朋友先</c>


371
00:19:19,626 --> 00:19:23,430
<c.magenta>她经营了一个商店</c>


372
00:19:24,064 --> 00:19:25,799
<c.magenta>售卖高端的衣服</c>


373
00:19:27,134 --> 00:19:28,235
<c.magenta>这些衣服是给狗穿的</c>


374
00:19:29,803 --> 00:19:33,240
<c.magenta>在几个月之前</c>
<c.magenta>她运行了一个网站</c>


375
00:19:33,307 --> 00:19:35,209
<c.magenta>在上面可以买衣服</c>


376
00:19:35,275 --> 00:19:37,544
<c.magenta>你可以在网上进行支付</c>


377
00:19:37,611 --> 00:19:39,179
<c.magenta>然后店家就会发货了</c>


378
00:19:40,280 --> 00:19:44,985
<c.magenta>但是不幸的是</c>
<c.magenta>现在这个生意有个困境</c>


379
00:19:48,488 --> 00:19:51,258
<c.magenta>有很多人访问这个网站</c>


380
00:19:51,458 --> 00:19:54,461
<c.magenta>但是却没有多少订单</c>


381
00:19:54,895 --> 00:19:57,297
<c.magenta>让我们来看下这个网站</c>


382
00:19:57,431 --> 00:19:58,832
<c.magenta>找一下原因</c>


383
00:20:02,002 --> 00:20:03,837
<c.magenta>这就是我们的网站了</c>


384
00:20:04,137 --> 00:20:07,975
<c.magenta>比如我们想买一条可爱的围巾</c>


385
00:20:09,042 --> 00:20:13,447
<c.magenta>首先将它添加到购物车里面</c>


386
00:20:15,849 --> 00:20:17,251
<c.magenta>然后我需要去付款</c>


387
00:20:19,152 --> 00:20:20,721
<c.magenta>这时候打开付款的页面</c>


388
00:20:20,854 --> 00:20:22,990
<c.magenta>输入收货地址</c>


389
00:20:25,425 --> 00:20:27,294
<c.magenta>这时候到信用卡这一栏了</c>


390
00:20:27,394 --> 00:20:30,297
<c.magenta>输入信用卡号以及账单地址</c>


391
00:20:32,032 --> 00:20:37,137 line:1
<c.magenta>然后我就可以提交订单</c>
<c.magenta>然后我的围巾也就会被运送了</c>


392
00:20:38,739 --> 00:20:41,808
<c.magenta>让我们看一下应该如何使用</c>
<c.magenta>Apple Pay API</c>


393
00:20:42,009 --> 00:20:44,978
<c.magenta>让这个流程变得更加简单合理</c>


394
00:20:46,313 --> 00:20:50,217
<c.magenta>举例来说</c>
<c.magenta>如果我们为购物车增加一个</c>


395
00:20:50,517 --> 00:20:54,555
<c.magenta>Apple Pay的按钮</c>


396
00:20:54,855 --> 00:20:58,559
<c.magenta>那样在产品页面就可以下单了</c>


397
00:20:59,993 --> 00:21:03,564
<c.magenta>现在我们想增加这个按钮</c>


398
00:21:03,664 --> 00:21:06,033
<c.magenta>但仅限那些能够使用</c>
<c.magenta>Apple Pay的用户</c>


399
00:21:07,367 --> 00:21:08,569
<c.magenta>为了做成那样</c>


400
00:21:08,735 --> 00:21:12,406
<c.magenta>我们可以使用函数</c>
<c.magenta>ApplePaySession.canMakePayments</c>


401
00:21:13,340 --> 00:21:15,342
<c.magenta>这是一个用起来非常简便的函数</c>


402
00:21:15,475 --> 00:21:17,244
<c.magenta>在代码中</c>
<c.magenta>它看起来是这样的</c>


403
00:21:17,644 --> 00:21:20,948
<c.magenta>注意 我检查了当前的</c>
<c.magenta>window.ApplePaySession</c>


404
00:21:21,048 --> 00:21:25,052
<c.magenta>在使用之前</c>
<c.magenta>需要进行这样的检查</c>


405
00:21:25,252 --> 00:21:29,857
<c.magenta>我不是检查WebKit或者</c>
<c.magenta>Safari的版本</c>


406
00:21:29,957 --> 00:21:32,492
<c.magenta>我是在检查</c>
<c.magenta>window.ApplePaySession对象是否存在</c>


407
00:21:33,327 --> 00:21:35,028
<c.magenta>如果它存在的话</c>
<c.magenta>我就会调用它</c>


408
00:21:35,195 --> 00:21:38,232
<c.magenta>它会返回一个Boolean</c>
<c.magenta>然后我会检查这个值</c>


409
00:21:38,565 --> 00:21:42,536
<c.magenta>如果返回true</c>
<c.magenta>我就调用showApplePayButtons</c>


410
00:21:43,203 --> 00:21:44,404
<c.magenta>这样显示出相应的按钮</c>


411
00:21:46,306 --> 00:21:47,674
<c.magenta>值得注意的是</c>


412
00:21:47,741 --> 00:21:51,011
<c.magenta>window.ApplePaySession</c>
<c.magenta>只会告诉你</c>


413
00:21:51,078 --> 00:21:52,513
<c.magenta>这设备是否支持Apple Pay</c>


414
00:21:52,946 --> 00:21:55,849
<c.magenta>如果你使用的</c>
<c.magenta>是iPhone或者iPad</c>


415
00:21:55,983 --> 00:21:58,252
<c.magenta>它会返回是否存在一个安全部件的结果</c>


416
00:21:58,685 --> 00:22:00,187
<c.magenta>如果你在Mac上使用</c>


417
00:22:00,320 --> 00:22:03,590
<c.magenta>它会告诉你</c>


418
00:22:03,857 --> 00:22:05,392
<c.magenta>是否存在一个iPhone或者</c>
<c.magenta>Apple Watch能为这次交易授权</c>


419
00:22:06,426 --> 00:22:09,663
<c.magenta>它不会告诉你用户是否已经</c>
<c.magenta>为Apple Pay添加过银行卡</c>


420
00:22:10,364 --> 00:22:13,767
<c.magenta>如果需要检查这一点的话</c>


421
00:22:13,867 --> 00:22:15,135
<c.magenta>我们可以使用</c>


422
00:22:15,202 --> 00:22:17,571
<c.magenta>ApplePaySession.canMakePayments</c>
<c.magenta>WithActiveCard</c>


423
00:22:18,739 --> 00:22:22,476
<c.magenta>你需要传递你的商户标识符给这个函数</c>


424
00:22:23,010 --> 00:22:27,648
<c.magenta>然后它会向Apple Pay</c>
<c.magenta>服务器验证</c>


425
00:22:27,748 --> 00:22:29,983
<c.magenta>这个商户标识符是否正确</c>


426
00:22:30,450 --> 00:22:33,687
<c.magenta>这个函数自身的属性会关联这个域名</c>


427
00:22:33,854 --> 00:22:35,255
<c.magenta>因为你从这个域名发送请求</c>


428
00:22:36,423 --> 00:22:40,594
<c.magenta>鉴于此 它是异步执行的并且返回一个</c>
<c.magenta>JavaScript promise</c>


429
00:22:41,528 --> 00:22:44,364
<c.magenta>如你不知道一个JavaScript</c>
<c.magenta>promise是什么</c>


430
00:22:44,531 --> 00:22:47,167
<c.magenta>你可以把它当成一个功能更强的</c>


431
00:22:47,267 --> 00:22:49,837
<c.magenta>回调处理程序</c>


432
00:22:52,639 --> 00:22:56,109
<c.magenta>你使用这个函数的时候还有一些限制</c>


433
00:22:56,210 --> 00:23:00,280
<c.magenta>你只能在一些情况下才能使用</c>
<c.magenta>如支付流程默认用Apple Pay</c>


434
00:23:00,848 --> 00:23:04,318
<c.magenta>或者你想在产品页面上</c>
<c.magenta>就添加一个产品页面按钮</c>


435
00:23:04,518 --> 00:23:07,221
<c.magenta>在我们的情况中</c>
<c.magenta>我们想添加一Apple Pay按钮</c>


436
00:23:07,321 --> 00:23:10,057
<c.magenta>放在我们的产品页面上</c>
<c.magenta>所以我们可以使用这个函数</c>


437
00:23:10,290 --> 00:23:13,794
<c.magenta>另外我们可能会使用</c>
<c.magenta>ApplePaySession.canMakePayments</c>


438
00:23:15,629 --> 00:23:17,598
<c.magenta>我们在这里使用了这个函数</c>


439
00:23:18,098 --> 00:23:21,768
<c.magenta>我又一次的检查了Apple Pay session</c>
<c.magenta>对象是否存在</c>


440
00:23:22,603 --> 00:23:25,539
<c.magenta>然后调用canMakePayments</c>
<c.magenta>WithActiveCard</c>


441
00:23:25,772 --> 00:23:27,708
<c.magenta>我输入了我的商户标识符</c>


442
00:23:28,175 --> 00:23:34,214
<c.magenta>然后我使用了这个promise</c>
<c.magenta>当promise成功后就会执行相应的功能</c>


443
00:23:34,381 --> 00:23:37,217
<c.magenta>在这个例子中promise成功后</c>
<c.magenta>会得到一个BOOL值</c>


444
00:23:37,551 --> 00:23:40,754
<c.magenta>我在promise中的代码就会执行</c>


445
00:23:40,821 --> 00:23:44,625
<c.magenta>如果canMakePayments返回true</c>
<c.magenta>那么就会展示ApplePay按钮</c>


446
00:23:47,094 --> 00:23:51,198
<c.magenta>现在我们就能看到每一个产品下面</c>
<c.magenta>都有一个优美的按钮了</c>


447
00:23:51,532 --> 00:23:54,268
<c.magenta>下一步就是弹出支付表单</c>


448
00:23:54,501 --> 00:23:56,303
<c.magenta>当用户点击了这些按钮的时候</c>


449
00:23:57,971 --> 00:23:59,506
<c.magenta>为了做成这样</c>


450
00:23:59,573 --> 00:24:02,843
<c.magenta>我们需要创建一个新的ApplePaySession</c>
<c.magenta>JavaScript对象</c>


451
00:24:03,810 --> 00:24:07,214
<c.magenta>ApplePaySession</c>
<c.magenta>构造器有两个参数</c>


452
00:24:07,614 --> 00:24:10,284
<c.magenta>一个是API版本号</c>


453
00:24:10,918 --> 00:24:12,319
<c.magenta>还有一个是我们自定义的</c>


454
00:24:12,452 --> 00:24:15,255
<c.magenta>从而让我们可以扩展</c>
<c.magenta>ApplePaySession API</c>


455
00:24:15,522 --> 00:24:19,359
<c.magenta>这样可以向下兼容而不影响当前的用户</c>


456
00:24:21,128 --> 00:24:25,866
<c.magenta>这当前的API的版本号是1</c>
<c.magenta>所以就一直保持1</c>


457
00:24:27,868 --> 00:24:31,371
<c.magenta>将支付请求当成</c>
<c.magenta>第二个参数传入这个请求</c>


458
00:24:31,738 --> 00:24:35,943
<c.magenta>如果你较熟悉PassKit API</c>


459
00:24:36,009 --> 00:24:37,644
<c.magenta>你会发现这个JavaScript和</c>
<c.magenta>PKPaymentRequest一样</c>


460
00:24:38,412 --> 00:24:41,281
<c.magenta>它会拿到所有必要的信息</c>


461
00:24:41,348 --> 00:24:44,885
<c.magenta>来在表单中展示</c>
<c.magenta>比如货币类型 国家</c>


462
00:24:44,952 --> 00:24:48,455
<c.magenta>如何支付以及总金额</c>


463
00:24:49,690 --> 00:24:53,894
<c.magenta>还有一些可选项</c>
<c.magenta>比如收货地址</c>


464
00:24:53,961 --> 00:24:55,395
<c.magenta>可能会被要求</c>


465
00:24:56,430 --> 00:24:59,366
<c.magenta>然后你就获得了新的</c>
<c.magenta>ApplePaySession对象</c>


466
00:24:59,499 --> 00:25:02,336
<c.magenta>你只需调用Begin命令</c>
<c.magenta>然后展示表单</c>


467
00:25:04,438 --> 00:25:06,440
<c.magenta>就像这样的JavaScript代码</c>


468
00:25:06,874 --> 00:25:10,010
<c.magenta>首先我们声明一个</c>
<c.magenta>paymentRequest对象</c>


469
00:25:10,644 --> 00:25:13,780
<c.magenta>然后指明了货币码和国家码</c>


470
00:25:14,781 --> 00:25:21,288
<c.magenta>这里我指明了总金额和支持的卡片种类</c>


471
00:25:21,421 --> 00:25:23,490
<c.magenta>还有商户的经营范围</c>


472
00:25:23,991 --> 00:25:28,829
<c.magenta>最后我指明了需要一个完整的邮编</c>


473
00:25:28,962 --> 00:25:30,764 line:1
<c.magenta>处于发货的考虑</c>


474
00:25:32,432 --> 00:25:35,002 line:1
<c.magenta>就我创建了</c>
<c.magenta>新的ApplePaySession</c>


475
00:25:35,169 --> 00:25:37,404 line:1
<c.magenta>我传入了商户号的参数</c>
<c.magenta>这里是1</c>


476
00:25:37,604 --> 00:25:39,173 line:1
<c.magenta>还有支付请求</c>


477
00:25:39,540 --> 00:25:42,442 line:1
<c.magenta>在得到返回结果之后</c>
<c.magenta>我仍然会再次调用sessions</c>


478
00:25:45,445 --> 00:25:49,650
<c.magenta>现在使用任何支付的API</c>


479
00:25:49,783 --> 00:25:51,952
<c.magenta>我们都去要确保所有的细节是正确的</c>


480
00:25:52,286 --> 00:25:54,588
<c.magenta>正因为如此</c>


481
00:25:57,090 --> 00:26:01,862
<c.magenta>在我们展示表单之前</c>
<c.magenta>我们需要进行一系列的验证</c>


482
00:26:02,663 --> 00:26:05,265
<c.magenta>如果任何一步出现错误</c>


483
00:26:05,999 --> 00:26:09,336
<c.magenta>我们会停止 然后抛出一个</c>
<c.magenta>JavaScript的异常</c>


484
00:26:10,838 --> 00:26:13,707
<c.magenta>正由于此 创建一个</c>
<c.magenta>Apple Pay session</c>


485
00:26:13,774 --> 00:26:15,542
<c.magenta>可能会抛出一个</c>
<c.magenta>JavaScript异常</c>


486
00:26:15,976 --> 00:26:19,012
<c.magenta>举例来说</c>
<c.magenta>如果你在一个不安全的页面进行调用</c>


487
00:26:19,446 --> 00:26:22,783
<c.magenta>比如这个页面不是基于HTTPS的</c>


488
00:26:22,850 --> 00:26:25,886
<c.magenta>没有使用最好的编码协议</c>


489
00:26:26,987 --> 00:26:30,791
<c.magenta>实际上每个Apple Pay</c>
<c.magenta>session API</c>


490
00:26:30,858 --> 00:26:33,327
<c.magenta>都会抛出异常</c>


491
00:26:33,393 --> 00:26:35,028
<c.magenta>如在一个不安全页面上进行调用</c>


492
00:26:37,364 --> 00:26:40,100
<c.magenta>创建Apple Pay</c>
<c.magenta>session也会发生异常</c>


493
00:26:40,167 --> 00:26:42,669
<c.magenta>在你没有传入一个有效的</c>
<c.magenta>支付请求的时候</c>


494
00:26:43,103 --> 00:26:46,840
<c.magenta>举例来说</c>
<c.magenta>你没有指定一个支持的网络列表</c>


495
00:26:47,207 --> 00:26:51,345
<c.magenta>或者总金额是负的</c>


496
00:26:51,678 --> 00:26:56,250
<c.magenta>或者输入了什么错误的数据</c>
<c.magenta>我们无法识别</c>


497
00:26:56,583 --> 00:26:58,051
<c.magenta>这样都会抛出异常</c>


498
00:27:00,420 --> 00:27:05,025
<c.magenta>此外 调用Begin也可能抛出异常</c>


499
00:27:05,092 --> 00:27:09,363
<c.magenta>若你不是在一个点击事件处理中调用它</c>
<c.magenta>举例来说</c>


500
00:27:09,863 --> 00:27:12,199
<c.magenta>我们不会允许展示表单</c>


501
00:27:12,566 --> 00:27:15,169
<c.magenta>除非用户明确的</c>


502
00:27:15,235 --> 00:27:17,804
<c.magenta>点击了按钮</c>


503
00:27:19,339 --> 00:27:23,143
<c.magenta>如果已经存在了表单了</c>
<c.magenta>然后我们又试图去调用Begin</c>


504
00:27:23,243 --> 00:27:25,012
<c.magenta>我们也会获得</c>
<c.magenta>JavaScript异常</c>


505
00:27:25,612 --> 00:27:28,348
<c.magenta>因为我们只允许</c>
<c.magenta>同时只能出现一个表单</c>


506
00:27:29,583 --> 00:27:33,153
<c.magenta>如果你看到了这些错误的话</c>


507
00:27:33,587 --> 00:27:37,357
<c.magenta>你可以使用网页检查器的错误控制台</c>


508
00:27:37,758 --> 00:27:40,694
<c.magenta>来查看错误原因的细节</c>


509
00:27:42,529 --> 00:27:47,634
<c.magenta>如果一切都正常</c>


510
00:27:49,369 --> 00:27:50,504
<c.magenta>并且所有步骤也正确</c>


511
00:27:50,737 --> 00:27:52,439
<c.magenta>那么就会显示这个表单</c>


512
00:27:54,575 --> 00:27:57,878
<c.magenta>但是需要注意</c>
<c.magenta>你现在还没有完成支付</c>


513
00:27:58,011 --> 00:28:00,380
<c.magenta>我们看到这里还在加载</c>


514
00:28:00,814 --> 00:28:03,917
<c.magenta>因为还没有完成商户的效验</c>


515
00:28:04,017 --> 00:28:05,419
<c.magenta>Nick之前提到过这一点</c>


516
00:28:06,520 --> 00:28:09,790
<c.magenta>所以在表单出现后</c>


517
00:28:10,324 --> 00:28:12,826
<c.magenta>我们会立即发送</c>
<c.magenta>一个验证商户的DOM事件</c>


518
00:28:12,926 --> 00:28:14,661
<c.magenta>向ApplePaySession</c>
<c.magenta>对象发送</c>


519
00:28:15,863 --> 00:28:18,832
<c.magenta>这个DOM事件有一个属性</c>
<c.magenta>validationURL</c>


520
00:28:19,199 --> 00:28:22,369
<c.magenta>你需要让你的服务器</c>
<c.magenta>能够访问这个URL</c>


521
00:28:22,469 --> 00:28:25,939
<c.magenta>然后加载它来获得商户session</c>


522
00:28:27,307 --> 00:28:29,843
<c.magenta>然后当你的服务器获得</c>
<c.magenta>merchantsession对象后</c>


523
00:28:29,977 --> 00:28:34,014
<c.magenta>你需要调用</c>
<c.magenta>completeMerchantValidation</c>


524
00:28:34,248 --> 00:28:36,550
<c.magenta>来通过这次验证</c>
<c.magenta>然后就可以继续了</c>


525
00:28:37,584 --> 00:28:40,587
<c.magenta>一次商户验证事件处理就像这样</c>


526
00:28:42,322 --> 00:28:44,825
<c.magenta>这里我调用了这个</c>
<c.magenta>performValidation方法</c>


527
00:28:44,925 --> 00:28:45,959
<c.magenta>它是我自己定义的</c>


528
00:28:46,093 --> 00:28:49,263
<c.magenta>它返回一个promise</c>
<c.magenta>这个promise</c>


529
00:28:49,396 --> 00:28:51,098
<c.magenta>来获得商户的session</c>


530
00:28:51,732 --> 00:28:53,300
<c.magenta>所以当promise成功后</c>


531
00:28:53,567 --> 00:28:55,936
<c.magenta>我会调用</c>
<c.magenta>completeMerchantValidation</c>


532
00:28:56,136 --> 00:28:57,804
<c.magenta>传入了商户session的参数</c>


533
00:28:57,938 --> 00:28:59,840
<c.magenta>这就是你在商户验证中所做的</c>


534
00:29:01,742 --> 00:29:04,578
<c.magenta>现在 我们的商户验证就完成了</c>


535
00:29:04,778 --> 00:29:07,614
<c.magenta>用户可以用手机或者</c>
<c.magenta>Apple Watch</c>


536
00:29:07,714 --> 00:29:09,082
<c.magenta>对这次支付授权</c>


537
00:29:09,316 --> 00:29:12,352
<c.magenta>当这次支付获得授权之后</c>


538
00:29:12,452 --> 00:29:16,957
<c.magenta>我们会向Apple Pay session对象</c>
<c.magenta>发送一个支付授权通过的DOM事件</c>


539
00:29:18,425 --> 00:29:20,894
<c.magenta>这个DOM事件包含了一个支付属性</c>


540
00:29:21,228 --> 00:29:24,398
<c.magenta>这个属性含有所有必需的支付信息</c>


541
00:29:24,898 --> 00:29:27,734
<c.magenta>它有着诸东西如收货地址</c>


542
00:29:28,168 --> 00:29:32,673
<c.magenta>以及其他一些在这次支付会用到的信息</c>


543
00:29:33,207 --> 00:29:36,343
<c.magenta>然后它还有加密过的支付token</c>


544
00:29:36,577 --> 00:29:38,745
<c.magenta>网银平台会用到这个token</c>


545
00:29:39,880 --> 00:29:44,618
<c.magenta>一旦你向网银平台发送了token</c>
<c.magenta>意味着这次支付就已经处理完毕了</c>


546
00:29:45,385 --> 00:29:48,155
<c.magenta>获得网银平台的反馈数据后调用</c>
<c.magenta>completePayment方法</c>


547
00:29:48,288 --> 00:29:51,892
<c.magenta>这个方法同时会让表单在界面上消失</c>
<c.magenta>就像这样</c>


548
00:29:53,260 --> 00:29:56,029
<c.magenta>这里我们就会有一个授权后的事情处理</c>


549
00:29:56,997 --> 00:29:58,498
<c.magenta>我调用</c>
<c.magenta>sendPaymentToken</c>


550
00:29:58,599 --> 00:30:00,033
<c.magenta>我将token传入了</c>


551
00:30:00,467 --> 00:30:04,304
<c.magenta>这样就会返回一个promise</c>


552
00:30:04,771 --> 00:30:08,809
<c.magenta>会通过一个BOOL值来代表</c>


553
00:30:08,876 --> 00:30:10,711
<c.magenta>你的支付成功还是失败</c>


554
00:30:11,178 --> 00:30:13,614
<c.magenta>如果成功的话</c>


555
00:30:13,714 --> 00:30:16,250
<c.magenta>我会将状态设置为</c>
<c.magenta>ApplePaySession.STATUS_SUCCESS</c>


556
00:30:17,150 --> 00:30:20,320
<c.magenta>如果失败了</c>
<c.magenta>假定这个支付没有完成</c>


557
00:30:20,521 --> 00:30:23,724
<c.magenta>那么将状态设置为</c>
<c.magenta>ApplePaySession.STATUS_FAILURE</c>


558
00:30:24,958 --> 00:30:26,827
<c.magenta> 然后我会调用</c>
<c.magenta>completePayment</c>


559
00:30:26,994 --> 00:30:30,163
<c.magenta>我传递了status参数</c>
<c.magenta>它会关闭sheet</c>


560
00:30:30,631 --> 00:30:32,599
<c.magenta>然后我再调用</c>
<c.magenta>showConfirmation</c>


561
00:30:32,666 --> 00:30:35,669
<c.magenta>这样会弹出一个美观的订单确认的页面</c>


562
00:30:36,303 --> 00:30:40,274
<c.magenta>调用completePayment</c>
<c.magenta>传入成功的状态码</c>


563
00:30:40,641 --> 00:30:43,310
<c.magenta>你会看一个好看的确认的标记</c>
<c.magenta>并且表单会从界面上消失</c>


564
00:30:44,878 --> 00:30:48,148
<c.magenta>好了 现在让我们来看一下演示</c>


565
00:30:48,515 --> 00:30:50,517
<c.magenta>来看一下如何办到这些</c>


566
00:30:56,924 --> 00:30:57,991
<c.magenta>我们开始了</c>


567
00:30:59,359 --> 00:31:02,729
<c.magenta>首先 我们进入了这个网站</c>


568
00:31:04,431 --> 00:31:07,568
<c.magenta>同时让我们看一下源代码</c>


569
00:31:09,536 --> 00:31:13,040
<c.magenta>在我们加入JavaScript之前</c>
<c.magenta>关注一下这些</c>


570
00:31:13,173 --> 00:31:16,577
<c.magenta>这里我加了两个触摸用的图标</c>


571
00:31:17,110 --> 00:31:20,547
<c.magenta>举例来说在Safari</c>
<c.magenta>Favorites视图中会用到</c>


572
00:31:20,614 --> 00:31:24,952
<c.magenta>它们也可以在Apple Pay</c>
<c.magenta>授权的表单中使用</c>


573
00:31:25,018 --> 00:31:26,320
<c.magenta>我们稍后会看到</c>


574
00:31:27,487 --> 00:31:30,157
<c.magenta>这里我列举了所有的产品</c>


575
00:31:30,290 --> 00:31:33,560
<c.magenta>之前我们已经为它们</c>
<c.magenta>增加了Apple Pay按钮</c>


576
00:31:33,894 --> 00:31:36,830
<c.magenta>我也可以通过CSS来让它们是否显示</c>


577
00:31:37,297 --> 00:31:38,665
<c.magenta>让我们来看一下</c>


578
00:31:40,667 --> 00:31:41,668
<c.magenta>这是我的CSS文件</c>


579
00:31:41,735 --> 00:31:44,004
<c.magenta>这里是关于Apple Pay</c>
<c.magenta>按钮的声明</c>


580
00:31:44,338 --> 00:31:47,407
<c.magenta>这里我设置让它们不显示</c>


581
00:31:47,674 --> 00:31:49,977
<c.magenta>对于它的图片</c>


582
00:31:50,077 --> 00:31:53,680
<c.magenta>我使用了WebKit-named-image特效</c>


583
00:31:53,780 --> 00:31:56,183
<c.magenta>这样我们可以使用系统自带的</c>
<c.magenta>Apple Pay的Logo</c>


584
00:31:56,316 --> 00:31:58,452
<c.magenta>你并不需在你的服务器上放置这张图片</c>


585
00:31:59,686 --> 00:32:03,690
<c.magenta>好了 现在我们需要增加一些代码</c>


586
00:32:03,790 --> 00:32:07,694
<c.magenta>让设备支持Apple Pay情况下</c>
<c.magenta>显示Apple Pay按钮</c>


587
00:32:09,096 --> 00:32:11,632
<c.magenta>这里我已经写过一些同样的代码了</c>


588
00:32:11,698 --> 00:32:15,369
<c.magenta>我为DOMContentLoaded事件</c>
<c.magenta>创建了一个EventListener</c>


589
00:32:15,636 --> 00:32:16,803
<c.magenta>这个事件会被执行</c>


590
00:32:16,904 --> 00:32:19,039
<c.magenta>当主页被加载的时候</c>


591
00:32:19,439 --> 00:32:22,943
<c.magenta>但是在任何图片加载之前</c>


592
00:32:23,010 --> 00:32:24,645
<c.magenta>所以这个地方适合放置这些代码</c>


593
00:32:24,778 --> 00:32:27,214
<c.magenta>让我们来添加一些代码来完成这个功能</c>


594
00:32:27,848 --> 00:32:31,485
<c.magenta>我们又检查了ApplePaySession是否存在</c>


595
00:32:31,652 --> 00:32:34,054
<c.magenta>然后我调用了</c>
<c.magenta>canMakePaymentsWithActiveCard</c>


596
00:32:34,454 --> 00:32:37,925
<c.magenta>并且在我的promise函数中</c>
<c.magenta>我检查了返回的值</c>


597
00:32:38,025 --> 00:32:40,527
<c.magenta>若返回true</c>
<c.magenta>调用showApplePayButton</c>


598
00:32:40,961 --> 00:32:44,765
<c.magenta>现在让我们保存后再回到这里</c>
<c.magenta>然后我们开始加载</c>


599
00:32:44,865 --> 00:32:46,867
<c.magenta>现在我们就获得了</c>
<c.magenta>Apple Pay按钮</c>


600
00:32:48,135 --> 00:32:52,639
<c.magenta>下一个步骤是</c>
<c.magenta>点击按钮的时候 弹出sheet</c>


601
00:32:52,706 --> 00:32:55,776
<c.magenta>我已经写了一个applePayButtonClicked函数</c>


602
00:32:56,176 --> 00:32:59,880
<c.magenta>在用户点击按钮的时候会执行</c>


603
00:33:00,514 --> 00:33:04,718
<c.magenta>所以我们想在这里让用户点击按钮之后</c>
<c.magenta>就显示表单</c>


604
00:33:05,352 --> 00:33:08,589
<c.magenta>所以我又声明了</c>
<c.magenta>paymentRequest对象</c>


605
00:33:08,922 --> 00:33:12,025
<c.magenta>这里的金额 我直接硬编码了</c>
<c.magenta>这毕竟只是个demo</c>


606
00:33:12,159 --> 00:33:15,629
<c.magenta>但是在实际的场景中</c>
<c.magenta>这个数据应该从别的地方获取</c>


607
00:33:16,330 --> 00:33:19,099
<c.magenta>我创建了一个新的</c>
<c.magenta>ApplePaySession对象</c>


608
00:33:19,233 --> 00:33:20,367
<c.magenta>然后调用Begin</c>


609
00:33:20,567 --> 00:33:24,538
<c.magenta>让我们保存后重新加载</c>
<c.magenta>并且展示出表单</c>


610
00:33:28,175 --> 00:33:31,211
<c.magenta>可以看到表单并没有显示</c>


611
00:33:31,345 --> 00:33:35,048
<c.magenta>让我们打开错误控制台</c>
<c.magenta>来找一下原因</c>


612
00:33:37,551 --> 00:33:38,485
<c.magenta>好了 控制台指出</c>


613
00:33:38,585 --> 00:33:41,555
<c.magenta>“supportednetwork”</c>
<c.magenta>并不是一个合法的属性名称</c>


614
00:33:41,622 --> 00:33:44,358
<c.magenta>看起来这里是</c>
<c.magenta>我拼错了"supported"</c>


615
00:33:44,691 --> 00:33:47,094
<c.magenta>所以让我们回头解决掉这个问题</c>


616
00:33:49,897 --> 00:33:50,998
<c.magenta>然后重新加载</c>


617
00:33:52,666 --> 00:33:54,301
<c.magenta>现在表单就可以展示出来了</c>


618
00:33:54,568 --> 00:33:57,171
<c.magenta>但是我还不能确认这次支付</c>


619
00:33:57,337 --> 00:33:59,573
<c.magenta>因为还没有进行商户的验证</c>


620
00:33:59,840 --> 00:34:01,308
<c.magenta>所以让我们来进行这个步骤</c>


621
00:34:03,610 --> 00:34:06,547
<c.magenta>我想加入</c>
<c.magenta>validateMerchant事情处理</c>


622
00:34:06,613 --> 00:34:09,550
<c.magenta>我会在这里创建了</c>
<c.magenta>session后再加入</c>


623
00:34:09,683 --> 00:34:11,351
<c.magenta>但是我们会先调用Begin</c>


624
00:34:11,752 --> 00:34:14,154
<c.magenta>再一次的</c>
<c.magenta>调用performValidation</c>


625
00:34:14,554 --> 00:34:18,091
<c.magenta>当这个promise获得了</c>
<c.magenta>处理结果的时候</c>


626
00:34:18,358 --> 00:34:21,828
<c.magenta>它会调用completeMerchantValidation</c>
<c.magenta>我会传入商户的session</c>


627
00:34:22,228 --> 00:34:28,068
<c.magenta>然后我就能够确认支付了</c>


628
00:34:28,668 --> 00:34:30,637
<c.magenta>现在我们还需要做最后一件事情</c>


629
00:34:30,737 --> 00:34:33,206
<c.magenta>那就是添加我们的支付授权代码</c>


630
00:34:34,608 --> 00:34:40,647
<c.magenta>我们会向服务器发送支付token</c>


631
00:34:40,880 --> 00:34:42,716
<c.magenta>并且完成这次支付</c>


632
00:34:42,815 --> 00:34:45,752
<c.magenta>如果我们成功了</c>
<c.magenta>我会将状态设为SUCCESS</c>


633
00:34:46,186 --> 00:34:47,788
<c.magenta>否则我将它设为FAILURE</c>


634
00:34:48,121 --> 00:34:51,257
<c.magenta>回调completePayment</c>
<c.magenta>及showConfirmation</c>


635
00:34:51,658 --> 00:34:56,563
<c.magenta>现在我想使用QuickTime</c>


636
00:34:56,663 --> 00:35:00,434
<c.magenta>让我们来看一下</c>
<c.magenta>在真实手机上的表现效果</c>


637
00:35:00,968 --> 00:35:03,937
<c.magenta>让我们重新加载</c>
<c.magenta>我点击了支付按钮</c>


638
00:35:05,038 --> 00:35:06,306
<c.magenta>现在我就可以确认了</c>


639
00:35:06,406 --> 00:35:09,510
<c.magenta>就像你们看到的那样</c>
<c.magenta>我还能看到这个网站的图标</c>


640
00:35:09,610 --> 00:35:12,179
<c.magenta>那是因为我添加了链接图标的属性</c>


641
00:35:12,579 --> 00:35:16,116
<c.magenta>现在我们可以进行支付了</c>
<c.magenta>然后完成支付</c>


642
00:35:16,550 --> 00:35:18,485
<c.magenta>商家会安排发货了</c>


643
00:35:28,328 --> 00:35:32,099
<c.magenta>所以为网页添加Apple Pay</c>
<c.magenta>是非常简单的</c>


644
00:35:32,633 --> 00:35:35,836
<c.magenta>我相信如果那样做的话</c>


645
00:35:36,303 --> 00:35:39,373
<c.magenta>Canine服饰会在狗狗中流行</c>


646
00:35:40,474 --> 00:35:41,775
<c.magenta>该让Nick回到台上了</c>


647
00:35:47,147 --> 00:35:50,017
<c.magenta>大家都知道Anders</c>
<c.magenta>他是WebKit团队中的那位</c>


648
00:35:50,083 --> 00:35:53,453
<c.magenta>跟狗天天在一起</c>
<c.magenta>并且应该被丢进狗屋的人</c>


649
00:35:54,087 --> 00:35:55,155
<c.magenta>好了 让我们继续</c>


650
00:35:55,689 --> 00:35:56,990
<c.magenta>给我一根骨头吧</c>


651
00:35:59,226 --> 00:36:00,894
<c.magenta>我去当软件工程师太浪费了</c>


652
00:36:00,961 --> 00:36:01,929
<c.magenta>好了</c>


653
00:36:01,995 --> 00:36:08,435
<c.magenta>我们已经看到了如何在网页中</c>
<c.magenta>支持Apple Pay</c>


654
00:36:08,569 --> 00:36:11,605
<c.magenta>让我们来讨论一些可能对你们来说</c>
<c.magenta>是比较重要的事情</c>


655
00:36:11,705 --> 00:36:13,240
<c.magenta>那就是你们如何获得付款</c>


656
00:36:13,307 --> 00:36:15,375
<c.magenta>从Apple Pay中获得付款</c>


657
00:36:16,777 --> 00:36:21,882
<c.magenta>Anders讲述了</c>
<c.magenta>获得支付数据的过程</c>


658
00:36:23,283 --> 00:36:24,518 line:1
<c.magenta>后面会发生什么</c>


659
00:36:25,652 --> 00:36:29,323 line:1
<c.magenta>因为拥有一个支付token</c>
<c.magenta>你现在有两个选择</c>


660
00:36:31,024 --> 00:36:34,895
<c.magenta>第一个是自己对这个</c>
<c.magenta>token进行解码</c>


661
00:36:35,128 --> 00:36:36,797
<c.magenta>通过你自己的服务器</c>


662
00:36:38,131 --> 00:36:40,601
<c.magenta>这是较好的选择</c>
<c.magenta>对你已使用了Apple Pay</c>


663
00:36:40,701 --> 00:36:42,836
<c.magenta>或者你有一个非常大型的电子商务后台</c>


664
00:36:42,903 --> 00:36:45,072
<c.magenta>你会熟悉其中加密算法</c>


665
00:36:45,138 --> 00:36:47,007
<c.magenta>在我们的开发者网站上有相关的文档</c>


666
00:36:47,474 --> 00:36:49,877
<c.magenta>另外一个选择是</c>


667
00:36:49,977 --> 00:36:52,379
<c.magenta>将这些加密的支付数据</c>


668
00:36:52,579 --> 00:36:56,383
<c.magenta>发送到网银平台</c>
<c.magenta>然后它们会帮你解码这些支付数据</c>


669
00:36:56,483 --> 00:36:58,952
<c.magenta>前提是你将密匙提供给了它们</c>


670
00:37:00,554 --> 00:37:01,922
<c.magenta>这是一个比较方便的选择</c>


671
00:37:02,022 --> 00:37:06,326
<c.magenta>非常多的网银平台</c>
<c.magenta>提供了应用内的SDK</c>


672
00:37:06,527 --> 00:37:08,629
<c.magenta>我们非常相信这些平台</c>


673
00:37:08,729 --> 00:37:12,065
<c.magenta>也会提供类似的基于</c>
<c.magenta>JavaScript的SDK</c>


674
00:37:12,132 --> 00:37:14,635
<c.magenta>让你们可以直接集成到网站中</c>


675
00:37:15,903 --> 00:37:17,771
<c.magenta>实际上在欧美</c>


676
00:37:18,038 --> 00:37:21,875
<c.magenta>现在超过40家网银平台</c>
<c.magenta>支持Apple Pay</c>


677
00:37:21,942 --> 00:37:23,877
<c.magenta>名单太多了</c>
<c.magenta>所以就不一一列举了</c>


678
00:37:24,144 --> 00:37:26,914
<c.magenta>全部名单列表可在</c>
<c.magenta>developer.apple.com上找到</c>


679
00:37:27,948 --> 00:37:30,984
<c.magenta>就像我说的那样 许多网银平台</c>
<c.magenta>现在提供了应用内的SDK</c>


680
00:37:31,051 --> 00:37:34,188
<c.magenta>将来它们也会提供网页的SDK</c>


681
00:37:36,356 --> 00:37:39,059
<c.magenta>这里我想强调一下</c>
<c.magenta>一些新的网银平台</c>


682
00:37:39,126 --> 00:37:41,762
<c.magenta>大家都知道</c>
<c.magenta>Apple Pay在中国可以使用了</c>


683
00:37:41,828 --> 00:37:44,364
<c.magenta>这项功能在中国也同样好用</c>


684
00:37:44,431 --> 00:37:45,532
<c.magenta>像在欧洲或美国那样</c>


685
00:37:45,666 --> 00:37:49,436
<c.magenta>在中国有四家网银平台</c>
<c.magenta>支持Apple Pay</c>


686
00:37:49,503 --> 00:37:53,774
<c.magenta>它们是中国银联  连连支付</c>
<c.magenta>首信易支付以及易宝支付</c>


687
00:37:53,974 --> 00:37:56,243
<c.magenta>若你在亚洲转发应用内</c>
<c.magenta>或者网页的请求</c>


688
00:37:56,310 --> 00:37:58,779
<c.magenta>你同样能获得良好的支持</c>


689
00:38:00,380 --> 00:38:04,651
<c.magenta>就像我前面提到过的电子商务平台</c>


690
00:38:05,252 --> 00:38:08,021
<c.magenta>很多站点并没有独立的电子商务系统</c>


691
00:38:08,088 --> 00:38:11,859
<c.magenta>它们使用着电子商务平台提供的服务</c>


692
00:38:12,259 --> 00:38:15,896
<c.magenta>我们现已与很多电子商务平台进行合作</c>


693
00:38:16,330 --> 00:38:18,365
<c.magenta>我们主要有三个电子平台合作方</c>


694
00:38:18,732 --> 00:38:22,269 line:1
<c.magenta>它们是Demandware IBM</c>
<c.magenta>以及Shopify</c>


695
00:38:22,703 --> 00:38:24,905 line:1
<c.magenta>如果你没有使用这三家中的一个</c>


696
00:38:25,172 --> 00:38:27,741 line:1
<c.magenta>那么你在使用Apple Pay时</c>


697
00:38:27,808 --> 00:38:30,043 line:1
<c.magenta>在使用Apple Pay的时候</c>


698
00:38:30,110 --> 00:38:31,578 line:1
<c.magenta>需要一个开发者账号</c>


699
00:38:32,246 --> 00:38:34,815 line:1
<c.magenta>使用这些平台对你来说会更方便</c>


700
00:38:34,882 --> 00:38:38,852 line:1
<c.magenta>它们会处理与Apple Pay</c>
<c.magenta>深度集成的事情</c>


701
00:38:43,090 --> 00:38:45,893 line:1
<c.magenta>现在你可能会想去试一试了</c>


702
00:38:45,959 --> 00:38:47,027 line:1
<c.magenta>我希望你们都那么想</c>


703
00:38:47,728 --> 00:38:50,197 line:1
<c.magenta>我想多谈一些关于测试的事情</c>


704
00:38:51,265 --> 00:38:53,734 line:1
<c.magenta>测试你的网站:</c>


705
00:38:53,901 --> 00:38:55,636 line:1
<c.magenta>我们来介绍一个新的测试环境</c>


706
00:38:55,702 --> 00:38:58,272 line:1
<c.magenta>它为Apple Pay打造名叫</c>
<c.magenta>Apple Pay Sandbox</c>


707
00:38:58,839 --> 00:39:00,340 line:1
<c.magenta>这是一种新的测试方式</c>


708
00:39:00,607 --> 00:39:04,978 line:1
<c.magenta>在这个测试环境下</c>
<c.magenta>默认网页就是支付Apple Pay</c>


709
00:39:05,612 --> 00:39:07,281 line:1
<c.magenta>如果你想获得更多信息的话</c>


710
00:39:07,347 --> 00:39:09,249 line:1
<c.magenta>这个会议我们没有时间</c>
<c.magenta>来谈论这个问题</c>


711
00:39:09,483 --> 00:39:11,852 line:1
<c.magenta>但是在下个会议我们会谈到</c>


712
00:39:11,952 --> 00:39:13,654 line:1
<c.magenta>我们会为大家讲述Sandbox</c>


713
00:39:13,754 --> 00:39:16,390 line:1
<c.magenta>如果访问我们的网站</c>
<c.magenta>developer.apple.com</c>


714
00:39:16,623 --> 00:39:19,726 line:1
<c.magenta>那里会有Apple Pay</c>
<c.magenta>Sandbox相关的更多的信息</c>


715
00:39:19,793 --> 00:39:21,929 line:1
<c.magenta>作为一个开始</c>
<c.magenta>你将会能够</c>


716
00:39:22,029 --> 00:39:23,397 line:1
<c.magenta>测试网页上进行Apple Pay</c>


717
00:39:23,497 --> 00:39:25,499 line:1
<c.magenta>然后我们就可以将Apple Pay</c>
<c.magenta>在生产环境上部署了</c>


718
00:39:25,566 --> 00:39:29,636
<c.magenta>我们即将发布iOS X</c>
<c.magenta>以及Mac OS Sierra</c>


719
00:39:36,577 --> 00:39:39,580
<c.magenta>所以当你们开始测试</c>
<c.magenta>Apple Pay的时候</c>


720
00:39:39,646 --> 00:39:43,383
<c.magenta>请给我们一些反馈来帮助我们解决错误</c>


721
00:39:43,650 --> 00:39:46,720
<c.magenta>我们非常愿意听到你们反馈问题</c>


722
00:39:46,787 --> 00:39:48,255
<c.magenta>及其它你们所见到的事情</c>


723
00:39:48,355 --> 00:39:51,225
<c.magenta>如果你们愿意表示祝贺之类的话</c>
<c.magenta>我们也非常愿意听到</c>


724
00:39:52,626 --> 00:39:56,730
<c.magenta>好吧 让我们看看最后一个部分</c>


725
00:39:57,764 --> 00:39:59,333
<c.magenta>Apple Pay的设计</c>


726
00:39:59,933 --> 00:40:03,537
<c.magenta>如何为网站建立一个能收到欢迎的体验</c>


727
00:40:03,937 --> 00:40:06,707
<c.magenta>这方面也同样的适用于应用</c>


728
00:40:09,343 --> 00:40:12,012
<c.magenta>在最开始的部分</c>
<c.magenta>我提到了一点</c>


729
00:40:12,613 --> 00:40:14,047
<c.magenta>那就是Apple Pay三个原则：</c>


730
00:40:14,681 --> 00:40:18,452
<c.magenta>它们是简单 安全 以及私密</c>


731
00:40:20,187 --> 00:40:21,855
<c.magenta>你的设计需要能体现哪些</c>


732
00:40:22,422 --> 00:40:23,557
<c.magenta>而不是设计的太复杂</c>


733
00:40:23,690 --> 00:40:25,659
<c.magenta>Apple Pay不能设计得</c>
<c.magenta>使用起来太复杂</c>


734
00:40:27,027 --> 00:40:29,563
<c.magenta>Apple Pay也有三个主要阶段</c>


735
00:40:29,997 --> 00:40:31,498
<c.magenta>它们是预支付阶段</c>


736
00:40:31,965 --> 00:40:34,568
<c.magenta>在这一阶段</c>
<c.magenta>你还没有看到Apple Pay表单</c>


737
00:40:34,635 --> 00:40:38,071
<c.magenta>这种体验发生在</c>
<c.magenta>Apple Pay表单出现之前</c>


738
00:40:39,206 --> 00:40:42,176
<c.magenta>然后是支付过程</c>
<c.magenta>实际的支付使用</c>


739
00:40:42,242 --> 00:40:44,912
<c.magenta>这时候表单已经出现了</c>


740
00:40:45,112 --> 00:40:47,214
<c.magenta>你可以定制那个界面</c>
<c.magenta>你还需要做什么呢</c>


741
00:40:47,281 --> 00:40:48,115
<c.magenta>让我们来看看</c>


742
00:40:49,249 --> 00:40:50,817
<c.magenta>然后还有发送支付的过程</c>


743
00:40:51,585 --> 00:40:54,555
<c.magenta>那是表单消失后的体验</c>


744
00:40:55,355 --> 00:40:57,591
<c.magenta>让我们来完整的看一下这三种阶段</c>


745
00:40:57,658 --> 00:41:02,729
<c.magenta>然后讨论一下你如何设计</c>
<c.magenta>Apple Pay的各个阶段</c>


746
00:41:05,132 --> 00:41:07,734
<c.magenta>预支付开始于用户点击了</c>
<c.magenta>Apple Pay按钮</c>


747
00:41:08,535 --> 00:41:10,871
<c.magenta>在Cocoa Touch中也有</c>
<c.magenta>同样的Apple Pay按钮</c>


748
00:41:10,938 --> 00:41:13,340
<c.magenta>就像我刚才展示的那样</c>


749
00:41:13,407 --> 00:41:16,910
<c.magenta>你也可在Cocoa</c>
<c.magenta>Touch中使用它</c>


750
00:41:16,977 --> 00:41:19,079
<c.magenta>这种按钮有很多种风格</c>


751
00:41:19,580 --> 00:41:20,948
<c.magenta>这里有很多种</c>


752
00:41:21,348 --> 00:41:24,818
<c.magenta>Anders展示了使用CSS来改变</c>
<c.magenta>但是需要重申的是</c>


753
00:41:25,953 --> 00:41:29,256
<c.magenta>我们提供了WebKit-image-named的属性</c>
<c.magenta>你们可以使用它</c>


754
00:41:29,623 --> 00:41:31,024
<c.magenta>你可以获得一个Apple Pay的logo</c>


755
00:41:31,892 --> 00:41:33,894
<c.magenta>就可在网页的按钮上使用了logo了</c>


756
00:41:35,696 --> 00:41:37,664
<c.magenta>有些可以改</c>
<c.magenta>而有些不能改</c>


757
00:41:37,731 --> 00:41:39,132
<c.magenta>使用Apple Pay时</c>


758
00:41:40,300 --> 00:41:41,969
<c.magenta>使用内建的资源</c>


759
00:41:43,337 --> 00:41:45,205
<c.magenta>即使我们修改了logo</c>
<c.magenta>你们也没必要知道</c>


760
00:41:45,272 --> 00:41:47,040
<c.magenta>你可能想确保你logo是最新的</c>


761
00:41:47,541 --> 00:41:50,544
<c.magenta>并且放置到任何用户想进行购买的地方</c>


762
00:41:50,844 --> 00:41:51,912
<c.magenta>不用隐藏它</c>


763
00:41:51,979 --> 00:41:54,248
<c.magenta>不要让用户对支付感到困难</c>


764
00:41:54,381 --> 00:41:56,416
<c.magenta>但是支付操作却很简便</c>


765
00:41:57,484 --> 00:41:58,852
<c.magenta>还有一些最好不要做的建议</c>


766
00:41:59,453 --> 00:42:03,590
<c.magenta>不要修改按钮的外观或者它的行为</c>


767
00:42:04,157 --> 00:42:06,527
<c.magenta>对于用户来说</c>


768
00:42:06,593 --> 00:42:08,762
<c.magenta>他们点击了Apple Pay按钮</c>
<c.magenta>就让他们看到Apple Pay表单</c>


769
00:42:08,829 --> 00:42:10,664
<c.magenta>我们希望有这样的体验</c>


770
00:42:11,198 --> 00:42:12,966
<c.magenta>同样不要让这个按钮无效</c>


771
00:42:13,033 --> 00:42:17,404
<c.magenta>苹果的标准规定</c>
<c.magenta>你不能让这个无效</c>


772
00:42:17,504 --> 00:42:20,707
<c.magenta>你必须于其它的支付方式同等的对待它</c>


773
00:42:23,343 --> 00:42:25,445
<c.magenta>让我们讨论一下什么地方</c>
<c.magenta>可以放置这个按钮</c>


774
00:42:26,613 --> 00:42:28,549
<c.magenta> Anders的演示已向你们展示了</c>


775
00:42:28,649 --> 00:42:31,685
<c.magenta>再开始支付流程之前就放置好这个按钮</c>


776
00:42:32,786 --> 00:42:35,656
<c.magenta>在产品的界面放置这个按钮</c>
<c.magenta>可以增加用户的支付转化率</c>


777
00:42:35,722 --> 00:42:38,625
<c.magenta>我们从应用中看到了支持Apple</c>
<c.magenta>Pay后会带来良好的数据</c>


778
00:42:38,725 --> 00:42:41,128
<c.magenta>表明了支付转换率的上升</c>


779
00:42:41,195 --> 00:42:44,097
<c.magenta>他们只是在产品的界面放置这个按钮</c>
<c.magenta>就能产生这种结果</c>


780
00:42:44,998 --> 00:42:48,702
<c.magenta>同样明显 你可将它放到常规的</c>
<c.magenta>支付流程以及购物车中</c>


781
00:42:49,336 --> 00:42:50,537
<c.magenta>让我们来看一些例子</c>


782
00:42:50,704 --> 00:42:54,942
<c.magenta>我们将Apple Pay API</c>
<c.magenta>向一些网站开放了</c>


783
00:42:55,008 --> 00:42:57,177
<c.magenta>并且要求它们遵守一些设计</c>


784
00:42:57,711 --> 00:42:59,513
<c.magenta>和使用Apple Pay的经验</c>


785
00:43:00,547 --> 00:43:02,182
<c.magenta>其中一个是StubHub</c>


786
00:43:03,450 --> 00:43:06,787
<c.magenta>现在StubHub决定</c>
<c.magenta>将Apple Pay按钮</c>


787
00:43:06,887 --> 00:43:08,121
<c.magenta>放置在订单流程当中</c>


788
00:43:08,255 --> 00:43:10,023
<c.magenta>你选择你需要的门票</c>


789
00:43:10,123 --> 00:43:11,859
<c.magenta>然后使用Apple Pay</c>


790
00:43:12,893 --> 00:43:14,862
<c.magenta>你也可以将Apple Pay提前</c>


791
00:43:14,928 --> 00:43:17,397
<c.magenta>你可在快速支付的时候</c>
<c.magenta>就使用Apple Pay</c>


792
00:43:17,464 --> 00:43:19,333
<c.magenta>Warby Parker就这么做</c>


793
00:43:20,100 --> 00:43:22,069
<c.magenta>在你选择了一个产品之后</c>


794
00:43:22,603 --> 00:43:23,670
<c.magenta>你会看到两个选项</c>


795
00:43:23,737 --> 00:43:26,607
<c.magenta>W可以将它加入购物车</c>
<c.magenta>然后继续选购</c>


796
00:43:27,007 --> 00:43:29,676
<c.magenta>或者直接通过</c>
<c.magenta>Apple Pay来购买</c>


797
00:43:31,879 --> 00:43:33,413
<c.magenta>最后你可将Apple Pay按钮</c>


798
00:43:33,480 --> 00:43:34,982
<c.magenta>直接放到产品的页面</c>


799
00:43:35,482 --> 00:43:37,451
<c.magenta>Lululemon是这么做的</c>


800
00:43:37,718 --> 00:43:40,587
<c.magenta>这里在产品页面就有一个按钮</c>


801
00:43:40,721 --> 00:43:42,689
<c.magenta>让我们在iPad上看一下</c>


802
00:43:43,590 --> 00:43:45,359
<c.magenta>你同样能看到</c>
<c.magenta>添加商品到购物车</c>


803
00:43:45,425 --> 00:43:48,829
<c.magenta>如果我想像平常那样创建一个购物车</c>
<c.magenta>我可以做到</c>


804
00:43:48,896 --> 00:43:51,064
<c.magenta>或者我可以直接购买它们</c>


805
00:43:53,567 --> 00:43:56,870
<c.magenta>有一点在产品页面得到了增强</c>


806
00:43:57,004 --> 00:43:59,206
<c.magenta>那就是允许未注册直接支付</c>


807
00:43:59,773 --> 00:44:03,076
<c.magenta>要求注册是一个非常主要的用户门槛</c>


808
00:44:03,143 --> 00:44:04,711
<c.magenta>我不知道你们如何看待</c>


809
00:44:04,811 --> 00:44:07,614
<c.magenta>但是我不会去一个</c>
<c.magenta>我不知道的网站购买东西</c>


810
00:44:07,681 --> 00:44:09,917
<c.magenta>前提是它要求我进行注册</c>


811
00:44:11,285 --> 00:44:14,021
<c.magenta>所以Apple Pay能帮助</c>
<c.magenta>减少抑制消费的情况</c>


812
00:44:14,087 --> 00:44:17,024
<c.magenta>通过让未注册用户的</c>
<c.magenta>支付流程变得非常简单</c>


813
00:44:18,158 --> 00:44:21,161
<c.magenta>同时 你可以选择利用</c>


814
00:44:21,228 --> 00:44:25,232
<c.magenta>Apple Pay表单中的信息</c>
<c.magenta>在用户购买后为他创建一个账户</c>


815
00:44:25,866 --> 00:44:28,669
<c.magenta>我会来为大家在支付后的部分</c>
<c.magenta>来展示这一点</c>


816
00:44:30,871 --> 00:44:33,707
<c.magenta>让我们来关注一下实际支付过程</c>
<c.magenta>Apple Pay表单</c>


817
00:44:35,409 --> 00:44:38,712
<c.magenta>Apple Pay表单</c>
<c.magenta>为商户提供了灵活的支付流程</c>


818
00:44:38,812 --> 00:44:40,414
<c.magenta>这是高度定制化的</c>


819
00:44:40,681 --> 00:44:44,785
<c.magenta>但是它同样为用户提供了</c>
<c.magenta>一种持续性的使用经验</c>


820
00:44:45,319 --> 00:44:48,222
<c.magenta>你可以决定显示出哪些信息</c>


821
00:44:48,288 --> 00:44:50,991
<c.magenta>但是用户总是有着自己的期望</c>


822
00:44:53,093 --> 00:44:54,761
<c.magenta>这里是Apple Pay表单的例子</c>


823
00:44:54,895 --> 00:44:56,830
<c.magenta>我使用的是Mac OS sheet</c>


824
00:44:57,197 --> 00:45:00,334
<c.magenta>但是在iOS上 条目也是一样的</c>


825
00:45:00,467 --> 00:45:04,204
<c.magenta>若你在SafariiPhone</c>
<c.magenta>iPad的网页上进行支付</c>


826
00:45:05,272 --> 00:45:08,342
<c.magenta>第一个条目是选择银行卡</c>


827
00:45:08,509 --> 00:45:11,111
<c.magenta>账单地址也经常第一个被选</c>


828
00:45:11,211 --> 00:45:12,946
<c.magenta>尽管账单地址不是必需的</c>


829
00:45:13,046 --> 00:45:14,615
<c.magenta>在处理支付流程的过程中</c>


830
00:45:16,383 --> 00:45:17,918
<c.magenta>第二个条目是收货地址</c>


831
00:45:19,219 --> 00:45:21,688
<c.magenta>这个是你必须从用户那里获得的信息</c>


832
00:45:23,223 --> 00:45:27,661
<c.magenta>你可请求银行卡信息 收货地址</c>
<c.magenta>若有需要 你还可以请求联系地址</c>


833
00:45:27,995 --> 00:45:31,598
<c.magenta>你可以指明收货地址的方式</c>


834
00:45:32,299 --> 00:45:33,600
<c.magenta>你可以改变那些术语</c>


835
00:45:33,700 --> 00:45:37,304
<c.magenta>若你不想用“shipping”</c>
<c.magenta>你可用“delivery”或“pickup”</c>


836
00:45:37,905 --> 00:45:41,074
<c.magenta>这对于拼车应用或者</c>
<c.magenta>外卖服务来说非常好</c>


837
00:45:44,444 --> 00:45:46,914
<c.magenta>现在你可以列出快递费用的列表了</c>


838
00:45:47,314 --> 00:45:50,851
<c.magenta>你可以用列表来描述它们</c>
<c.magenta>我们马上会讲到这一点</c>


839
00:45:52,619 --> 00:45:54,288
<c.magenta>但是当你收集了这些信息之后</c>


840
00:45:54,421 --> 00:45:56,657
<c.magenta>请确保你有一个清晰的保密协议</c>


841
00:45:56,823 --> 00:45:59,459
<c.magenta>如果你在应用中使用了</c>
<c.magenta>Apple Pay</c>


842
00:45:59,526 --> 00:46:00,827
<c.magenta>当你将应用上传App Store时</c>
<c.magenta>会被要求提供保密协议</c>


843
00:46:00,928 --> 00:46:04,131
<c.magenta>现在你是在为网页做设计</c>


844
00:46:04,231 --> 00:46:06,099
<c.magenta>很明显没那样的方式来提供保密协议</c>


845
00:46:06,200 --> 00:46:09,236
<c.magenta>所以我们要求你提供一个保密协议</c>


846
00:46:09,303 --> 00:46:11,939
<c.magenta>放在你的网站上</c>


847
00:46:12,005 --> 00:46:13,340
<c.magenta>且表明你如何使用这些信息</c>


848
00:46:15,776 --> 00:46:17,644
<c.magenta>现在既然你们能使用寄送方式了</c>


849
00:46:18,612 --> 00:46:20,380
<c.magenta>就是选择邮寄之类的</c>


850
00:46:21,481 --> 00:46:24,718
<c.magenta>就像选择地址那样</c>
<c.magenta>这也是可以定制的</c>


851
00:46:25,652 --> 00:46:27,487
<c.magenta>用户可以从一个列表中选择</c>


852
00:46:27,921 --> 00:46:30,724
<c.magenta>如果地址更新的话</c>
<c.magenta>这些方式也应该会更新</c>


853
00:46:30,891 --> 00:46:33,794
<c.magenta>比如在你已经选择了</c>
<c.magenta>送到纽约的快递方式的时候</c>


854
00:46:33,894 --> 00:46:35,262
<c.magenta>你可以很容易的想到这一点</c>


855
00:46:36,496 --> 00:46:39,666
<c.magenta>这些方式也可以是免费的</c>
<c.magenta>如果你愿意的话</c>


856
00:46:40,200 --> 00:46:41,468
<c.magenta>就像收货地址那样</c>


857
00:46:41,602 --> 00:46:44,037
<c.magenta>收货人的姓名也可以按你的要求改变</c>


858
00:46:47,541 --> 00:46:50,344
<c.magenta>尽管你会要求住址</c>
<c.magenta>邮件地址 手机号码</c>


859
00:46:50,477 --> 00:46:52,312
<c.magenta>在同一个属性中</c>


860
00:46:52,813 --> 00:46:54,615
<c.magenta>但是在表单中 它们是分开的</c>


861
00:46:55,249 --> 00:46:56,783
<c.magenta>这里是联系信息的条目</c>


862
00:46:56,850 --> 00:46:59,520
<c.magenta>是用来填写信息</c>
<c.magenta>而不是填写邮政编码之类的</c>


863
00:46:59,820 --> 00:47:01,788
<c.magenta>我们现在支持收集手机号</c>


864
00:47:02,089 --> 00:47:03,957
<c.magenta>我们也支持收集邮件地址</c>


865
00:47:04,091 --> 00:47:06,126
<c.magenta>如果你没有要求一个送货地址</c>


866
00:47:06,193 --> 00:47:08,529
<c.magenta>我们会允许你获得用户的名字</c>


867
00:47:08,695 --> 00:47:12,266
<c.magenta>这对于拼车的应用或者网站会非常有用</c>


868
00:47:12,366 --> 00:47:14,101
<c.magenta>及那些想获得姓名的应用或者网站</c>


869
00:47:14,168 --> 00:47:15,836
<c.magenta>但是却不需要用户的送货地址</c>


870
00:47:18,639 --> 00:47:21,975
<c.magenta>现在到了最重要的一个填写区域</c>
<c.magenta>它就是摘要信息</c>


871
00:47:22,709 --> 00:47:25,412
<c.magenta>用户获得的金额会高亮</c>


872
00:47:25,512 --> 00:47:27,147
<c.magenta>抱歉 是用户支付的金额</c>


873
00:47:28,182 --> 00:47:30,017
<c.magenta>并且你可以使用这个摘要</c>


874
00:47:30,250 --> 00:47:33,020
<c.magenta>来简洁的表明支付的用途</c>


875
00:47:33,320 --> 00:47:36,290
<c.magenta>比如小记 快递费 折扣</c>


876
00:47:36,790 --> 00:47:39,960
<c.magenta>这里并不是一个条目列表</c>


877
00:47:40,060 --> 00:47:41,862
<c.magenta>它并不是一个销售账单</c>


878
00:47:42,963 --> 00:47:44,665
<c.magenta>所以你需要让它很简洁</c>


879
00:47:45,766 --> 00:47:48,502
<c.magenta>当然也需要清晰明白的表明你的收费</c>


880
00:47:49,236 --> 00:47:52,072
<c.magenta>确保显示的总金额</c>


881
00:47:52,139 --> 00:47:54,074
<c.magenta>与用户即将要扣除的金额保持一致</c>


882
00:47:55,175 --> 00:47:57,344
<c.magenta>那就是说 这些情况下</c>


883
00:47:57,411 --> 00:47:59,980
<c.magenta>你并不需要知道付出多少钱</c>


884
00:48:00,581 --> 00:48:02,349
<c.magenta>有时候你不知道最终会支付多少钱</c>


885
00:48:02,716 --> 00:48:04,952
<c.magenta>比如酒店预订会出现这种情况</c>
<c.magenta>它们是开放性的</c>


886
00:48:05,185 --> 00:48:07,688
<c.magenta>租车或者的士服务也是如此</c>


887
00:48:08,589 --> 00:48:10,824
<c.magenta>这时候你可以</c>
<c.magenta>使用pending的条目类型</c>


888
00:48:10,891 --> 00:48:12,826
<c.magenta>在摘要信息中表明这一点</c>


889
00:48:14,661 --> 00:48:16,763
<c.magenta>所以需要注意  保持透明的计费</c>


890
00:48:17,297 --> 00:48:19,366
<c.magenta>为何我一直提到“作清晰预估”</c>


891
00:48:19,733 --> 00:48:22,603
<c.magenta>你可以在刚才的演示中看到</c>


892
00:48:22,669 --> 00:48:25,739
<c.magenta>在通过Apple Pay付款后</c>
<c.magenta>通常你会看到一个通知</c>


893
00:48:25,873 --> 00:48:28,308
<c.magenta>这个通知来自银行并且告知金额的变化</c>


894
00:48:28,408 --> 00:48:29,843
<c.magenta>所以你想确保那个金额</c>


895
00:48:29,910 --> 00:48:32,913
<c.magenta>与表单上显示的相匹配</c>


896
00:48:32,980 --> 00:48:34,348
<c.magenta>至少尽力让两者保持一致</c>


897
00:48:34,414 --> 00:48:35,415
<c.magenta>你不需知道总费用时</c>


898
00:48:37,251 --> 00:48:40,254
<c.magenta>摘要条目也支持免费或者折扣</c>


899
00:48:40,921 --> 00:48:42,489
<c.magenta>条目上可以标记为免费</c>


900
00:48:42,956 --> 00:48:46,126
<c.magenta>摘要条目可以是负数</c>
<c.magenta>但是总金额不能为负数</c>


901
00:48:46,226 --> 00:48:48,662
<c.magenta>总金额必须是一个正数</c>


902
00:48:48,729 --> 00:48:50,030
<c.magenta>但是在那之前</c>


903
00:48:50,163 --> 00:48:52,799
<c.magenta>如果你想指出哪个地方有折扣</c>
<c.magenta>都是可以的</c>


904
00:48:55,135 --> 00:48:58,672
<c.magenta>这里是另外一个Mac OS表单</c>


905
00:49:00,340 --> 00:49:03,043
<c.magenta>这里是一个条目</c>
<c.magenta>告诉你在什么设备上确认</c>


906
00:49:04,278 --> 00:49:08,849
<c.magenta>这让我想起了Anders讨论</c>
<c.magenta>网站图标的观点</c>


907
00:49:09,216 --> 00:49:13,020
<c.magenta>这是一个在iPhone的表单</c>
<c.magenta>而此时你在你的Mac上进行着支付</c>


908
00:49:13,353 --> 00:49:15,222
<c.magenta>在这里你不能定制任何东西</c>


909
00:49:15,322 --> 00:49:17,424
<c.magenta>我们会告知你银行卡</c>
<c.magenta>但是你无法改变</c>


910
00:49:17,491 --> 00:49:18,825
<c.magenta>你需要在Mac上改变它</c>


911
00:49:19,193 --> 00:49:20,594
<c.magenta>顺便的说一下</c>


912
00:49:20,661 --> 00:49:22,763
<c.magenta>若在Mac上改变任何选项</c>
<c.magenta>价格都会更新</c>


913
00:49:22,896 --> 00:49:25,699
<c.magenta>如果你改变了邮寄方式而使得费用增加</c>


914
00:49:25,799 --> 00:49:27,201
<c.magenta>我们会直接进行同步</c>


915
00:49:28,569 --> 00:49:31,972
<c.magenta>但是网站的图标是从你的网站上下载的</c>


916
00:49:32,105 --> 00:49:34,408
<c.magenta>你可以通过很多种方式来指定</c>


917
00:49:35,709 --> 00:49:39,980
<c.magenta>它使用了Apple Touch</c>
<c.magenta>的图标</c>


918
00:49:40,047 --> 00:49:44,518
<c.magenta>为了使用Apple Pay</c>
<c.magenta>你需提供180和120像素大小</c>


919
00:49:45,018 --> 00:49:49,089
<c.magenta>最简单的方式是提供一个链接</c>


920
00:49:49,756 --> 00:49:54,094
<c.magenta>但是你也可以设定是域名的根目录</c>


921
00:49:55,395 --> 00:49:57,164
<c.magenta>选择适合你的方式吧</c>


922
00:49:58,398 --> 00:50:00,467
<c.magenta>我还想谈谈一些别的事情</c>


923
00:50:00,567 --> 00:50:02,002
<c.magenta>那就是关于标记语言</c>


924
00:50:02,302 --> 00:50:05,072
<c.magenta>你们当中很多人应该使用过标记语言</c>


925
00:50:05,138 --> 00:50:07,975
<c.magenta>用来在你们页面上指明产品类型</c>


926
00:50:08,075 --> 00:50:10,110
<c.magenta>那样可以被搜索排名所统计</c>


927
00:50:10,310 --> 00:50:13,013
<c.magenta>我们同样的有一个产品类型排名</c>


928
00:50:13,113 --> 00:50:14,882
<c.magenta>在iOS的Spotlight中</c>


929
00:50:15,549 --> 00:50:17,518
<c.magenta>你也可指明你的站点</c>
<c.magenta>使用了Apple Pay</c>


930
00:50:17,584 --> 00:50:19,386
<c.magenta>只要你使用了合适的标记语言</c>


931
00:50:19,453 --> 00:50:22,923
<c.magenta>我们觉得那样会更有利</c>
<c.magenta>比如说对于搜索引擎</c>


932
00:50:22,990 --> 00:50:25,225
<c.magenta>及想知哪些地方</c>
<c.magenta>正用Apple Pay的人</c>


933
00:50:25,292 --> 00:50:26,927
<c.magenta>若你想这样做</c>
<c.magenta>也会对你更加有利</c>


934
00:50:28,996 --> 00:50:32,699
<c.magenta>现在让我们来看最后一个部分</c>
<c.magenta>确认支付</c>


935
00:50:34,535 --> 00:50:37,237
<c.magenta>在你的确认信息中</c>
<c.magenta>你想反映出合适的状态</c>


936
00:50:37,304 --> 00:50:38,405
<c.magenta>放置到Apple Pay表单中</c>


937
00:50:39,706 --> 00:50:43,110
<c.magenta>比如说 失败的时候</c>
<c.magenta>就不要显示一个成功的页面了</c>


938
00:50:43,177 --> 00:50:44,178
<c.magenta>那样是非常愚蠢的</c>


939
00:50:44,545 --> 00:50:47,881
<c.magenta>同时你可以利用</c>
<c.magenta>Apple Pay收集的信息</c>


940
00:50:47,948 --> 00:50:50,384
<c.magenta>来为用户提供一个新的账户</c>
<c.magenta>我前面有提到过</c>


941
00:50:50,450 --> 00:50:53,387
<c.magenta>我想展示Lululemon的例子</c>


942
00:50:54,154 --> 00:50:55,189
<c.magenta>这里就是例子了</c>


943
00:50:55,255 --> 00:50:57,324
<c.magenta>当你已经做了一次支付后</c>


944
00:50:57,624 --> 00:50:59,092
<c.magenta>你获得了一个确认信息的页面</c>


945
00:50:59,259 --> 00:51:03,931
<c.magenta>然后你创建了一个账户</c>


946
00:51:03,997 --> 00:51:05,699
<c.magenta>预置了从Apple Pay中</c>
<c.magenta>获得的邮件信息</c>


947
00:51:05,766 --> 00:51:08,235
<c.magenta>所以同样的我也可以自己创建一个账户</c>


948
00:51:08,302 --> 00:51:10,404
<c.magenta>我也可以将账户关联起来</c>


949
00:51:10,470 --> 00:51:11,672
<c.magenta>这样做是非常容易的</c>


950
00:51:13,874 --> 00:51:16,476
<c.magenta>好了 我们今天讲了很多内容</c>


951
00:51:17,544 --> 00:51:18,412
<c.magenta>我们主要覆盖了哪些呢</c>


952
00:51:19,346 --> 00:51:21,315
<c.magenta>我们讲述了网页上</c>
<c.magenta>Apply Pay的商户验证</c>


953
00:51:21,381 --> 00:51:25,052
<c.magenta>我们学习了Apple Pay</c>
<c.magenta>在网页和应用的不同之处</c>


954
00:51:25,786 --> 00:51:30,157
<c.magenta>Anders为我们讲述了Apple Pay session</c>
<c.magenta>以及JavaScript API</c>


955
00:51:31,592 --> 00:51:35,362
<c.magenta>然后我们还谈到了设计者</c>
<c.magenta>如何利用Apple Pay优势</c>


956
00:51:36,296 --> 00:51:39,466
<c.magenta>我们现对网页上使用Apple</c>
<c.magenta>Pay已经有了很多了解</c>


957
00:51:39,867 --> 00:51:43,070
<c.magenta>你可以在这里获得</c>
<c.magenta>我们的开发页面以及网站</c>


958
00:51:43,670 --> 00:51:45,439
<c.magenta>以及相关的会议</c>


959
00:51:46,039 --> 00:51:47,774
<c.magenta>首先 不用去其它地方</c>


960
00:51:47,908 --> 00:51:49,476
<c.magenta>留在这里</c>
<c.magenta>不要离开</c>


961
00:51:49,543 --> 00:51:53,380
<c.magenta>我在三点钟会回来讲述Wallet</c>
<c.magenta>与Apple Pay中新的内容</c>


962
00:51:53,447 --> 00:51:57,851
<c.magenta>我们会讲述Sandbox</c>
<c.magenta>WatchKit以及扩展</c>


963
00:51:57,918 --> 00:51:59,620
<c.magenta>以及其它一些新的事物</c>


964
00:51:59,686 --> 00:52:03,123
<c.magenta>这些在Wallet and Apple Pay中</c>
<c.magenta>发生并且与银行以及零售商有关</c>


965
00:52:03,257 --> 00:52:06,260
<c.magenta>这里还有一个会议</c>
<c.magenta>是针对网页开发者的：</c>


966
00:52:06,326 --> 00:52:08,595
<c.magenta>在你的应用中优化网页内容</c>


967
00:52:08,729 --> 00:52:10,230
<c.magenta>该会议将在周五4:00开始</c>


968
00:52:10,831 --> 00:52:12,199
<c.magenta>我们已经讲完了</c>


969
00:52:12,266 --> 00:52:14,668
<c.magenta>欢迎各位前来</c>


970
00:52:14,935 --> 00:52:17,137
<c.magenta>我已迫不及待想看到大家</c>
<c.magenta>支持网页上使用Apple Pay了</c>


971
00:52:17,204 --> 00:52:19,273
<c.magenta>谢谢</c>
<c.magenta>希望大家在 WWDC 度过好时光</c>

